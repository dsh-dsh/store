(function(){"use strict";var e={3782:function(e,t,o){var l=o(9963),s=o(5475),a=o(6252);function i(e,t,o,l,s,i){const n=(0,a.up)("router-view"),d=(0,a.up)("Toast");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(n),(0,a.Wm)(d,{position:"bottom-right"})])}var n=o(3915),d={name:"App",components:{Toast:n.Z},data(){return{}},mounted(){this.$store.dispatch("installToast",this.$toast),this.$store.dispatch("getToken"),this.$store.dispatch("getWorkShops"),this.$store.dispatch("getUnits"),this.$store.dispatch("getProjects"),this.$store.dispatch("getStorages"),this.$store.dispatch("getUsers"),this.$store.dispatch("getCompanies"),this.$store.dispatch("getDocTypes"),this.$store.dispatch("getDefaultProperties"),this.$store.dispatch("getPeriod"),this.$store.dispatch("setDates")}},c=o(3744);const r=(0,c.Z)(d,[["render",i]]);var u=r,m=o(3907),p=(o(6699),o(2119));const h=e=>((0,a.dD)("data-v-694cb6db"),e=e(),(0,a.Cn)(),e),g={class:"loginform block"},_=h((()=>(0,a._)("div",{class:"left"},null,-1))),f={class:"column right"},y=h((()=>(0,a._)("h5",null,"логин",-1))),b=h((()=>(0,a._)("h5",null,"пароль",-1))),v=h((()=>(0,a._)("br",null,null,-1)));function C(e,t,o,s,i,n){const d=(0,a.up)("InputText"),c=(0,a.up)("Password"),r=(0,a.up)("Button");return(0,a.wg)(),(0,a.iD)("div",g,[_,(0,a._)("div",f,[y,(0,a.Wm)(d,{id:"login",type:"text",modelValue:i.login,"onUpdate:modelValue":t[0]||(t[0]=e=>i.login=e)},null,8,["modelValue"]),b,(0,a.Wm)(c,{modelValue:i.password,"onUpdate:modelValue":t[1]||(t[1]=e=>i.password=e),toggleMask:""},null,8,["modelValue"]),v,(0,a.Wm)(r,{label:"OK",class:"p-button-sm",onClick:(0,l.iM)(n.onSubmit,["prevent"])},null,8,["onClick"])])])}var k=o(6076),w=o(4902),D=o(4325),S={name:"LoginForm",components:{InputText:k.Z,Password:w.Z,Button:D.Z},data(){return{login:null,password:null}},computed:{},methods:{onSubmit(){this.$store.dispatch("login",{login:this.login,password:this.password})}}};const T=(0,c.Z)(S,[["render",C],["__scopeId","data-v-694cb6db"]]);var A=T,P=o(3577);const W=e=>((0,a.dD)("data-v-5f912415"),e=e(),(0,a.Cn)(),e),I={class:"content"},V={class:"flex justify-content-between mb-2"},R={class:"border"},U={class:"flex justify-content-end"},x={class:"horizontal"},E=W((()=>(0,a._)("span",{class:"mlr-1"},"с",-1))),F=W((()=>(0,a._)("span",{class:"mlr-1"},"до",-1))),O=W((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("p",null,"Журнал пуст")],-1))),B=W((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),N={key:0},Z={key:1},j=W((()=>(0,a._)("h3",null,"Выберете время сохранения документа",-1))),M={class:"field-radiobutton"},H=W((()=>(0,a._)("label",{for:"time1"},"сохранить в начало дня",-1))),$={key:0,class:"field-radiobutton"},q=W((()=>(0,a._)("label",{for:"time2"},"сохранить текущее время докумнта",-1))),L={class:"field-radiobutton"},z=W((()=>(0,a._)("label",{for:"time3"},"сохранить в конец дня",-1)));function K(e,t,o,l,s,i){const n=(0,a.up)("MainMenu"),d=(0,a.up)("DocTabs"),c=(0,a.up)("Button"),r=(0,a.up)("Calendar"),u=(0,a.up)("Column"),m=(0,a.up)("DataTable"),p=(0,a.up)("DocRedactor"),h=(0,a.up)("Document"),g=(0,a.up)("Dialog"),_=(0,a.up)("OverlayPanel"),f=(0,a.up)("Menu"),y=(0,a.up)("RadioButton"),b=(0,a.Q2)("tooltip");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(n),(0,a._)("div",I,[(0,a._)("div",V,[(0,a.Wm)(d,{filter:o.filter},null,8,["filter"]),(0,a.Wm)(c,{icon:"pi pi-plus",onClick:i.chooseDocType,class:"p-button-rounded p-button-secondary p-button-outlined mr-2"},null,8,["onClick"])]),(0,a._)("div",null,[(0,a._)("div",R,[(0,a.Wm)(m,{value:i.documents,onRowClick:i.openDocument,class:"p-datatable-sm",stripedRows:"",paginator:!0,rows:10,selection:s.selectedProduct,"onUpdate:selection":t[2]||(t[2]=e=>s.selectedProduct=e),selectionMode:"single",sortField:"date_time",sortOrder:-1,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",rowsPerPageOptions:[10,20,50],responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{header:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a._)("div",x,[E,(0,a.Wm)(r,{id:"buttonbar",modelValue:s.firstDate,"onUpdate:modelValue":t[0]||(t[0]=e=>s.firstDate=e),onDateSelect:i.setStartDate,dateFormat:"dd.mm.yy",showButtonBar:!0},null,8,["modelValue","onDateSelect"]),F,(0,a.Wm)(r,{id:"buttonbar",modelValue:s.lastDate,"onUpdate:modelValue":t[1]||(t[1]=e=>s.lastDate=e),onDateSelect:i.setEndDate,dateFormat:"dd.mm.yy",showButtonBar:!0},null,8,["modelValue","onDateSelect"]),(0,a.Wm)(c,{icon:"pi pi-angle-right",onClick:i.resetDocuments,class:"p-button-sm p-button-rounded p-button-secondary p-button-text mlr-1"},null,8,["onClick"])])])])),empty:(0,a.w5)((()=>[O])),loading:(0,a.w5)((()=>[B])),paginatorstart:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"button",icon:"pi pi-refresh",class:"p-button-text"})])),paginatorend:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"button",icon:"pi pi-cloud",class:"p-button-text"})])),default:(0,a.w5)((()=>[(0,a.Wm)(u,{field:"is_hold",header:"",dataType:"boolean"},{body:(0,a.w5)((({data:e})=>[(0,a.wy)((0,a._)("i",{class:(0,P.C_)(["pi",i.iconClass(e)])},null,2),[[b,i.getToolTipText(e)]])])),_:1}),(0,a.Wm)(u,{field:"number",header:"№",sortable:"",style:{"max-width":"7rem"}},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(e.number),3)])),_:1}),(0,a.Wm)(u,{field:"doc_type",header:"Документ",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(e.doc_type),3)])),_:1}),(0,a.Wm)(u,{field:"date_time",header:"Время",sortable:"",dataType:"date"},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(new Date(e.date_time).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})),3)])),_:1}),(0,a.Wm)(u,{field:"storage_from.name",header:"со склада",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(i.getName(e.storage_from)),3)])),_:1}),(0,a.Wm)(u,{field:"storage_to.name",header:"на склад",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(i.getName(e.storage_to)),3)])),_:1}),(0,a.Wm)(u,{field:"amount",header:"Сумма",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(i.formatCurrency(e.amount)),3)])),_:1}),(0,a.Wm)(u,{field:"author.name",header:"Автор",style:{"max-width":"9rem"},sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,P.C_)(i.disabledClass(e))},(0,P.zw)(i.getName(e.author)),3)])),_:1}),(0,a.Wm)(u,{style:{"max-width":"3rem"}},{body:(0,a.w5)((({data:e})=>[(0,a.Wm)(c,{icon:"pi pi-bars",class:"p-button-rounded p-button-secondary p-button-text mr-2",onClick:t=>i.toggleModalMenu(t,e)},null,8,["onClick"])])),_:1})])),_:1},8,["value","onRowClick","selection"])])])]),(0,a.Wm)(g,{visible:s.displayDocument,"onUpdate:visible":t[3]||(t[3]=e=>s.displayDocument=e),style:{width:"90%"},modal:!0,showHeader:s.showDialogHeader},{footer:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"Закрыть",icon:"pi pi-times",onClick:i.closeDocument,class:"p-button-sm p-button-secondary p-button-text"},null,8,["onClick"]),s.docRedactor?((0,a.wg)(),(0,a.j4)(c,{key:0,label:"Сохранить",icon:"pi pi-check",onClick:i.openSaveDocDialog,class:"p-button-sm p-button-rounded p-button-secondary",autofocus:"",disabled:s.disabledSaveButton},null,8,["onClick","disabled"])):(0,a.kq)("",!0),(0,a.Wm)(c,{label:s.holdLable,icon:"pi pi-check",onClick:i.holdDocument,class:"p-button-sm p-button-rounded p-button-secondary",disabled:s.disabledHoldButton},null,8,["label","onClick","disabled"])])),default:(0,a.w5)((()=>[s.docRedactor?((0,a.wg)(),(0,a.iD)("div",N,[(0,a.Wm)(p,{docId:s.docId,onDisableHoldButton:i.disableHoldButton,onDisableSaveButton:i.disableSaveButton,type:s.type,docType:s.docType},null,8,["docId","onDisableHoldButton","onDisableSaveButton","type","docType"])])):((0,a.wg)(),(0,a.iD)("div",Z,[(0,a.Wm)(h,{docId:s.docId,onCopyToRequestDoc:i.openRequestDocRedactor,onOpenUpdateDoc:i.openUpdateDocumentRedactor,onOpenCopyDoc:i.openCopyDocumentRedactor},null,8,["docId","onCopyToRequestDoc","onOpenUpdateDoc","onOpenCopyDoc"])]))])),_:1},8,["visible","showHeader"]),(0,a.Wm)(_,{ref:"opDocTypes"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.docTypes,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a.Wm)(c,{class:"p-button-secondary p-button-text",onClick:t=>i.addNewDocByType(e.name)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,P.zw)(e.name),1)])),_:2},1032,["onClick"])])))),128))])),_:1},512),(0,a.Wm)(f,{ref:"menu",model:s.menuModel,popup:!0},null,8,["model"]),(0,a.Wm)(g,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[4]||(t[4]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[s.buttonNoEnabled?((0,a.wg)(),(0,a.j4)(c,{key:0,label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"])):(0,a.kq)("",!0),(0,a.Wm)(c,{label:"OK",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h3",null,(0,P.zw)(s.confirmationMessage),1)])),_:1},8,["visible"]),(0,a.Wm)(g,{header:"Сохраение",class:"border",visible:s.displaySaveDialog,"onUpdate:visible":t[8]||(t[8]=e=>s.displaySaveDialog=e),style:{width:"350px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"Отмена",icon:"pi pi-times",onClick:i.closeSaveDocDialog,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(c,{label:"Сохранить",icon:"pi pi-check",onClick:i.saveDocument,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[j,(0,a._)("div",M,[(0,a.Wm)(y,{id:"time1",name:"choseTime",value:"dayStart",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[5]||(t[5]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),H]),"update"==s.type?((0,a.wg)(),(0,a.iD)("div",$,[(0,a.Wm)(y,{id:"time2",name:"choseTime",value:"currentTime",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[6]||(t[6]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),q])):(0,a.kq)("",!0),(0,a._)("div",L,[(0,a.Wm)(y,{id:"time3",name:"choseTime",value:"dayEnd",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[7]||(t[7]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),z])])),_:1},8,["visible"])],64)}var G=o(8094),J=o(5247),Q=o(3609);function Y(e,t,o,l,s,i){const n=(0,a.up)("SelectButton");return(0,a.wg)(),(0,a.j4)(n,{modelValue:s.selectedFilter,"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedFilter=e),options:s.filters,optionLabel:"name",optionValue:"path",onChange:i.setFilter},null,8,["modelValue","options","onChange"])}var X=o(1109),ee={name:"DocContent",components:{SelectButton:X.Z},props:{filter:String},data(){return{selectedFilter:this.$route.params.filter,filters:[{name:"Приходные",path:"posting"},{name:"Складские",path:"store"},{name:"Заявки",path:"request"},{name:"Кассовые",path:"order"},{name:"Чеки",path:"check"},{name:"Инвентаризации",path:"invent"},{name:"Все",path:""}]}},watch:{filter(e){this.selectedFilter=e}},methods:{setFilter(e){this.$router.push(`/documents/${e.value}`)}}};const te=(0,c.Z)(ee,[["render",Y]]);var oe=te;const le=e=>((0,a.dD)("data-v-baccdd10"),e=e(),(0,a.Cn)(),e),se=le((()=>(0,a._)("br",null,null,-1))),ae=le((()=>(0,a._)("br",null,null,-1))),ie={key:0},ne={class:"formgrid grid"},de={class:"field col-12 md:col-12"},ce={class:"mb-2"},re={class:"field col-12 md:col-5 flex justify-content-between numberdatecard"},ue={class:"mt-3 mb-3"},me=le((()=>(0,a._)("label",{for:"number",class:"label"},"Номер",-1))),pe=le((()=>(0,a._)("br",null,null,-1))),he={class:"mt-3 mb-3"},ge=le((()=>(0,a._)("label",{for:"time",class:"label"},"Дата",-1))),_e=le((()=>(0,a._)("br",null,null,-1))),fe={class:"field col-12 md:col-7 center right"},ye={key:0,class:"mr-5"},be={class:"field col-12 md:col-4"},ve=le((()=>(0,a._)("label",{for:"project",class:"label"},"Проект",-1))),Ce=le((()=>(0,a._)("br",null,null,-1))),ke={class:"p-inputgroup"},we=le((()=>(0,a._)("div",{class:"field col-12 md:col-8"},null,-1))),De={key:0,class:"field col-12 md:col-4"},Se={key:0},Te=le((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),Ae=le((()=>(0,a._)("br",null,null,-1))),Pe={class:"p-inputgroup"},We={key:1,class:"field col-12 md:col-4"},Ie={key:0},Ve=le((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),Re=le((()=>(0,a._)("br",null,null,-1))),Ue={class:"p-inputgroup"},xe={key:2,class:"field col-12 md:col-4"},Ee={key:3,class:"field col-12 md:col-4"},Fe={key:0},Oe=le((()=>(0,a._)("label",{for:"supplier",class:"label"},"Поставщик",-1))),Be=le((()=>(0,a._)("br",null,null,-1))),Ne={class:"p-inputgroup"},Ze={key:4,class:"field col-12 md:col-4"},je={key:0},Me=le((()=>(0,a._)("label",{for:"recipient",class:"label"},"Получатель",-1))),He=le((()=>(0,a._)("br",null,null,-1))),$e={class:"p-inputgroup"},qe={key:5,class:"field col-12 md:col-4"},Le={key:6,class:"field col-12 md:col-4"},ze=le((()=>(0,a._)("label",{for:"individual",class:"label"},"Физ лицо",-1))),Ke=le((()=>(0,a._)("br",null,null,-1))),Ge={class:"p-inputgroup"},Je={key:7,class:"field col-12 md:col-4"},Qe=le((()=>(0,a._)("label",{for:"payment_type",class:"label"},"Физ лицо",-1))),Ye=le((()=>(0,a._)("br",null,null,-1))),Xe={class:"p-inputgroup"},et={key:8,class:"field col-12 md:col-4"},tt={key:9,class:"field col-12 md:col-4"},ot=le((()=>(0,a._)("label",{for:"amount",class:"label"},"сумма",-1))),lt=le((()=>(0,a._)("br",null,null,-1))),st={key:10,class:"field col-12 md:col-8"},at=le((()=>(0,a._)("label",{for:"tax",class:"label"},"сумма",-1))),it=le((()=>(0,a._)("br",null,null,-1))),nt={key:1},dt=le((()=>(0,a._)("div",{class:"inline-flex align-items-center"},[(0,a._)("i",{class:"pi pi-paperclip mr-2"}),(0,a.Uk)(" информация из чека ККМ ")],-1))),ct={class:"formgrid grid"},rt={class:"field col-12 md:col-3"},ut=le((()=>(0,a._)("label",{for:"waiter",class:"label"},"официант",-1))),mt=le((()=>(0,a._)("br",null,null,-1))),pt={class:"field col-12 md:col-3"},ht=le((()=>(0,a._)("label",{for:"check_number",class:"label"},"номер чека",-1))),gt=le((()=>(0,a._)("br",null,null,-1))),_t={class:"field col-12 md:col-3"},ft=le((()=>(0,a._)("label",{for:"cash_register_number",class:"label"},"номер кассы",-1))),yt=le((()=>(0,a._)("br",null,null,-1))),bt={class:"field col-12 md:col-3"},vt=le((()=>(0,a._)("label",{for:"amount_received",class:"label"},"получено",-1))),Ct=le((()=>(0,a._)("br",null,null,-1))),kt={class:"field col-12 md:col-3"},wt=le((()=>(0,a._)("label",{for:"table_number",class:"label"},"стол",-1))),Dt=le((()=>(0,a._)("br",null,null,-1))),St={class:"field col-12 md:col-3"},Tt=le((()=>(0,a._)("label",{for:"guest_number",class:"label"},"гость",-1))),At=le((()=>(0,a._)("br",null,null,-1))),Pt={class:"field col-12 md:col-3"},Wt=le((()=>(0,a._)("label",{for:"kkm_check_time",class:"label"},"время",-1))),It=le((()=>(0,a._)("br",null,null,-1))),Vt=le((()=>(0,a._)("div",{class:"field col-12 md:col-3"},null,-1))),Rt={class:"field col-12 md:col-2"},Ut=le((()=>(0,a._)("label",{for:"isReturn",class:"label"},"возврат",-1))),xt={class:"field col-12 md:col-2"},Et=le((()=>(0,a._)("label",{for:"isKKMChecked",class:"label"},"пробит",-1))),Ft={class:"field col-12 md:col-2"},Ot=le((()=>(0,a._)("label",{for:"is_Paid",class:"label"},"оплачен",-1))),Bt={class:"field col-12 md:col-2"},Nt=le((()=>(0,a._)("label",{for:"isPayedByCard",class:"label"},"эквайринг",-1))),Zt={class:"field col-12 md:col-2"},jt=le((()=>(0,a._)("label",{for:"isDelivery",class:"label"},"доставка",-1))),Mt={key:2},Ht=le((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),$t=le((()=>(0,a._)("br",null,null,-1)));function qt(e,t,o,l,s,i){const n=(0,a.up)("InputText"),d=(0,a.up)("Calendar"),c=(0,a.up)("Button"),r=(0,a.up)("Divider"),u=(0,a.up)("InputSwitch"),m=(0,a.up)("Column"),p=(0,a.up)("Row"),h=(0,a.up)("ColumnGroup"),g=(0,a.up)("DataTable"),_=(0,a.up)("OverlayPanel"),f=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[se,ae,i.doc.author&&i.doc.project?((0,a.wg)(),(0,a.iD)("div",ie,[(0,a._)("div",ne,[(0,a._)("div",de,[(0,a._)("p",ce,[(0,a._)("b",null,"Документ "+(0,P.zw)(i.doc.doc_type),1),(0,a.Uk)(" (автор "+(0,P.zw)(i.doc.author.name)+")",1)])]),(0,a._)("div",re,[(0,a._)("div",ue,[me,pe,(0,a.Wm)(n,{id:"number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext smallinput",modelValue:i.doc.number,"onUpdate:modelValue":t[0]||(t[0]=e=>i.doc.number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",he,[ge,_e,(0,a.Wm)(d,{id:"time",onChange:i.disableHoldButton,onDateSelect:i.disableHoldButton,modelValue:s.dateInput,"onUpdate:modelValue":t[1]||(t[1]=e=>s.dateInput=e),dateFormat:"dd.mm.yy",showIcon:!0},null,8,["onChange","onDateSelect","modelValue"])])]),(0,a._)("div",fe,[i.doc.doc_type===s.DocumentType.INVENTORY_DOC?((0,a.wg)(),(0,a.iD)("div",ye,[(0,a.Wm)(c,{label:"Заполнить",class:"p-button-rounded p-button-secondary mr-1",onClick:i.onFillRestClick,disabled:s.disabledFillItemRest},null,8,["onClick","disabled"]),(0,a.Wm)(c,{label:"Создать подчиненные документы",class:"p-button-rounded p-button-secondary",onClick:i.onCreateDockClick,disabled:s.disabledFillItemRest},null,8,["onClick","disabled"])])):(0,a.kq)("",!0)]),(0,a._)("div",be,[ve,Ce,(0,a._)("div",ke,[(0,a.Wm)(n,{id:"project",type:"text",class:"p-inputtext-sm",modelValue:i.doc.project.name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.doc.project.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),we,s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",De,[i.doc.storage_from?((0,a.wg)(),(0,a.iD)("div",Se,[Te,Ae,(0,a._)("div",Pe,[(0,a.Wm)(n,{id:"storageFrom",type:"text",class:"p-inputtext-sm",modelValue:i.doc.storage_from.name,"onUpdate:modelValue":t[3]||(t[3]=e=>i.doc.storage_from.name=e),disabled:s.disabledStorageFrom},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageFromClick,disabled:s.disabledStorageFrom},null,8,["onClick","disabled"])])])):(0,a.kq)("",!0)])),s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",We,[i.doc.storage_to?((0,a.wg)(),(0,a.iD)("div",Ie,[Ve,Re,(0,a._)("div",Ue,[(0,a.Wm)(n,{id:"storageTo",type:"text",class:"p-inputtext-sm",modelValue:i.doc.storage_to.name,"onUpdate:modelValue":t[4]||(t[4]=e=>i.doc.storage_to.name=e),disabled:s.disabledStorageTo},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageToClick,disabled:s.disabledStorageTo},null,8,["onClick","disabled"])])])):(0,a.kq)("",!0)])),s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",xe)),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Ee,[i.doc.supplier?((0,a.wg)(),(0,a.iD)("div",Fe,[Oe,Be,(0,a._)("div",Ne,[(0,a.Wm)(n,{id:"supplier",type:"text",class:"p-inputtext-sm",modelValue:i.doc.supplier.name,"onUpdate:modelValue":t[5]||(t[5]=e=>i.doc.supplier.name=e),disabled:s.disabledSupplier},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onSupplierClick},null,8,["onClick"])])])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Ze,[i.doc.recipient?((0,a.wg)(),(0,a.iD)("div",je,[Me,He,(0,a._)("div",$e,[(0,a.Wm)(n,{id:"recipient",type:"text",class:"p-inputtext-sm",modelValue:i.doc.recipient.name,"onUpdate:modelValue":t[6]||(t[6]=e=>i.doc.recipient.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onRecipientClick},null,8,["onClick"])])])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",qe)):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",Le,[ze,Ke,(0,a._)("div",Ge,[(0,a.Wm)(n,{id:"individual",type:"text",class:"p-inputtext-sm",modelValue:i.doc.individual.name,"onUpdate:modelValue":t[7]||(t[7]=e=>i.doc.individual.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onIndividualClick},null,8,["onClick"])])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",Je,[Qe,Ye,(0,a._)("div",Xe,[(0,a.Wm)(n,{id:"payment_type",type:"text",class:"p-inputtext-sm",modelValue:i.doc.payment_type,"onUpdate:modelValue":t[8]||(t[8]=e=>i.doc.payment_type=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onPaymentTypeClick},null,8,["onClick"])])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",et)):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",tt,[ot,lt,(0,a.Wm)(n,{id:"amount",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.amount,"onUpdate:modelValue":t[9]||(t[9]=e=>i.doc.amount=e)},null,8,["onChange","modelValue"])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",st,[at,it,(0,a.Wm)(n,{id:"tax",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.tax,"onUpdate:modelValue":t[10]||(t[10]=e=>i.doc.tax=e)},null,8,["onChange","modelValue"])])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),i.doc.check_info?((0,a.wg)(),(0,a.iD)("div",nt,[(0,a.Wm)(r,{align:"left"},{default:(0,a.w5)((()=>[dt])),_:1}),(0,a._)("div",ct,[(0,a._)("div",rt,[ut,mt,(0,a.Wm)(n,{id:"waiter",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.waiter,"onUpdate:modelValue":t[11]||(t[11]=e=>i.doc.check_info.waiter=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",pt,[ht,gt,(0,a.Wm)(n,{id:"check_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.check_number,"onUpdate:modelValue":t[12]||(t[12]=e=>i.doc.check_info.check_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",_t,[ft,yt,(0,a.Wm)(n,{id:"cash_register_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.cash_register_number,"onUpdate:modelValue":t[13]||(t[13]=e=>i.doc.check_info.cash_register_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",bt,[vt,Ct,(0,a.Wm)(n,{id:"amount_received",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.amount_received,"onUpdate:modelValue":t[14]||(t[14]=e=>i.doc.check_info.amount_received=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",kt,[wt,Dt,(0,a.Wm)(n,{id:"table_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.table_number,"onUpdate:modelValue":t[15]||(t[15]=e=>i.doc.check_info.table_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",St,[Tt,At,(0,a.Wm)(n,{id:"guest_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.guest_number,"onUpdate:modelValue":t[16]||(t[16]=e=>i.doc.check_info.guest_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Pt,[Wt,It,(0,a.Wm)(d,{id:"kkm_check_time",onChange:i.disableHoldButton,modelValue:s.checkDateInput,"onUpdate:modelValue":t[17]||(t[17]=e=>s.checkDateInput=e),showTime:!0,showSeconds:!0,dateFormat:"dd.mm.yy",disabled:""},null,8,["onChange","modelValue"])]),Vt,(0,a._)("div",Rt,[Ut,(0,a.Wm)(u,{id:"isReturn",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_return,"onUpdate:modelValue":t[18]||(t[18]=e=>i.doc.check_info.is_return=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",xt,[Et,(0,a.Wm)(u,{id:"isKKMChecked",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_KKM_checked,"onUpdate:modelValue":t[19]||(t[19]=e=>i.doc.check_info.is_KKM_checked=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Ft,[Ot,(0,a.Wm)(u,{id:"is_Paid",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_payed,"onUpdate:modelValue":t[20]||(t[20]=e=>i.doc.check_info.is_payed=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Bt,[Nt,(0,a.Wm)(u,{id:"isPayedByCard",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_payed_by_card,"onUpdate:modelValue":t[21]||(t[21]=e=>i.doc.check_info.is_payed_by_card=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Zt,[jt,(0,a.Wm)(u,{id:"isDelivery",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_delivery,"onUpdate:modelValue":t[22]||(t[22]=e=>i.doc.check_info.is_delivery=e)},null,8,["onChange","modelValue"])])])])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Mt,[(0,a.Wm)(c,{icon:"pi pi-plus",onClick:i.onAddItemClick,class:"p-button-text p-button-rounded"},null,8,["onClick"]),(0,a.Wm)(g,{value:i.doc.doc_items,rowClass:i.rowClass,editMode:"cell",onCellEditInit:i.onCellEditInit,onCellEditComplete:i.onCellEditComplete,class:"p-datatable-sm editable-cells-table",responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"item_name",header:"Наименование",key:"item_name"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onItemClick},null,8,["onClick"])])),_:1}),(0,a.Wm)(m,{field:"quantity",header:"Количество",key:"quantity"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{field:"quantity_fact",header:"Количество факт.",key:"quantity_fact"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(m,{field:"price",header:"Цена",key:"price"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(m,{field:"amount",header:"Сумма",key:"amount"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{field:"amount_fact",header:"Сумма факт.",key:"amount_fact"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),s.isCheck?((0,a.wg)(),(0,a.j4)(m,{field:"discount",header:"Скидка",key:"discount"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(m,{style:{width:"1rem"}},{body:(0,a.w5)((({data:e})=>[(0,a.Wm)(c,{icon:"pi pi-minus",class:"p-button-rounded p-button-secondary p-button-text mr-2",onClick:t=>i.deleteRow(e)},null,8,["onClick"])])),_:1}),(0,a.Wm)(h,{type:"footer"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{footer:"сумма:",colspan:s.colSpan,footerStyle:"text-align:right"},null,8,["colspan"]),(0,a.Wm)(m,{footer:i.totalAmount,colspan:s.colSpan2},null,8,["footer","colspan"]),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{key:0,footer:i.totalAmountFact,colspan:2},null,8,["footer"])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["value","rowClass","onCellEditInit","onCellEditComplete"])])):(0,a.kq)("",!0),(0,a.Wm)(_,{ref:"opPaymentTypes"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:s.paymentTypes,selection:s.selectedPaymentType,"onUpdate:selection":t[23]||(t[23]=e=>s.selectedPaymentType=e),selectionMode:"single",onRowSelect:i.onPaymentTypeSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"value",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(_,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[24]||(t[24]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(_,{ref:"opUsers"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.users,selection:s.selectedUsers,"onUpdate:selection":t[25]||(t[25]=e=>s.selectedUsers=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onUserSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:"",style:{width:"60%"}}),(0,a.Wm)(m,{field:"email",header:"email",sortable:"",style:{width:"40%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(_,{ref:"opCompanies"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.companies,selection:s.selectedCompany,"onUpdate:selection":t[26]||(t[26]=e=>s.selectedCompany=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onCompanySelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:"",style:{width:"60%"}}),(0,a.Wm)(m,{field:"inn",header:"email",sortable:"",style:{width:"40%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(_,{ref:"opStorage"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.storages,selection:s.selectedStorage,"onUpdate:selection":t[27]||(t[27]=e=>s.selectedStorage=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onStorageSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(f,{header:"Подбор номенклатуры",class:"border",visible:s.displayItems,"onUpdate:visible":t[31]||(t[31]=e=>s.displayItems=e),modal:!0,closable:!1,contentStyle:{height:"100%"},style:{width:"90%",height:"90%"}},{header:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(n,{class:"p-inputtext-sm mr-2",modelValue:s.filters["global"].value,"onUpdate:modelValue":t[28]||(t[28]=e=>s.filters["global"].value=e),placeholder:"поиск",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-plain p-button-sm",onClick:i.clearFilter},null,8,["onClick"])])])),footer:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"закрыть",icon:"pi pi-times",onClick:i.closeDialog,class:"p-button-text p-button-sm"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.items,class:"p-datatable-sm",selection:s.selectedItem,"onUpdate:selection":t[29]||(t[29]=e=>s.selectedItem=e),selectionMode:"single",filters:s.filters,"onUpdate:filters":t[30]||(t[30]=e=>s.filters=e),filterDisplay:"menu",globalFilterFields:["name"],onRowSelect:i.onItemSelect,responsiveLayout:"scroll",loading:s.loading},{loading:(0,a.w5)((()=>[Ht])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.storages,(e=>((0,a.wg)(),(0,a.j4)(m,{header:e.name,key:e.id},{body:(0,a.w5)((({data:t})=>[(0,a._)("div",{class:(0,P.C_)(i.boldClass(i.doc,e))},(0,P.zw)(i.getItemRestOnStorage(t,e)),3)])),_:2},1032,["header"])))),128)),(0,a.Wm)(m,{field:"price",header:"цена",sortable:""})])),_:1},8,["value","selection","filters","onRowSelect","loading"]),$t])),_:1},8,["visible"])],64)}var Lt=o(2482),zt=o(8223),Kt=o(6663),Gt=o(9755),Jt=o(7077),Qt=o(2958),Yt=o(3242),Xt=o(6358);const eo="localhost"==location.hostname?"http://localhost:8081":"",to={PROJECT:"PROJECT",STORAGE_FROM:"STORAGE_FROM",STORAGE_TO:"STORAGE_TO",ADD_REST_FOR_HOLD:"ADD_REST_FOR_HOLD",AVERAGE_COST:"AVERAGE_COST"},oo={POSTING_DOC:"Поступление",RECEIPT_DOC:"Оприходование",MOVEMENT_DOC:"Перемещение",CHECK_DOC:"Чек ККМ",CREDIT_ORDER_DOC:"ПКО",WITHDRAW_ORDER_DOC:"Расходный кассовый ордер",REQUEST_DOC:"Заявка",INVENTORY_DOC:"Инвентаризация"},lo={TAX_PAYMENT:"Оплата налога",CLIENT_PAYMENT:"Оплата от покупателя",SUPPLIER_PAYMENT:"Оплата поставщику",OTHER_PAYMENT:"Прочее",SALARY_PAYMENT:"Выплата заработной платы",SALE_CASH_PAYMENT:"Выручка наличными",SALE_CARD_PAYMENT:"Выручка по картам"};var so={name:"DocContent",components:{Calendar:zt.Z,InputText:k.Z,DataTable:G.Z,Column:J.Z,InputSwitch:Kt.Z,ColumnGroup:Gt.Z,Row:Jt.Z,Button:D.Z,OverlayPanel:Qt.Z,Divider:Yt.Z,Dialog:Q.Z},props:{docId:Number,type:String,docType:String},emits:{disableHoldButton:null,disableSaveButton:null},data(){return{filters:null,loading:!1,user:null,selectedPaymentType:null,selectedProject:null,selectedStorageFrom:null,disabledStorageFrom:!1,selectedStorageTo:null,disabledStorageTo:!1,is_hold:!0,selectedRow:null,selectedUsers:null,selectedRecipient:null,disabledRecipient:!1,selectedSupplier:null,disabledSupplier:!1,userType:null,companyType:null,selectedCompany:null,storageType:null,selectedStorage:null,selectedItem:null,dateInput:"",checkDateInput:"",currentField:null,currentData:null,itemSelectType:String,disabledFillItemRest:!0,orderDoc:!1,isInventory:!1,isCheck:!1,colSpan:3,colSpan2:2,DocumentType:oo,paymentTypes:[],displayItems:!1}},computed:{doc(){let e=this.$store.state.ds.document;return"copyToRequestDoc"===this.type&&(e.id=0,e.doc_type=oo.MOVEMENT_DOC,e.time=new Date),"copy"===this.type&&(e.date_time=new Date,this.disableSaveButton()),e},projects(){return this.$store.state.cs.projects},storages(){return this.$store.state.cs.storages},users(){return this.$store.state.cs.users},companies(){return this.$store.state.cs.companies},items(){return this.$store.state.is.items},totalAmount(){let e=0;for(let t of this.doc.doc_items)e+=t.amount-t.discount;return this.formatCurrency(e)},totalAmountFact(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity_fact;return this.formatCurrency(e)},itemRest(){return this.$store.state.ds.itemRest},defaultProperties(){return this.$store.state.ss.defaultProperties},period(){return this.$store.state.ss.period}},created(){this.initFilters()},mounted(){this.$store.dispatch("getDocument",[this.docId,this.docType]),this.user=JSON.parse(localStorage.getItem("user")),this.setPaymentTypes()},watch:{doc(e){if(e.doc_type!=oo.WITHDRAW_ORDER_DOC&&e.doc_type!=oo.CREDIT_ORDER_DOC||(this.orderDoc=!0),e.doc_type!=oo.POSTING_DOC&&e.doc_type!=oo.RECEIPT_DOC||(this.disabledStorageFrom=!0),e.doc_type!=oo.WRITE_OFF_DOC&&e.doc_type!=oo.CHECK_DOC&&e.doc_type!=oo.INVENTORY_DOC||(this.disabledStorageTo=!0),0==e.id){let t=this.users.filter((e=>e.id==this.user.id)).pop();if(e.author=t,this.defaultProperties.length>0){let t=this.defaultProperties.filter((e=>e.type==to.PROJECT)).pop().property;if(e.project=this.getProjectById(t),!this.disabledStorageTo){let t=this.defaultProperties.filter((e=>e.type==to.STORAGE_TO)).pop().property;e.storage_to=this.getStorageById(t)}if(!this.disabledStorageFrom){let t=this.defaultProperties.filter((e=>e.type==to.STORAGE_FROM)).pop().property;e.storage_from=this.getStorageById(t)}}}e.payment_type&&(this.selectedPaymentType=e.payment_type),e.storage_from&&(this.selectedStorageFrom=e.storage_from.id),e.storage_to&&(this.selectedStorageTo=e.storage_to.id),e.doc_type==oo.CHECK_DOC&&(this.isCheck=!0,this.colSpan2++),e.doc_type==oo.INVENTORY_DOC&&(this.isInventory=!0,this.colSpan++,this.colSpan2--),this.selectedProject=e.project,this.dateInput=e.date_time,e.check_info&&(this.checkDateInput=e.check_info.date_time),this.enableFillItemRestButton()},itemRest(e){this.doc.doc_items=e},dateInput(e){this.doc.date_time=e},items(){this.loading=!1}},methods:{clearFilter(){this.initFilters()},initFilters(){this.filters={global:{value:null,matchMode:Xt.a6.CONTAINS},name:{operator:Xt.pg.AND,constraints:[{value:null,matchMode:Xt.a6.STARTS_WITH}]}}},closeDialog(){this.displayItems=!1,this.clearFilter()},setPaymentTypes(){for(var e in this.paymentTypes=[],lo)this.paymentTypes.push({value:lo[e]})},rowClass(e){return!0===e.is_composite?"row-composite":null},boldClass(e,t){let o;if(o=e.doc_type==oo.WRITE_OFF_DOC||e.doc_type==oo.MOVEMENT_DOC||e.doc_type==oo.CHECK_DOC?e.storage_from:e.storage_to,o.id==t.id)return"b"},disableHoldButton(){this.$emit("disableHoldButton")},disableSaveButton(){this.$emit("disableSaveButton")},getProjectById(e){return this.projects.filter((t=>t.id==e)).pop()},getStorageById(e){return this.storages.filter((t=>t.id==e)).pop()},getItemRestOnStorage(e,t){for(let o of e.rest_list)if(o.storage.id==t.id)return o.quantity},deleteRow(e){this.doc.doc_items=this.doc.doc_items.filter((t=>t!=e)),this.$emit("disableHoldButton")},onPaymentTypeClick(e){this.$refs.opPaymentTypes.toggle(e)},onPaymentTypeSelect(e){this.doc.payment_type=e.data.value,this.$refs.opPaymentTypes.hide(),this.$emit("disableHoldButton")},enableFillItemRestButton(){0!=this.doc.author.id&&0!=this.doc.storage_from.id&&(this.disabledFillItemRest=!1)},onFillRestClick(){this.$store.dispatch("getRestOnDateAndStorage",[this.doc.id,this.dateInput,this.doc.storage_from.id]),this.$emit("disableHoldButton")},onCreateDockClick(){this.$store.dispatch("createRelativeDocks",this.doc)},onCellEditComplete(e){let{data:t,newValue:o,field:l}=e;"item_name"!=l&&(t[l]=o),"quantity"===l||"quantity_fact"===l||"price"===l||"discount"===l?(t["amount"]=t["price"]*t["quantity"],t["amount_fact"]=t["price"]*t["quantity_fact"]):"amount_fact"===l?(t["price"]=t["amount_fact"]/t["quantity_fact"],t["amount"]=t["price"]*t["quantity"]):"amount"===l&&(t["price"]=t["amount"]/t["quantity"],t["amount_fact"]=t["price"]*t["quantity_fact"])},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},onAuthorClick(e){this.userType="author",this.$refs.opUsers.toggle(e)},onUserSelect(e){"individual"==this.userType?this.doc.individual=e.data:this.doc.author=e.data,this.enableFillItemRestButton(),this.$refs.opUsers.hide(),this.$emit("disableHoldButton")},onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.doc.project=e.data,this.$refs.opProjects.hide(),this.$emit("disableHoldButton")},onRecipientClick(e){this.companyType="recipient",this.$refs.opCompanies.toggle(e)},onIndividualClick(e){this.userType="individual",this.$refs.opUsers.toggle(e)},onSupplierClick(e){this.companyType="supplier",this.$refs.opCompanies.toggle(e)},onCompanySelect(e){"recipient"==this.companyType?this.doc.recipient=e.data:this.doc.supplier=e.data,this.$refs.opCompanies.hide(),this.$emit("disableHoldButton")},onStorageFromClick(e){this.storageType="storageFrom",this.$refs.opStorage.toggle(e)},onStorageToClick(e){this.storageType="storageTo",this.$refs.opStorage.toggle(e)},onStorageSelect(e){"storageFrom"==this.storageType?(this.doc.storage_from=e.data,this.enableFillItemRestButton()):this.doc.storage_to=e.data,this.$refs.opStorage.hide(),this.$emit("disableHoldButton")},onItemClick(e){this.$store.dispatch("getItemsWithRest",this.doc.date_time),this.itemSelectType="update",this.$refs.opItems.toggle(e)},onAddItemClick(){this.$store.dispatch("getItemsWithRest",this.doc.date_time),this.itemSelectType="add",this.displayItems=!0},onCellEditInit(e){let{data:t,field:o}=e;"item_name"==o&&(this.currentField=o,this.currentData=t)},onItemSelect(e){this.displayItems=!1,"update"==this.itemSelectType?this.updateItem(e.data.id,e.data.name,e.data.price,e.data.is_composite):this.addItem(e.data.id,e.data.name,e.data.price,e.data.is_composite),this.$emit("disableHoldButton")},updateItem(e,t,o,l){this.currentData["item_id"]=e,this.currentData["item_name"]=t,this.currentData["price"]=o,this.currentData["is_composite"]=l,this.doc.doc_type!=oo.POSTING_DOC&&this.doc.doc_type!=oo.RECEIPT_DOC||(1==l?this.$emit("disableSaveButton",!0):ao(this.doc.doc_items)||this.$emit("disableSaveButton",!1))},addItem(e,t,o,l){1!=l||this.doc.doc_type!=oo.POSTING_DOC&&this.doc.doc_type!=oo.RECEIPT_DOC||this.$emit("disableSaveButton",!0),0==this.doc.doc_items.filter((t=>t.item_id===e)).length&&this.doc.doc_items.push(new io(this.doc.id,e,t,0,o,0,0,l))}}};function ao(e){let t=e.filter((e=>1==e.is_composite));return t.length>0}class io{constructor(e,t,o,l,s,a,i,n){(0,Lt.Z)(this,"document_id",0),(0,Lt.Z)(this,"item_id",0),(0,Lt.Z)(this,"item_name",""),(0,Lt.Z)(this,"quantity",0),(0,Lt.Z)(this,"price",0),(0,Lt.Z)(this,"discount",0),(0,Lt.Z)(this,"quantity_fact",0),(0,Lt.Z)(this,"is_composite",!1),this.document_id=e,this.item_id=t,this.item_name=o,this.quantity=l,this.price=s,this.discount=a,this.quantity_fact=i,this.is_composite=n}}const no=(0,c.Z)(so,[["render",qt],["__scopeId","data-v-baccdd10"]]);var co=no,ro="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAArtJREFUOI2Vk01IlFEUhp9z5xtnjEQKY1yUIoIztShM0EJTsoJAQyH6m5VSbYoMJVAQ6SM+F2E/WNAiCoJmZNxVlO3cVpuoTRCFhf05aTPNOKOfjXlbjNqoo9G7u/c993nPPZcrZNFJyypGxC+aRqAEKAAm0Iwg8lgZauB2V9fo8nOSuWgxTbfDyOkV9FnAlS1oXjOCvpmane25Z5r2Ctip3l6PhoeiqUJrEMmOARZ8LbwQaLrT3R0GUADt167lonkkmqp0xBqgDD8dzIMW03QvwuJTtgVUrk1YVbsMh/MSgJy0rGJB3qK1658dZaihppoij4fA0FMmp6ft3+gyhYgf+C/Q4fq9NNfVsdPnw1dSAuA2RPxK5mhYKOrwn+B6RztlRUWrghpraji4ezcAI1++8PrdOwD0HA0K0aWQftbNHg/rc3M5f/wY29KJS3SgqpKmuloARsfC9IcG+ZVKpU1FqQLZCKCBG4ODJKenyXE6OXfsKOXeskVQ9Y7tHNm/H4BwJEJ/KMSUbf9N0hQ4dtbvOwPkAfycTPDmw0cqtvpw5+RQ7vXybeIHxYWFtB5qREQYj0bpCwSIJZLLGx9zlNfvaxZYHFIskeDNyAcqfD7cLhcVPi/l3jKUUkTica4EgkTjk9nG+UoJ8mT57qdwmL5AkFgiiVIKpRSxRJKrwQF+xGJZH0aEIaUMNQDYaL3E/Do+Tt/9+0Tjk0zZNv2hEN8jkawgwNYpIygApy2rTyMXslVt2rCBXJeL0bGxlaYGBLTm8t2e7i4DIDU72+NwOvcs/s0MjUej2XuZB6F5ti4/7yLM/817pmkLNAHPV7vHCs2DjN+p5pttbTMAjgXv5fBwcnttbVCJw4VQARhroGytubouP6/lVmdnPJO/Qq2WtcUQ8es5GlCUoilAmEDzXoQhnTKCd8zOz8vP/QHJVfIIEVziNAAAAABJRU5ErkJggg==",uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAkZJREFUOI2dlE9IVFEUxn/nvvvSBJFqzFyE1KBrEwldth4XQQtzVol/NpFQBE4M5kPmTTtBbBFm4CK1yEWLcu1Oo6JoF2oLcWVaVGBj7807LWYGVExzvtW5597vd797L1zhAPVkMg2IJEXpAC4AMWAT5Qsir4w1MxOp1Np+n+we3PC8Ssee8AW9CVQctFFRO4KOB2E4NOV5uVLTlIpe369zXHdB0DuARXmKSiIM3fofTY02DN16FTpApgGryF3HdRd6fb9uT7Lbo6Mnf23/XgAuAysI1ybT6U//itXn+82qzAFxYCkMgytTnpczAD+3c5kSyIRB+2EggMfp9Me8kXZgFWizjjsCID2ZTIMgnwGL0HIUaLd6Rh5cEhO9BYI82mQQSQIVKLPHAQE8uX/vA8pzoNKKJI1EJApTMnscUElS9GlEwiAaB7D5P+/KgQV5W/AZ4gbkNMA5+FYO7ER9zRYASswAWwDrrnumHBibm7Fi9dVo4XlRaC2HlVct+VaNIK8BRKWrHJhgugBEmDfGmhkgB3q9z/ebjwPq9/0W0E4gp4GdNhOp1JqgDwFHlbnubLb2f0Dd2WxtpLwAjCpjk97gugEIwnBIhTdA3Il08aiE/b7f4kS6BFxEWayqqR4uHLmoXt+vQ3kJtAERyKwoz8To+++NjRunlpfP5lVbC3eknYBBWbT54Oojz9vYA4PCf2YddwThFlB5SLicKmNVNdXD4wMDO6WmHLSyO5M5b0WSGpHAEEeJIWyirIgwr4GdnvQG1/f7/gJtw9j8wcrxuwAAAABJRU5ErkJggg==";const mo=e=>((0,a.dD)("data-v-28f1580a"),e=e(),(0,a.Cn)(),e),po=mo((()=>(0,a._)("br",null,null,-1))),ho={class:"formgrid grid"},go={class:"col-12 md:col-7 center"},_o={class:"col-12 md:col-5 center"},fo={class:"center right"},yo={key:0,class:"mr-2"},bo={class:"mr-2"},vo={key:0,class:"formgrid grid"},Co={class:"col-12 md:col-4"},ko=mo((()=>(0,a._)("label",{for:"author",class:"label"},"автор",-1))),wo={id:"author",class:"text_field"},Do={class:"col-12 md:col-4"},So=mo((()=>(0,a._)("label",{for:"project",class:"label"},"проект",-1))),To={id:"project",class:"text_field"},Ao=mo((()=>(0,a._)("div",{class:"col-12 md:col-4"},null,-1))),Po={key:0,class:"col-12 md:col-4"},Wo=mo((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),Io={id:"storageFrom",class:"text_field"},Vo={key:1,class:"col-12 md:col-4"},Ro=mo((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),Uo={id:"storageTo",class:"text_field"},xo={key:2,class:"col-12 md:col-4"},Eo={key:3,class:"field col-12 md:col-4"},Fo=mo((()=>(0,a._)("label",{for:"supplier",class:"label"},"отправитель",-1))),Oo={id:"supplier",class:"text_field"},Bo={key:4,class:"field col-12 md:col-4"},No=mo((()=>(0,a._)("label",{for:"recipient",class:"label"},"получатель",-1))),Zo={id:"recipient",class:"text_field"},jo={key:5,class:"field col-12 md:col-4"},Mo={key:1},Ho=mo((()=>(0,a._)("div",{class:"inline-flex align-items-center"},[(0,a._)("i",{class:"pi pi-paperclip mr-2"}),(0,a.Uk)(" информация из чека ККМ ")],-1))),$o={class:"formgrid grid"},qo={class:"col-12 md:col-3"},Lo=mo((()=>(0,a._)("label",{for:"waiter",class:"label"},"официант",-1))),zo={id:"waiter",class:"text_field sm"},Ko={class:"col-12 md:col-3"},Go=mo((()=>(0,a._)("label",{for:"check_number",class:"label"},"номер чека",-1))),Jo={id:"check_number",class:"text_field sm"},Qo={class:"col-12 md:col-3"},Yo=mo((()=>(0,a._)("label",{for:"cash_register_number",class:"label"},"номер кассы",-1))),Xo={id:"cash_register_number",class:"text_field sm"},el={class:"col-12 md:col-3"},tl=mo((()=>(0,a._)("label",{for:"amount_received",class:"label"},"получено",-1))),ol={id:"amount_received",class:"text_field sm"},ll={class:"col-12 md:col-3"},sl=mo((()=>(0,a._)("label",{for:"table_number",class:"label"},"стол",-1))),al={id:"table_number",class:"text_field sm"},il={class:"col-12 md:col-3"},nl=mo((()=>(0,a._)("label",{for:"guest_number",class:"label"},"гость",-1))),dl={id:"guest_number",class:"text_field sm"},cl={class:"col-12 md:col-3"},rl=mo((()=>(0,a._)("label",{for:"kkm_check_time",class:"label"},"время",-1))),ul={id:"kkm_check_time",class:"text_field sm"},ml=mo((()=>(0,a._)("div",{class:"col-12 md:col-3"},null,-1))),pl={class:"col-12 md:col-2 center"},hl=mo((()=>(0,a._)("p",null,"возврат ",-1))),gl={key:0,src:ro,class:"ml-2"},_l={key:1,src:uo,class:"ml-2"},fl={class:"col-12 md:col-2 center"},yl=mo((()=>(0,a._)("p",null,"пробит ",-1))),bl={key:0,src:ro,class:"ml-2"},vl={key:1,src:uo,class:"ml-2"},Cl={class:"col-12 md:col-2 center"},kl=mo((()=>(0,a._)("p",null,"оплачен ",-1))),wl={key:0,src:ro,class:"ml-2"},Dl={key:1,src:uo,class:"ml-2"},Sl={class:"col-12 md:col-2 center"},Tl=mo((()=>(0,a._)("p",null,"эквайринг ",-1))),Al={key:0,src:ro,class:"ml-2"},Pl={key:1,src:uo,class:"ml-2"},Wl={class:"col-12 md:col-2 center"},Il=mo((()=>(0,a._)("p",null,"доставка ",-1))),Vl={key:0,src:ro,class:"ml-2"},Rl={key:1,src:uo,class:"ml-2"},Ul={key:2},xl={class:"formgrid grid"},El={class:"col-12 md:col-4"},Fl={for:"individual",class:"label"},Ol=mo((()=>(0,a._)("br",null,null,-1))),Bl={id:"individual",class:"text_field"},Nl=mo((()=>(0,a._)("div",{class:"col-12 md:col-8"},null,-1))),Zl={class:"field col-12 md:col-8"},jl=mo((()=>(0,a._)("label",{for:"payment_type",class:"label"},"назначение платежа",-1))),Ml=mo((()=>(0,a._)("br",null,null,-1))),Hl={id:"payment_type",class:"text_field lm"},$l=mo((()=>(0,a._)("div",{class:"field col-12 md:col-4"},null,-1))),ql={class:"field col-12 md:col-4"},Ll=mo((()=>(0,a._)("label",{for:"amount",class:"label"},"сумма",-1))),zl=mo((()=>(0,a._)("br",null,null,-1))),Kl={id:"amount",class:"text_field"},Gl={class:"field col-12 md:col-4"},Jl=mo((()=>(0,a._)("label",{for:"tax",class:"label"},"оплата налога",-1))),Ql=mo((()=>(0,a._)("br",null,null,-1))),Yl={id:"tax",class:"text_field"},Xl=mo((()=>(0,a._)("div",{class:"field col-12 md:col-4"},null,-1))),es=mo((()=>(0,a._)("br",null,null,-1))),ts={key:3};function os(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("Divider"),c=(0,a.up)("Column"),r=(0,a.up)("Row"),u=(0,a.up)("ColumnGroup"),m=(0,a.up)("DataTable");return(0,a.wg)(),(0,a.iD)(a.HY,null,[po,(0,a._)("div",ho,[(0,a._)("div",go,[(0,a._)("h4",null,(0,P.zw)(s.header),1)]),(0,a._)("div",_o,[(0,a._)("div",fo,[i.doc.doc_type===s.DocumentType.REQUEST_DOC?((0,a.wg)(),(0,a.iD)("div",yo,[(0,a.Wm)(n,{label:"Перемещение",class:"p-button-rounded p-button-secondary p-button-outlined",onClick:i.onRequestClick},null,8,["onClick"])])):(0,a.kq)("",!0),(0,a._)("div",bo,[(0,a.Wm)(n,{label:"Изменить",class:"p-button-sm p-button-rounded p-button-secondary",onClick:i.onUpdateClick,disabled:s.disableRedactoring},null,8,["onClick","disabled"])]),(0,a._)("div",null,[(0,a.Wm)(n,{label:"Копировать",class:"p-button-sm p-button-rounded p-button-secondary",onClick:i.onCopyClick},null,8,["onClick"])])])])]),i.doc.author?((0,a.wg)(),(0,a.iD)("div",vo,[(0,a._)("div",Co,[ko,(0,a._)("p",wo,(0,P.zw)(i.doc.author.name),1)]),(0,a._)("div",Do,[So,(0,a._)("p",To,(0,P.zw)(i.doc.project.name),1)]),Ao,i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Po,[Wo,(0,a._)("p",Io,(0,P.zw)(i.doc.storage_from?i.doc.storage_from.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Vo,[Ro,(0,a._)("p",Uo,(0,P.zw)(i.doc.storage_to?i.doc.storage_to.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",xo)):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Eo,[Fo,(0,a._)("p",Oo,(0,P.zw)(i.doc.supplier?i.doc.supplier.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Bo,[No,(0,a._)("p",Zo,(0,P.zw)(i.doc.recipient?i.doc.recipient.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",jo)):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.check_info?((0,a.wg)(),(0,a.iD)("div",Mo,[(0,a.Wm)(d,{align:"left"},{default:(0,a.w5)((()=>[Ho])),_:1}),(0,a._)("div",$o,[(0,a._)("div",qo,[Lo,(0,a._)("p",zo,(0,P.zw)(i.doc.check_info.waiter),1)]),(0,a._)("div",Ko,[Go,(0,a._)("p",Jo,(0,P.zw)(i.doc.check_info.check_number),1)]),(0,a._)("div",Qo,[Yo,(0,a._)("p",Xo,(0,P.zw)(i.doc.check_info.cash_register_number),1)]),(0,a._)("div",el,[tl,(0,a._)("p",ol,(0,P.zw)(i.doc.check_info.amount_received),1)]),(0,a._)("div",ll,[sl,(0,a._)("p",al,(0,P.zw)(i.doc.check_info.table_number),1)]),(0,a._)("div",il,[nl,(0,a._)("p",dl,(0,P.zw)(i.doc.check_info.guest_number),1)]),(0,a._)("div",cl,[rl,(0,a._)("p",ul,(0,P.zw)(s.checkDate),1)]),ml,(0,a._)("div",pl,[hl,i.doc.check_info.is_return?((0,a.wg)(),(0,a.iD)("img",gl)):((0,a.wg)(),(0,a.iD)("img",_l))]),(0,a._)("div",fl,[yl,i.doc.check_info.is_KKM_checked?((0,a.wg)(),(0,a.iD)("img",bl)):((0,a.wg)(),(0,a.iD)("img",vl))]),(0,a._)("div",Cl,[kl,i.doc.check_info.is_payed?((0,a.wg)(),(0,a.iD)("img",wl)):((0,a.wg)(),(0,a.iD)("img",Dl))]),(0,a._)("div",Sl,[Tl,i.doc.check_info.is_payed_by_card?((0,a.wg)(),(0,a.iD)("img",Al)):((0,a.wg)(),(0,a.iD)("img",Pl))]),(0,a._)("div",Wl,[Il,i.doc.check_info.is_delivery?((0,a.wg)(),(0,a.iD)("img",Vl)):((0,a.wg)(),(0,a.iD)("img",Rl))])])])):(0,a.kq)("",!0),i.doc.doc_items?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Ul,[(0,a._)("div",xl,[(0,a._)("div",El,[(0,a._)("label",Fl,(0,P.zw)(i.doc.doc_type==s.DocumentType.WITHDRAW_ORDER_DOC?"получатель":"плательщик"),1),Ol,(0,a._)("p",Bl,(0,P.zw)(i.getName(i.doc.individual)),1)]),Nl,(0,a._)("div",Zl,[jl,Ml,(0,a._)("p",Hl,(0,P.zw)(i.doc.payment_type),1)]),$l,(0,a._)("div",ql,[Ll,zl,(0,a._)("p",Kl,(0,P.zw)(i.doc.amount),1)]),(0,a._)("div",Gl,[Jl,Ql,(0,a._)("p",Yl,(0,P.zw)(i.doc.tax),1)]),Xl])])),es,i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",ts,[(0,a.Wm)(m,{value:i.doc.doc_items,editMode:"cell",class:"p-datatable-sm",responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{field:"item_name",header:"Наименование",key:"item_name"}),(0,a.Wm)(c,{field:"quantity",header:"Количество",key:"quantity"}),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{field:"quantity_fact",header:"Количество факт.",key:"quantity_fact"})):(0,a.kq)("",!0),(0,a.Wm)(c,{field:"price",header:"Цена",key:"price"}),(0,a.Wm)(c,{field:"amount",header:"Сумма",key:"price"}),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{field:"amount_fact",header:"Сумма факт.",key:"amount_fact"})):(0,a.kq)("",!0),s.isCheck?((0,a.wg)(),(0,a.j4)(c,{field:"discount",header:"Скидка",key:"discount"})):(0,a.kq)("",!0),(0,a.Wm)(u,{type:"footer"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{footer:"сумма:",colspan:s.colSpan,footerStyle:"text-align:right"},null,8,["colspan"]),(0,a.Wm)(c,{footer:i.totalAmount},null,8,["footer"]),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{key:0,footer:i.totalAmountFact},null,8,["footer"])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["value"])])):(0,a.kq)("",!0)],64)}var ls={name:"Document",components:{DataTable:G.Z,Column:J.Z,ColumnGroup:Gt.Z,Row:Jt.Z,Button:D.Z,Divider:Yt.Z},data(){return{header:"",checkDate:"",isInventory:!1,isCheck:!1,isPosting:!1,colSpan:3,DocumentType:oo,disableRedactoring:!1}},props:{docId:Number},emits:{openUpdateDoc:null,openCopyDoc:null,copyToRequestDoc:null},computed:{doc(){return this.$store.state.ds.document},totalAmount(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity-t.discount;return this.formatCurrency(e)},totalAmountFact(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity_fact;return this.formatCurrency(e)}},methods:{getName(e){if(e)return e.name},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},onRequestClick(){this.$emit("copyToRequestDoc",this.doc)},onUpdateClick(){this.$emit("openUpdateDoc",this.doc)},onCopyClick(){this.$emit("openCopyDoc",this.doc)},setEnableRedactoring(e,t){this.disableRedactoring=e.id!=t.author.id&&"ADMIN"!=e.role}},mounted(){this.$store.dispatch("getDocument",[this.docId,""])},watch:{doc(e){let t="Документ "+e.doc_type+" № "+e.number+" от "+ss(e.date_time);e.is_hold?t+=" (проведен)":e.is_deleted?t+=" (удален)":t+=" (не проведен)",this.header=t,e.check_info&&(this.checkDate=ss(e.check_info.date_time,!0)),e.doc_type==oo.CHECK_DOC&&(this.isCheck=!0,this.colSpan++),e.doc_type==oo.INVENTORY_DOC&&(this.isInventory=!0,this.colSpan++);let o=JSON.parse(localStorage.getItem("user"));this.setEnableRedactoring(o,e)}}};function ss(e,t){let o={day:"numeric",month:"numeric",year:"numeric"};return t&&(o.hour="numeric",o.minute="numeric",o.second="numeric"),e.toLocaleString("ru-Ru",o)}const as=(0,c.Z)(ls,[["render",os],["__scopeId","data-v-28f1580a"]]);var is=as,ns="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAbkAAAG5AE6/zBQAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAABCZJREFUSIm1l89vVFUUxz/nzrRI+bFQASttBRYGlW6UTUvUB2oQDSBJp41EF+7cEAv0h8Rob5WQ2M6MMRL8B4w1nRgUFzUQmakxxYSQGEsnJibaQENFZENHLLTvHRfz3nSonZk3imd1zzs/vueed+/5vieEkNhwLHI927TNRfYCWwXWAQ0KInANuKzoWATzjceKsxlr5yvllHLG3dbW3ZDcG6IcBNaEKRL4JGPjr1ZyipYyOP3dHTOaS4iyfgnzLDANuOR3vyowKPpwmOr+CWytccgdQ7V3IRmewAjCyRo1I2fswJU7irRdHwCdAAa+rB7YWrOd3GcKsSLQ04L0ZuzgDyVyiCJ7BAVQNyJDVQM75I4VgSrw7qiN23IJdthDLR66yVfHvn07/mtVwE5/d0fQXgXPiLSn+wY/r5TAw7xcUCTcbgEMQEvy4HJU4wsJeDMMqGNtFCTo0Hytaqoq4NqZSCfQAPl3OtoXHwwTrDLzHOi6IO60jf8eGjg2HIv499Q/vdJbKagQrFJos0DoNgOY69mmbfjDQWCkzOm9Q3ZbW6ewz1f/hJtfVAMcdZG9hfElnAwbOENuD7AyHyan0vZEbim/XfbA6lvUbPHENKPaLJh7FUlGBZ4InGrUjFRR9P5gofBpzNraP8yNR/DMY4o2gzQDW/6ChwInEBQFtDGqUO/vePaMHZgOg/jMsSP3zd+e2xl0StHENXIb8UxN/klZCgC0ISpQ72vTQV2VxJ2baxOoDXSBUvP5FpAFJgQZV7QTqAdZU5Ikytar7C/ekz/LfwHGBS56IuNq5KJx634upkjHdr3uL72owrTk2aU+X3z5XfttnlVIGmRCkR9XU5f9ytqbFeoV4EF/fUUc25UGHIAazPrFzHO3xLE9DeBdzmuaNiAXAuMc7gv/BygA4r0YLBXOGzUL/KnIvqWj7oIoLwVLY8wps3bz5Bj57yaA53fY7sfvNqZje7YCO/OaXL1/8+T3JtWechESAALGQ9+n8kWsRgS8wSCniiZS7SnXAKArPwT8F8+zju0OTRSVxLGH38I/vMDU7VXucYAIwGQmM7/Babnsc6so7NjktP40mRmb+E+g/d0dCsfFv6YqvPbdkeR4ATgPfi670WldBjzpO7ZtcFplMjM2+i8wxenv6lXlhPicL3A0Y+MfFxzucLfWPE1uSKA9eKRw1hjtSb+TuEAIyR8kdwBk+wKIDKVZ8QrWeksDF8Bn3hPkSJFdga9VOClqRjJ2YKo45Kmjhxoj87LLv447i+MEjqZtvI9FE7Hk6XXs4TaQJNC4hPkWqM9kUg8sW+ygcAmhc7QvviTHl702LcmDy++5ET3goYcF1pbzLUp5VUUTois/ylg7W9IrTKrYcCxyLdvUgv/TBjyA/3EITAG/CZxX9NSaRy+dS7Wn3Eo5/wbalYNAyWCocwAAAABJRU5ErkJggg==";const ds=e=>((0,a.dD)("data-v-4612b166"),e=e(),(0,a.Cn)(),e),cs={class:"mb-3"},rs=ds((()=>(0,a._)("img",{alt:"logo",src:ns,height:"30",class:"mr-2"},null,-1))),us={class:"conteiner"};function ms(e,t,o,l,s,i){const n=(0,a.up)("UserAvatar"),d=(0,a.up)("Button"),c=(0,a.up)("Menubar");return(0,a.wg)(),(0,a.iD)("div",cs,[(0,a.Wm)(c,{model:s.items},{start:(0,a.w5)((()=>[rs])),end:(0,a.w5)((()=>[(0,a._)("div",us,[(0,a.Wm)(n),(0,a.Wm)(d,{label:"logout",onClick:t[0]||(t[0]=t=>e.logout()),class:"p-button-sm p-button-rounded"})])])),_:1},8,["model"])])}var ps=o(8553);const hs={key:0,class:"name"};function gs(e,t,o,l,s,i){const n=(0,a.up)("Avatar");return s.user?((0,a.wg)(),(0,a.iD)("div",hs,[(0,a.Wm)(n,{label:s.label,class:"avatar mr-1",shape:"circle"},null,8,["label"]),(0,a.Uk)(" "+(0,P.zw)(s.user.first_name+" "+s.user.last_name+" ("+s.user.role+")"),1)])):(0,a.kq)("",!0)}var _s=o(396),fs={name:"LoginForm",components:{Avatar:_s.Z},data(){return{user:null,label:""}},watch:{},mounted(){this.user=JSON.parse(localStorage.getItem("user")),this.label=this.user.first_name.substring(0,1)},methods:{}};const ys=(0,c.Z)(fs,[["render",gs],["__scopeId","data-v-664c5a96"]]);var bs=ys,vs={name:"MainMenu",components:{Menubar:ps.Z,UserAvatar:bs,Button:D.Z},data(){return{items:[{label:"Документы",icon:"pi pi-fw pi-file",to:"/documents/posting"},{label:"Номенклатура",icon:"pi pi-fw pi-shopping-bag",to:"/items"},{label:"Пользователи",icon:"pi pi-fw pi-users",to:"/users"},{label:"Настройки",icon:"pi pi-fw pi-cog",to:"/settings"}]}}};const Cs=(0,c.Z)(vs,[["render",ms],["__scopeId","data-v-4612b166"]]);var ks=Cs,ws=o(7791),Ds=o(8832),Ss={name:"DocContent",components:{DataTable:G.Z,Column:J.Z,Button:D.Z,Dialog:Q.Z,DocTabs:oe,DocRedactor:co,Document:is,MainMenu:ks,OverlayPanel:Qt.Z,Menu:ws.Z,Calendar:zt.Z,RadioButton:Ds.Z},props:{filter:String},data(){return{user:null,displayDocument:!1,docId:0,type:String,header:String,selectedProduct:null,showDialogHeader:!1,docRedactor:Boolean,docType:null,data:null,displayConfirmation:!1,displaySaveDialog:!1,holdLable:"",confirmationMessage:"",confirmationType:"",buttonNoEnabled:!0,deleteLable:"Удалить",firstDate:null,lastDate:null,DocumentType:oo,disabledHoldButton:!1,disabledSaveButton:!1,startPeriod:null,menuModel:[],salectedSaveTime:"dayEnd",items:[{label:"Документы",icon:"pi pi-fw pi-file",to:"/documents/posting"},{label:"Номенклатура",icon:"pi pi-fw pi-shopping-bag",to:"/items"},{label:"Пользователи",icon:"pi pi-fw pi-users",to:"/users"},{label:"Настройки",icon:"pi pi-fw pi-cog",to:"/settings"}]}},computed:{documents(){return this.$store.state.ds.documents},document(){return this.$store.state.ds.document},success(){return this.$store.state.success},docTypes(){return this.$store.state.cs.docTypes},startDate(){return this.$store.state.ds.startDate},endDate(){return this.$store.state.ds.endDate},exsistNotHoldenDocs(){return this.$store.state.ds.exsistNotHoldenDocs},period(){return this.$store.state.ss.period}},mounted(){this.firstDate=this.$store.state.ds.startDate,this.lastDate=this.$store.state.ds.endDate,this.$store.dispatch("getDocuments",this.filter),this.user=JSON.parse(localStorage.getItem("user")),this.period&&(this.startPeriod=new Date(this.period.start_date)),this.salectedSaveTime="dayEnd"},watch:{period(e){this.startPeriod=new Date(e.start_date)},filter(e){this.$store.dispatch("getDocuments",e)},success(){this.$store.dispatch("getDocuments",this.filter)},document(e){this.holdLable=e.is_hold?"Отменить проведение":e.doc_type==this.DocumentType.MOVEMENT_DOC?"Подтвердить получение":"Провести",e.date_time<this.startPeriod?(this.disabledHoldButton=!0,this.disabledSaveButton=!0):(this.disabledHoldButton=!1,this.disabledSaveButton=!1)},confirmationType(e){this.buttonNoEnabled=!0,"hold"==e?this.confirmationMessage="Провести документ?":"save"==e?this.confirmationMessage="save":"delete"==e?this.confirmationMessage="Удалить документ?":"unDelete"==e?this.confirmationMessage="Отменить удаление документа?":"price"==e?(this.buttonNoEnabled=!1,this.confirmationMessage="Для проведения заполните все цены в документе"):"serialHold"==e?1==this.document.is_hold?this.confirmationMessage="После этого документа есть другие проведенные документы. Отменить их проведение?":this.confirmationMessage="Есть более ранние не проведенные документы. Провести их?":"choseTime"==e&&(this.confirmationMessage="Выберете время сохранения документа")},startDate(e){this.firstDate=e},endDate(e){this.lastDate=e},exsistNotHoldenDocs(){this.confirmationType="serialHold",this.displayConfirmation=!0},type(e){this.salectedSaveTime="update"==e?"currentTime":"dayEnd"}},methods:{aaa(){this.$store.dispatch("getAAA")},getName(e){if(e)return e.name},iconClass(e){let t,o;return e.is_hold?(t="pi-check-circle",o="true-icon"):e.is_hold||(t="pi-circle",o="neutral-icon"),e.is_deleted&&(t="pi-times-circle",o="false-icon"),e.date_time<this.startPeriod&&(o="disabled"),o+" "+t},disabledClass(e){return e.date_time<this.startPeriod?"disabled":null},disableHoldButton(){this.disabledHoldButton=!0},disableSaveButton(e){this.disabledSaveButton=e},setStartDate(e){this.$store.dispatch("setStartDate",e)},setEndDate(e){this.$store.dispatch("setEndDate",e)},getToolTipText(e){return e.is_hold?"проведен":e.is_deleted?"удален":"не проведен"},toggleModalMenu(e,t){this.data=t,this.menuModel=[];let o={label:"Копировать",icon:"pi pi-copy",command:()=>{this.openCopyDocumentRedactor(this.data)}};if(this.menuModel.push(o),("ADMIN"==this.user.role||t.author.id==this.user.id)&&t.date_time>=this.startPeriod){let e={label:"Изменить",icon:"pi pi-pencil",command:()=>this.openUpdateDocumentRedactor(this.data)};this.menuModel.push(e);let o="";t.is_deleted?(o="Отменить",this.confirmationType="unDelete"):(o="Удалить",this.confirmationType="delete");let l={label:o,icon:"pi pi-times",command:()=>this.openConfirmation(t)};this.menuModel.push(l)}this.$refs.menu.toggle(e)},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},deleteDocument(){this.$store.dispatch("deleteDocument",this.data),this.closeConfirmation()},openDocument(e){this.docRedactor=!1,this.docId=e.data.id,this.displayDocument=!0},openNewDocument(e){this.docRedactor=!0,this.docType=e,this.docId=0,this.type="add",this.displayDocument=!0},openRequestDocRedactor(e){this.docRedactor=!0,this.docType=this.DocumentType.REQUEST_DOC,this.docId=e.id,this.type="copyToRequestDoc",this.displayDocument=!0},openUpdateDocumentRedactor(e){this.docRedactor=!0,this.docId=e.id,this.type="update",this.displayDocument=!0},openCopyDocumentRedactor(e){this.docRedactor=!0,this.docId=e.id,this.type="copy",this.displayDocument=!0},closeDocument(){this.displayDocument=!1},choseSavingTime(){this.confirmationType="choseTime",this.displayConfirmation=!0},saveDocument(){this.displaySaveDialog=!1,"update"==this.type?this.$store.dispatch("updateDocument",[this.document,this.salectedSaveTime]):(this.document.id=0,this.$store.dispatch("addDocument",[this.document,this.salectedSaveTime])),0==this.document.is_hold?(this.confirmationType="hold",this.displayConfirmation=!0):this.displayDocument=!1},serialHoldDocument(){this.$store.dispatch("serialHoldDocument",this.document.id),this.displayConfirmation=!1},holdDocument(){this.displayConfirmation=!1,this.checkPrices()?(this.$store.dispatch("holdDocument",this.document.id),this.displayDocument=!1):(this.confirmationType="price",this.displayConfirmation=!0)},checkPrices(){if(this.document.doc_type==this.DocumentType.INVENTORY_DOC)for(let e of this.document.doc_items)if(0==e.price)return!1;return!0},logout(){this.$store.dispatch("logout")},chooseDocType(e){this.$refs.opDocTypes.toggle(e)},addNewDocByType(e){this.openNewDocument(e),this.$refs.opDocTypes.hide()},openConfirmation(e){this.data=e,this.displayConfirmation=!0},closeConfirmation(){this.displayConfirmation=!1,this.displayDocument=!1,this.confirmationType=""},positiveConfirmation(){"delete"==this.confirmationType||"unDelete"==this.confirmationType?this.deleteDocument():"hold"==this.confirmationType?this.holdDocument():"serialHold"==this.confirmationType?this.serialHoldDocument():this.displayConfirmation=!1,this.confirmationType=""},openSaveDocDialog(){this.displaySaveDialog=!0},closeSaveDocDialog(){this.displaySaveDialog=!1},resetDocuments(){this.$store.dispatch("getDocuments",this.filter)}}};const Ts=(0,c.Z)(Ss,[["render",K],["__scopeId","data-v-5f912415"]]);var As=Ts;const Ps={class:"conteiner"};function Ws(e,t,o,l,s,i){const n=(0,a.up)("MainMenu"),d=(0,a.up)("ItemTree"),c=(0,a.up)("ItemForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(n),(0,a._)("div",Ps,[(0,a.Wm)(d),(0,a.Wm)(c)])],64)}const Is={class:"tree"};function Vs(e,t,o,l,s,i){const n=(0,a.up)("Tree");return(0,a.wg)(),(0,a.iD)("div",Is,[(0,a.Wm)(n,{value:i.nodes,expandedKeys:i.expandedKeys,selectionMode:"single",selectionKeys:s.selectedKey,"onUpdate:selectionKeys":t[0]||(t[0]=e=>s.selectedKey=e),metaKeySelection:!1,onNodeCollapse:i.onNodeCollapse,onNodeExpand:i.onNodeExpand,onNodeSelect:i.onNodeSelect},null,8,["value","expandedKeys","selectionKeys","onNodeCollapse","onNodeExpand","onNodeSelect"])])}var Rs=o(582),Us={name:"ItemTree",components:{Tree:Rs.Z},data(){return{selectedKey:null,parentNode:null}},computed:{nodes(){return this.$store.state.is.itemTree},expandedKeys(){let e=this.$store.state.is.expandedKeys;return e}},mounted(){this.$store.dispatch("getItemTree")},methods:{onNodeSelect(e){e.is_node?this.$store.dispatch("setParentNode",e):(this.$store.dispatch("getItem",e.data),this.$store.dispatch("delCrumbs"))},onNodeExpand(e){e.is_node&&(e.icon="pi pi-fw pi-folder-open",this.$store.dispatch("setParentNode",e))},onNodeCollapse(e){e.is_node&&(e.icon="pi pi-fw pi-folder")}}};const xs=(0,c.Z)(Us,[["render",Vs],["__scopeId","data-v-3d815483"]]);var Es=xs;const Fs=e=>((0,a.dD)("data-v-0ba9e1a0"),e=e(),(0,a.Cn)(),e),Os={class:"itemform"},Bs=["onClick"],Ns={class:"header"},Zs={class:"formgrid grid form"},js={class:"field col-12 md:col-12"},Ms={class:"p-float-label"},Hs={class:"field col-12 md:col-6"},$s={class:"p-float-label"},qs=Fs((()=>(0,a._)("label",{for:"itemname"},"Наименование",-1))),Ls={class:"field col-12 md:col-6"},zs={class:"p-float-label"},Ks=Fs((()=>(0,a._)("label",{for:"printname"},"Наименование для печати",-1))),Gs={class:"field col-12 md:col-6"},Js={class:"p-inputgroup longinput"},Qs=Fs((()=>(0,a._)("span",{class:"p-inputgroup-addon"},".00",-1))),Ys={class:"field col-12 md:col-6"},Xs={class:"p-inputgroup longinput"},ea=Fs((()=>(0,a._)("span",{class:"p-inputgroup-addon"},".00",-1))),ta={class:"field col-12 md:col-6"},oa={id:"aaa",class:"p-inputgroup longinput"},la={class:"field col-12 md:col-6"},sa={class:"p-inputgroup longinput"},aa=Fs((()=>(0,a._)("br",null,null,-1))),ia={class:"col-12 md:col-6"},na={class:"checkBox"},da={class:"checkBoxLabel"},ca=Fs((()=>(0,a._)("label",{for:"garnish"},"Является гарнирниром ",-1))),ra={class:"checkBoxLabel"},ua=Fs((()=>(0,a._)("label",{for:"garnish"},"Включает гарнир ",-1))),ma={class:"checkBoxLabel"},pa=Fs((()=>(0,a._)("label",{for:"weight"},"Весовой ",-1))),ha={class:"checkBoxLabel"},ga=Fs((()=>(0,a._)("label",{for:"alcohol"},"Алкоголь ",-1))),_a={class:"col-12 md:col-6"},fa={class:"checkBox"},ya={class:"checkBoxLabel"},ba=Fs((()=>(0,a._)("label",{for:"garnish"},"Является соусом ",-1))),va={class:"checkBoxLabel"},Ca=Fs((()=>(0,a._)("label",{for:"includgarnish"},"Включает соус ",-1))),ka={class:"checkBoxLabel"},wa=Fs((()=>(0,a._)("label",{for:"employeeMenu"},"Не для сотрудников ",-1))),Da={class:"checkBoxLabel"},Sa=Fs((()=>(0,a._)("label",{for:"notInPriceList"},"Не отображать ",-1))),Ta={class:"field col-12 md:col-12"},Aa={class:"col-12 md:col-12"},Pa={class:"p-float-label"},Wa=Fs((()=>(0,a._)("label",{for:"comment"},"Комментарий",-1))),Ia={class:"col-12 md:col-12",style:{"text-align":"end"}};function Va(e,t,o,l,s,i){const n=(0,a.up)("Breadcrumb"),d=(0,a.up)("Button"),c=(0,a.up)("Calendar"),r=(0,a.up)("InputText"),u=(0,a.up)("Checkbox"),m=(0,a.up)("IngredientTable"),p=(0,a.up)("Textarea"),h=(0,a.up)("Column"),g=(0,a.up)("DataTable"),_=(0,a.up)("OverlayPanel"),f=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",Os,[(0,a.Wm)(n,{home:s.homeCrumb,model:i.crumbs},{item:(0,a.w5)((({item:e})=>[(0,a._)("span",{onClick:t=>i.onCrumbClick(e),class:"crumb"},(0,P.zw)(e.label),9,Bs)])),_:1},8,["home","model"]),(0,a._)("div",Ns,[(0,a.Wm)(d,{label:"Новая номенклатура",onClick:i.addNewItem,class:"p-button-rounded p-button-secondary p-button-sm"},null,8,["onClick"])]),(0,a._)("div",Zs,[(0,a._)("div",js,[(0,a._)("span",Ms,[(0,a.Wm)(c,{modelValue:s.formDate,"onUpdate:modelValue":t[0]||(t[0]=e=>s.formDate=e),onDateSelect:i.setDate,class:"longinput",showIcon:!0,showButtonBar:!0,dateFormat:"dd.mm.yy"},null,8,["modelValue","onDateSelect"])])]),(0,a._)("div",Hs,[(0,a._)("span",$s,[(0,a.Wm)(r,{id:"itemname",class:"longinput",onChange:i.setPrintName,type:"text",modelValue:i.item.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.item.name=e)},null,8,["onChange","modelValue"]),qs])]),(0,a._)("div",Ls,[(0,a._)("span",zs,[(0,a.Wm)(r,{id:"printname",class:"longinput",type:"text",modelValue:i.item.print_name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.item.print_name=e)},null,8,["modelValue"]),Ks])]),(0,a._)("div",Gs,[(0,a._)("div",Js,[(0,a.Wm)(r,{modelValue:s.retailPrice,"onUpdate:modelValue":t[3]||(t[3]=e=>s.retailPrice=e),placeholder:"Цена",onChange:t[4]||(t[4]=e=>i.setPrice(e,"RETAIL")),style:{"text-align":"end"}},null,8,["modelValue"]),Qs])]),(0,a._)("div",Ys,[(0,a._)("div",Xs,[(0,a._)("span",{class:"p-inputgroup-addon",onClick:t[5]||(t[5]=(...e)=>i.calculateDeliveryPrice&&i.calculateDeliveryPrice(...e))},"+"),(0,a.Wm)(r,{modelValue:s.deliveryPrice,"onUpdate:modelValue":t[6]||(t[6]=e=>s.deliveryPrice=e),placeholder:"Цена на доставку",onChange:t[7]||(t[7]=e=>i.setPrice(e,"DELIVERY")),style:{"text-align":"end"}},null,8,["modelValue"]),ea])]),(0,a._)("div",ta,[(0,a._)("div",oa,[(0,a.Wm)(r,{id:"unit",type:"text",placeholder:"Еденица",modelValue:s.selectedUnit.name,"onUpdate:modelValue":t[8]||(t[8]=e=>s.selectedUnit.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onUnitClick},null,8,["onClick"])])]),(0,a._)("div",la,[(0,a._)("div",sa,[(0,a.Wm)(r,{id:"workshop",type:"text",placeholder:"Цех",modelValue:s.selectedWorkshop.name,"onUpdate:modelValue":t[9]||(t[9]=e=>s.selectedWorkshop.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onWorkshopClick},null,8,["onClick"])])]),aa,(0,a._)("div",ia,[(0,a._)("div",na,[(0,a._)("span",da,[ca,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_garnish,"onUpdate:modelValue":t[10]||(t[10]=e=>i.item.is_garnish=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ra,[ua,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_include_garnish,"onUpdate:modelValue":t[11]||(t[11]=e=>i.item.is_include_garnish=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ma,[pa,(0,a.Wm)(u,{id:"weight",modelValue:i.item.is_weight,"onUpdate:modelValue":t[12]||(t[12]=e=>i.item.is_weight=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ha,[ga,(0,a.Wm)(u,{id:"alcohol",modelValue:i.item.is_alcohol,"onUpdate:modelValue":t[13]||(t[13]=e=>i.item.is_alcohol=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",_a,[(0,a._)("div",fa,[(0,a._)("span",ya,[ba,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_sauce,"onUpdate:modelValue":t[14]||(t[14]=e=>i.item.is_sauce=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",va,[Ca,(0,a.Wm)(u,{id:"includgarnish",modelValue:i.item.is_include_sauce,"onUpdate:modelValue":t[15]||(t[15]=e=>i.item.is_include_sauce=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ka,[wa,(0,a.Wm)(u,{id:"employeeMenu",modelValue:i.item.is_not_in_employee_menu,"onUpdate:modelValue":t[16]||(t[16]=e=>i.item.is_not_in_employee_menu=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",Da,[Sa,(0,a.Wm)(u,{id:"notInPriceList",modelValue:i.item.is_not_in_price_list,"onUpdate:modelValue":t[17]||(t[17]=e=>i.item.is_not_in_price_list=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",Ta,[(0,a.Wm)(m)]),(0,a._)("div",Aa,[(0,a._)("span",Pa,[(0,a.Wm)(p,{id:"comment",class:"textinput",modelValue:i.item.comment,"onUpdate:modelValue":t[18]||(t[18]=e=>i.item.comment=e),rows:"4",cols:"30"},null,8,["modelValue"]),Wa])]),(0,a._)("div",Ia,[(0,a.Wm)(d,{label:"Калькуляция",onClick:i.getCalculation,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"]),(0,a.Wm)(d,{label:"Сохранить",onClick:i.onSave,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"])])])])]),(0,a.Wm)(_,{ref:"opUnits"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.units,selection:s.selectedUnit,"onUpdate:selection":t[19]||(t[19]=e=>s.selectedUnit=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onUnitSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(_,{ref:"opWorkshops"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.workshops,selection:s.selectedWorkshop,"onUpdate:selection":t[20]||(t[20]=e=>s.selectedWorkshop=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onWorkshopsSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(f,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[21]||(t[21]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(d,{label:"Да",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h4",null,(0,P.zw)(s.confirmationMessage),1)])),_:1},8,["visible"])],64)}var Ra="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAOBJREFUOI3tzj1KQ2EQheH3zA2EVEF7F6BIuhQBQayCa/BnGSnjYBqt7AQ7RdyBgqWCGrBUzAas1aTKvYV3bGwTEvwKi5xyzvBwBLDnvh7BMaJFsIQoCN4VOr08PDhhjmT77o0InoFVoPZ7rwDLiHZjcyt/ub97nBXUjvutgvaUnzzgYVJp4iNK9SsWZ+fuuXbdhwT1WRdMyaAsqhuWCANYs2pxZIkwACS2k4IRrCQFARbgvwTFKKE3NIJ+QvDJorQOkP+ZEuOstI5d9bqvEk3EDeJrfodPwXX2bc2LXvftBxf8Q0mmDF6vAAAAAElFTkSuQmCC",Ua="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAArZJREFUOI2VlD9ME2EYxn/fXS/edSwGAf9F26iBQEgIFrpIo4O2op27MRA0EkOBQRNdjCYSwEpEjHEwMdGFRRMpjl1EiyH8CwOJOBiVFpFJuMNr+Ry0pZQ20We75837u++e+95XUETDPt9hRyYTllKeR4gjwF5gFfgEvFbS6RcdU1OfC/tE/sPTlhbd3Ni4I+AKQuwp9iIApNyUQjwwDONmWzxu7YI98Xr32fBKgLckpJAJCQ0uticSqRzsXnOzYWxtxYGT/wrK03vdMPxt8bilAOiZzO0sSNU0qkMhXG530U6X2011KISqaVmradM0bwGowz7fYWVr6xlCOABOtLZy6vp1jgUCJGdn+ZlM5kCV9fVcGBnhqN/Pz1SK1cXFbKkhUFX1THFkMuH8sFcWFrBNE80wCESjVNbX50CBaBTNMLBNk5WFhfwD60JVw2rwwIG7wKGsa66tsTw9jfv0aTSnE8+ZM/xaX8d/4waa00nasnjT20tqJwwBe8Qjr3cZqCjMpqKujuD9+2hOZ85LWxbjPT18nZoqFuc3BXAVqyTn5ng/PAxS5rwPjx+XAgHsVYAfxSoVdXU0dXaC2L7XjR0d7G9oKAX7rkhYKgbKfmLasng7OIi9sYFD1zk3OFgKuKQIGMt3yjwegkNDaE4ntmky1tXF/Ogose5ubNPEoeucHRigzOPZQZJCxBQlnX4B5OarvKYm9/tjkQjLMzMALM/MEItEctemvKYmn2VpUj4XACNeb7+AXvgzAceDQZLz86wt7UoAl9tNRW0ti2NjZGwbACFl36XJyWsC/m4L04z/z5Dn6Z3tcvmvjo9v7tgaaXgJNP0PCFUNXZ6YWAFQsm57IpHSDcMvoJ+8DEvIElL22S6XPwuCguWY1cPGxoNCVcNCyiDgZnvTfpRCxDQpn7cnEl8K+34Dd//+RzdHdrMAAAAASUVORK5CYII=";const xa=e=>((0,a.dD)("data-v-dff05596"),e=e(),(0,a.Cn)(),e),Ea={class:"ingrHeader"},Fa=xa((()=>(0,a._)("div",null,"Ингредиенты",-1))),Oa=["onClick"],Ba=["onClick"],Na=["onClick"],Za=xa((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),ja=xa((()=>(0,a._)("br",null,null,-1)));function Ma(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("Column"),c=(0,a.up)("InputText"),r=(0,a.up)("DataTable"),u=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",Ea,[Fa,(0,a._)("div",null,[(0,a.Wm)(n,{icon:"pi pi-plus",onClick:i.addNewIngredient,class:"p-button-text p-button-rounded"},null,8,["onClick"])])]),(0,a._)("div",null,[(0,a.Wm)(r,{value:this.ingredients,editMode:"cell",onCellEditComplete:i.onCellEditComplete,class:"p-datatable-sm editable-cells-table",responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{style:{width:"2.2rem"}},{body:(0,a.w5)((({data:e})=>[(0,a._)("img",{onClick:t=>i.onIngredientClick(e),src:Ra},null,8,Oa)])),_:1}),(0,a.Wm)(d,{field:"name",header:"Наименование"}),(0,a.Wm)(d,{field:"gross.quantity",header:"Брутто"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(c,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(d,{field:"netto.quantity",header:"Нетто"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(c,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(d,{style:{width:"3rem"}},{body:(0,a.w5)((({data:e})=>[1==e.enable.quantity?((0,a.wg)(),(0,a.iD)("img",{key:0,onClick:t=>i.toogleDeleted(e),src:ro},null,8,Ba)):((0,a.wg)(),(0,a.iD)("img",{key:1,onClick:t=>i.toogleDeleted(e),src:Ua},null,8,Na))])),_:1})])),_:1},8,["value","onCellEditComplete"])]),(0,a.Wm)(u,{header:"Подбор номенклатуры",visible:s.displayItems,"onUpdate:visible":t[3]||(t[3]=e=>s.displayItems=e),modal:!0,closable:!1,contentStyle:{height:"100%"},style:{width:"90%",height:"90%"}},{header:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(c,{class:"p-inputtext-sm mr-2",modelValue:s.filters["global"].value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.filters["global"].value=e),placeholder:"поиск",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(n,{icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-plain p-button-sm",onClick:i.clearFilter},null,8,["onClick"])])])),footer:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"закрыть",icon:"pi pi-times",onClick:i.closeDialog,class:"p-button-text p-button-sm"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(r,{value:i.items,class:"p-datatable-sm",selection:s.selectedItem,"onUpdate:selection":t[1]||(t[1]=e=>s.selectedItem=e),selectionMode:"single",filters:s.filters,"onUpdate:filters":t[2]||(t[2]=e=>s.filters=e),filterDisplay:"menu",globalFilterFields:["name"],onRowSelect:i.onItemSelect,responsiveLayout:"scroll",loading:s.loading},{loading:(0,a.w5)((()=>[Za])),default:(0,a.w5)((()=>[(0,a.Wm)(d,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","filters","onRowSelect","loading"]),ja])),_:1},8,["visible"])],64)}var Ha={name:"IngredientTable",components:{DataTable:G.Z,Column:J.Z,Button:D.Z,Dialog:Q.Z,InputText:k.Z},data(){return{filters:[],selectedItem:null,loading:!1,displayItems:!1}},created(){this.initFilters()},mounted(){this.$store.dispatch("getItems")},computed:{items(){return this.$store.state.cs.items},ingredients(){return this.$store.state.is.ingredients},itemDate(){return this.$store.state.is.itemDate},storages(){return this.$store.state.cs.storages}},watch:{items(){this.loading=!1}},methods:{initFilters(){this.filters={global:{value:null,matchMode:Xt.a6.CONTAINS},name:{operator:Xt.pg.AND,constraints:[{value:null,matchMode:Xt.a6.STARTS_WITH}]}}},clearFilter(){this.initFilters()},onIngredientClick(e){let t=this.$store.state.is.item,o={label:t.name,id:t.id};this.$store.dispatch("addCrumb",o),this.$store.dispatch("expandNodes",e.child_id),this.$store.dispatch("getItem",e.child_id)},toogleDeleted(e){e.enable.quantity=1==e.enable.quantity?0:1;let t=$a(this.itemDate).getTime();e.enable.date!=t&&(e.enable.id=0,e.enable.date=t)},addNewIngredient(){this.displayItems=!0},onItemSelect(e){this.displayItems=!1,this.addItem(e.data)},addItem(e){this.$store.dispatch("addIngredient",e)},onCellEditComplete(e){let{data:t,newValue:o,field:l}=e,s=l.split(".");t[s[0]].quantity=o;let a=$a(this.itemDate).getTime();t[s[0]].date!=a&&(t[s[0]].id=0,t[s[0]].date=a)},closeDialog(){this.displayItems=!1,this.clearFilter()}}};function $a(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}const qa=(0,c.Z)(Ha,[["render",Ma],["__scopeId","data-v-dff05596"]]);var La=qa,za=o(5876),Ka=o(1958),Ga=o(7998),Ja={name:"ItemForm",components:{IngredientTable:La,Calendar:zt.Z,InputText:k.Z,Checkbox:za.Z,Textarea:Ka.Z,Button:D.Z,Column:J.Z,OverlayPanel:Qt.Z,DataTable:G.Z,Dialog:Q.Z,Breadcrumb:Ga.Z},data(){return{displayConfirmation:!1,selectedUnit:{name:"---"},selectedWorkshop:{name:"---"},retailPrice:"",deliveryPrice:"",confirmationMessage:"",formDate:new Date,homeCrumb:{icon:"pi pi-inbox",to:"/items"}}},computed:{workshops(){return this.$store.state.cs.workshops},units(){return this.$store.state.cs.units},item(){return this.$store.state.is.item},parentNode(){return this.$store.state.is.parentNode},itemDate(){return this.$store.state.is.itemDate},crumbs(){return this.$store.state.is.crumbs}},methods:{getCalculation(){this.$store.dispatch("getCalculation",this.item.id)},setPrintName(){this.item.print_name=this.item.name},setDate(e){this.$store.dispatch("setDate",e)},addNewItem(){this.$store.dispatch("getItem",0)},calculateDeliveryPrice(){this.deliveryPrice=10*Math.ceil(1.2*this.retailPrice/10),this.setPrice(this.deliveryPrice,"DELIVERY")},onUnitClick(e){this.$refs.opUnits.toggle(e)},onWorkshopClick(e){this.$refs.opWorkshops.toggle(e)},onCrumbClick(e){this.$store.dispatch("delCrumb",e),this.$store.dispatch("expandNodes",e.id),this.$store.dispatch("getItem",e.id)},onUnitSelect(e){this.item.unit=this.selectedUnit,this.$refs.opUnits.toggle(e)},onWorkshopsSelect(e){this.item.workshop=this.selectedWorkshop,this.$refs.opWorkshops.toggle(e)},saveItem(){this.item.parent_id=this.parentNode.data,this.$store.dispatch("saveItem",[this.item,this.formDate])},closeConfirmation(){this.displayConfirmation=!1},positiveConfirmation(){this.saveItem(),this.displayConfirmation=!1},onSave(){this.confirmationMessage="Сохранить "+this.item.name+" в "+this.parentNode.label+"?",this.displayConfirmation=!0},setPrice(e,t){e.target&&(e=e.target._value);let o=!1;for(let l=0;l<this.item.prices.length;l++)this.item.prices[l].type===t&&(this.item.prices[l]=new Qa(this.formDate.getTime(),e,t),o=!0);o||this.item.prices.push(new Qa(this.formDate.getTime(),e,t))}},watch:{item(e){this.selectedUnit=e.unit,this.selectedWorkshop=e.workshop,this.retailPrice="",this.deliveryPrice="";for(let t of e.prices)"RETAIL"===t.type&&(this.retailPrice=t.value),"DELIVERY"===t.type&&(this.deliveryPrice=t.value)},itemDate(e){this.formDate=e}},mounted(){this.$store.dispatch("getItem",0)}};class Qa{constructor(e,t,o){(0,Lt.Z)(this,"value",0),(0,Lt.Z)(this,"type",""),(0,Lt.Z)(this,"date",""),this.date=e,this.value=t,this.type=o}}const Ya=(0,c.Z)(Ja,[["render",Va],["__scopeId","data-v-0ba9e1a0"]]);var Xa=Ya,ei={name:"ItemContent",components:{ItemTree:Es,ItemForm:Xa,MainMenu:ks},data(){return{}},computed:{},methods:{logout(){this.$store.dispatch("logout")}}};const ti=(0,c.Z)(ei,[["render",Ws],["__scopeId","data-v-6296caff"]]);var oi=ti;const li=e=>((0,a.dD)("data-v-7936bb54"),e=e(),(0,a.Cn)(),e),si={key:0,class:"formgrid grid"},ai={class:"col-12 md:col-4"},ii=li((()=>(0,a._)("label",{for:"project",class:"label"},"Проект",-1))),ni=li((()=>(0,a._)("br",null,null,-1))),di={class:"p-inputgroup"},ci={class:"col-12 md:col-4"},ri=li((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),ui=li((()=>(0,a._)("br",null,null,-1))),mi={class:"p-inputgroup"},pi={class:"col-12 md:col-4"},hi=li((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),gi=li((()=>(0,a._)("br",null,null,-1))),_i={class:"p-inputgroup"},fi={class:"formgrid grid leftAlignment"},yi={class:"col-12 md:col-6"},bi={class:"col-12 md:col-6"},vi=li((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),Ci=li((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При закрытии периода переносить остатки по средней цене")],-1))),ki={class:"col-12 md:col-6"},wi={class:"formgrid grid leftAlignment"},Di=li((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При проведении документов из 1С не добавлять недостающие позиции (списывать только из наличия) ")],-1))),Si={class:"col-12 md:col-6"},Ti=li((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),Ai=li((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При проведении документов списания и перемещения персчитывать стоимость позиций в соответствии со списываемыми партиями")],-1))),Pi={class:"col-12 md:col-6"},Wi=li((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),Ii={class:"col-12 md:col-6"},Vi={class:"col-12 md:col-6"};function Ri(e,t,o,l,s,i){const n=(0,a.up)("MainMenu"),d=(0,a.up)("InputText"),c=(0,a.up)("Button"),r=(0,a.up)("AccordionTab"),u=(0,a.up)("InputSwitch"),m=(0,a.up)("Accordion"),p=(0,a.up)("Column"),h=(0,a.up)("DataTable"),g=(0,a.up)("OverlayPanel");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(n),(0,a.Wm)(m,{activeIndex:s.activeIndex,"onUpdate:activeIndex":t[6]||(t[6]=e=>s.activeIndex=e),onTabOpen:i.setDefaultProperties},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{header:"Реквизиты документов по умолчанию"},{default:(0,a.w5)((()=>[s.defaultProject?((0,a.wg)(),(0,a.iD)("div",si,[(0,a._)("div",ai,[ii,ni,(0,a._)("div",di,[(0,a.Wm)(d,{id:"project",type:"text",class:"p-inputtext-sm",modelValue:s.defaultProject.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.defaultProject.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),(0,a._)("div",ci,[ri,ui,(0,a._)("div",mi,[(0,a.Wm)(d,{id:"storageFrom",type:"text",class:"p-inputtext-sm",modelValue:s.defaultStorageFrom.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.defaultStorageFrom.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageFromClick},null,8,["onClick"])])]),(0,a._)("div",pi,[hi,gi,(0,a._)("div",_i,[(0,a.Wm)(d,{id:"storageTo",type:"text",class:"p-inputtext-sm",modelValue:s.defaultStorageTo.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.defaultStorageTo.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageToClick},null,8,["onClick"])])])])):(0,a.kq)("",!0)])),_:1}),s.isAdmin?((0,a.wg)(),(0,a.j4)(r,{key:0,header:"Безвозвратное удаление документов"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"Удалить помеченные на удаление документы",onClick:i.deleteDocs,class:"p-button-sm p-button-text"},null,8,["onClick"])])),_:1})):(0,a.kq)("",!0),s.isAdmin?((0,a.wg)(),(0,a.j4)(r,{key:1,header:"Закрытие периода"},{default:(0,a.w5)((()=>[(0,a._)("div",fi,[(0,a._)("div",yi,[(0,a._)("span",null,(0,P.zw)(s.periodString),1)]),(0,a._)("div",bi,[(0,a.Wm)(c,{label:"Да",onClick:i.closePeriod,class:"p-button-secondary p-button-rounded p-button-sm"},null,8,["onClick"])]),vi,Ci,(0,a._)("div",ki,[(0,a.Wm)(u,{modelValue:s.averagePriceForPeriodClose,"onUpdate:modelValue":t[3]||(t[3]=e=>s.averagePriceForPeriodClose=e),onClick:i.setAveragePriceForPeriodClose},null,8,["modelValue","onClick"])])])])),_:1})):(0,a.kq)("",!0),s.isAdmin?((0,a.wg)(),(0,a.j4)(r,{key:2,header:"Настройки проведения документов"},{default:(0,a.w5)((()=>[(0,a._)("div",wi,[Di,(0,a._)("div",Si,[(0,a.Wm)(u,{modelValue:s.addShortageForHold,"onUpdate:modelValue":t[4]||(t[4]=e=>s.addShortageForHold=e),onClick:i.setAddShortageForHold},null,8,["modelValue","onClick"])]),Ti,Ai,(0,a._)("div",Pi,[(0,a.Wm)(u,{modelValue:s.averagePriceForDocs,"onUpdate:modelValue":t[5]||(t[5]=e=>s.averagePriceForDocs=e),onClick:i.setAveragePriceForDocs},null,8,["modelValue","onClick"])]),Wi,(0,a._)("div",Ii,[(0,a._)("span",null,"Ручное проведение документов из 1С. Есть не проведенные чеки от: "+(0,P.zw)(i.unholdenCheckDate),1)]),(0,a._)("div",Vi,[(0,a.Wm)(c,{label:"Провести документы",onClick:i.hold1CDocs,class:"p-button-secondary p-button-rounded p-button-sm",disabled:s.disabledHoldChecksButton},null,8,["onClick","disabled"])])])])),_:1})):(0,a.kq)("",!0)])),_:1},8,["activeIndex","onTabOpen"]),(0,a.Wm)(g,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[7]||(t[7]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{field:"name",header:"Name",sortable:"",style:{width:"60%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opStorage"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{value:i.storages,selection:s.selectedStorage,"onUpdate:selection":t[8]||(t[8]=e=>s.selectedStorage=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onStorageSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512)],64)}var Ui=o(7615),xi=o(5466),Ei={name:"Settings",components:{MainMenu:ks,Accordion:Ui.Z,AccordionTab:xi.Z,Button:D.Z,InputText:k.Z,DataTable:G.Z,Column:J.Z,OverlayPanel:Qt.Z,InputSwitch:Kt.Z},data(){return{user:null,defaultProject:{name:""},defaultStorageTo:{name:""},defaultStorageFrom:{name:""},selectedStorage:null,selectedProject:null,storageType:"",activeIndex:-1,isAdmin:!1,addShortageForHold:Boolean,averagePriceForPeriodClose:Boolean,averagePriceForDocs:Boolean,periodString:"",disabledHoldChecksButton:!0}},computed:{period(){return this.$store.state.ss.period},defaultProperties(){return this.$store.state.ss.defaultProperties},projects(){return this.$store.state.cs.projects},storages(){return this.$store.state.cs.storages},addShortageForHoldSetting(){return this.$store.state.ss.addShortageForHold},averagePriceForPeriodCloseSetting(){return this.$store.state.ss.аveragePriceForPeriodCloseProperty},averagePriceForDocsSetting(){return this.$store.state.ss.аveragePriceForDocsProperty},unholdenCheckDate(){return this.$store.state.ds.unholdenCheckDate}},watch:{user(e){"ADMIN"==e.role?this.isAdmin=!0:this.isAdmin=!1},period(e){this.periodString="Закрыть период? (текущий период: "+Fi(new Date(e.start_date))+" - "+Fi(new Date(e.end_date))+")"},unholdenCheckDate(e){this.disabledHoldChecksButton=""==e}},mounted(){this.$store.dispatch("getDefaultProperties"),this.$store.dispatch("getAddShortageForHold"),this.$store.dispatch("getAveragePriceForPeriodCloseProperty"),this.$store.dispatch("getAveragePriceForDocsProperty"),this.user=JSON.parse(localStorage.getItem("user")),this.$store.dispatch("getPeriod"),this.$store.dispatch("checkUnholden1CDocuments")},methods:{closePeriod(){this.$store.dispatch("closePeriod")},setDefaultProperties(){if(0==this.activeIndex){if(this.defaultProperties.length>0){let e=this.defaultProperties.filter((e=>e.type==to.PROJECT)).pop();e&&(this.defaultProject=this.getProjectById(e.property));let t=this.defaultProperties.filter((e=>e.type==to.STORAGE_TO)).pop();t&&(this.defaultStorageTo=this.getStorageById(t.property));let o=this.defaultProperties.filter((e=>e.type==to.STORAGE_FROM)).pop();o&&(this.defaultStorageFrom=this.getStorageById(o.property))}}else 2==this.activeIndex?this.averagePriceForPeriodClose=this.averagePriceForPeriodCloseSetting:3==this.activeIndex&&(this.addShortageForHold=this.addShortageForHoldSetting,this.averagePriceForDocs=this.averagePriceForDocsSetting)},logout(){this.$store.dispatch("logout")},getProjectById(e){return this.projects.filter((t=>t.id==e)).pop()},getStorageById(e){return this.storages.filter((t=>t.id==e)).pop()},onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.defaultProject=e.data,this.$refs.opProjects.hide(),this.setProperty(this.user,to.PROJECT,e.data.id)},onStorageFromClick(e){this.storageType="storageFrom",this.$refs.opStorage.toggle(e)},onStorageToClick(e){this.storageType="storageTo",this.$refs.opStorage.toggle(e)},onStorageSelect(e){"storageFrom"==this.storageType?(this.defaultStorageFrom=e.data,this.setProperty(this.user,to.STORAGE_FROM,e.data.id)):(this.defaultStorageTo=e.data,this.setProperty(this.user,to.STORAGE_TO,e.data.id)),this.$refs.opStorage.hide()},setAddShortageForHold(){this.$store.dispatch("setAddShortageForHoldProperty",this.addShortageForHold?0:1)},setProperty(e,t,o){this.$store.dispatch("setProperty",[e,t,o])},deleteDocs(){this.$store.dispatch("deleteDocs")},hold1CDocs(){this.$store.dispatch("hold1CDocuments")},setAveragePriceForPeriodClose(){this.$store.dispatch("setAveragePriceForPeriodCloseProperty",this.averagePriceForPeriodClose?0:1)},setAveragePriceForDocs(){this.$store.dispatch("setAveragePriceForDocsProperty",this.averagePriceForDocs?0:1)}}};function Fi(e,t){let o={day:"numeric",month:"numeric",year:"numeric"};return t&&(o.hour="numeric",o.minute="numeric",o.second="numeric"),e.toLocaleString("ru-Ru",o)}const Oi=(0,c.Z)(Ei,[["render",Ri],["__scopeId","data-v-7936bb54"]]);var Bi=Oi;const Ni={class:"conteiner"};function Zi(e,t,o,l,s,i){const n=(0,a.up)("MainMenu"),d=(0,a.up)("UserTree"),c=(0,a.up)("UserForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(n),(0,a._)("div",Ni,[(0,a.Wm)(d),(0,a.Wm)(c)])],64)}const ji={class:"tree"};function Mi(e,t,o,l,s,i){const n=(0,a.up)("Tree");return(0,a.wg)(),(0,a.iD)("div",ji,[(0,a.Wm)(n,{value:i.nodes,expandedKeys:i.expandedKeys,selectionMode:"single",selectionKeys:s.selectedKey,"onUpdate:selectionKeys":t[0]||(t[0]=e=>s.selectedKey=e),metaKeySelection:!1,onNodeCollapse:i.onNodeCollapse,onNodeExpand:i.onNodeExpand,onNodeSelect:i.onNodeSelect},null,8,["value","expandedKeys","selectionKeys","onNodeCollapse","onNodeExpand","onNodeSelect"])])}var Hi={name:"ItemTree",components:{Tree:Rs.Z},data(){return{selectedKey:null,parentNode:null}},computed:{nodes(){return this.$store.state.us.userTree},expandedKeys(){let e=this.$store.state.us.expandedKeys;return e}},mounted(){this.$store.dispatch("getUserTree")},methods:{onNodeSelect(e){e.is_node?this.$store.dispatch("setParentNode",e):this.$store.dispatch("getPerson",e.data)},onNodeExpand(e){e.is_node&&(e.icon="pi pi-fw pi-folder-open",this.$store.dispatch("setParentNode",e))},onNodeCollapse(e){e.is_node&&(e.icon="pi pi-fw pi-folder")}}};const $i=(0,c.Z)(Hi,[["render",Mi],["__scopeId","data-v-c8298c0a"]]);var qi=$i;const Li=e=>((0,a.dD)("data-v-4bfdcdba"),e=e(),(0,a.Cn)(),e),zi={class:"itemform"},Ki={class:"header"},Gi={class:"formgrid grid form"},Ji={class:"field col-12 md:col-6"},Qi={class:"p-float-label"},Yi=Li((()=>(0,a._)("label",{for:"itemname"},"Имя",-1))),Xi={class:"field col-12 md:col-6"},en={class:"p-float-label"},tn=Li((()=>(0,a._)("label",{for:"printname"},"Фамилия",-1))),on={class:"field col-12 md:col-6"},ln={class:"p-float-label"},sn=Li((()=>(0,a._)("label",{for:"password"},"Пароль",-1))),an={class:"field col-12 md:col-6"},nn={class:"p-float-label"},dn=Li((()=>(0,a._)("label",{for:"inn"},"ИНН",-1))),cn={class:"field col-12 md:col-6"},rn={class:"p-float-label"},un=Li((()=>(0,a._)("label",{for:"email"},"email",-1))),mn={class:"field col-12 md:col-6"},pn={class:"p-float-label"},hn=Li((()=>(0,a._)("label",{for:"phone"},"телефон",-1))),gn={class:"field col-12 md:col-6"},_n={class:"p-float-label"},fn=Li((()=>(0,a._)("label",{for:"birthdate"},"день рождения",-1))),yn={class:"field col-12 md:col-6"},bn={id:"aaa",class:"p-inputgroup longinput"},vn={class:"field col-12 md:col-12"},Cn={class:"p-float-label"},kn=Li((()=>(0,a._)("label",{for:"discount"},"Скидка",-1))),wn=Li((()=>(0,a._)("br",null,null,-1))),Dn={class:"col-12 md:col-6"},Sn={class:"checkBox"},Tn={class:"checkBoxLabel"},An=Li((()=>(0,a._)("label",{for:"garnish"},"показывать в списке расходов ",-1))),Pn={class:"checkBoxLabel"},Wn=Li((()=>(0,a._)("label",{for:"garnish"},"скидка на все ",-1))),In={class:"col-12 md:col-6"},Vn={class:"checkBox"},Rn={class:"checkBoxLabel"},Un=Li((()=>(0,a._)("label",{for:"garnish"},"показывать кнопку расходов ",-1))),xn={class:"checkBoxLabel"},En=Li((()=>(0,a._)("label",{for:"includgarnish"},"выплаты запрещены ",-1))),Fn={class:"col-12 md:col-12"},On={class:"p-float-label"},Bn=Li((()=>(0,a._)("label",{for:"comment"},"Комментарий",-1))),Nn={class:"col-12 md:col-12",style:{"text-align":"end"}};function Zn(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("InputText"),c=(0,a.up)("Calendar"),r=(0,a.up)("Checkbox"),u=(0,a.up)("Textarea"),m=(0,a.up)("Dialog"),p=(0,a.up)("Column"),h=(0,a.up)("DataTable"),g=(0,a.up)("OverlayPanel");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",zi,[(0,a._)("div",Ki,[(0,a.Wm)(n,{label:"Новый пользователь",onClick:i.addNewPerson,class:"p-button-rounded p-button-secondary p-button-sm"},null,8,["onClick"])]),(0,a._)("div",Gi,[(0,a._)("div",Ji,[(0,a._)("span",Qi,[(0,a.Wm)(d,{id:"itemname",class:"longinput",type:"text",modelValue:s.currentPerson.first_name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.currentPerson.first_name=e)},null,8,["modelValue"]),Yi])]),(0,a._)("div",Xi,[(0,a._)("span",en,[(0,a.Wm)(d,{id:"printname",class:"longinput",type:"text",modelValue:s.currentPerson.last_name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.currentPerson.last_name=e)},null,8,["modelValue"]),tn])]),(0,a._)("div",on,[(0,a._)("span",ln,[(0,a.Wm)(d,{id:"password",class:"longinput",type:"text",modelValue:s.currentPerson.password,"onUpdate:modelValue":t[2]||(t[2]=e=>s.currentPerson.password=e),disabled:""},null,8,["modelValue"]),sn])]),(0,a._)("div",an,[(0,a._)("span",nn,[(0,a.Wm)(d,{id:"inn",class:"longinput",type:"text",modelValue:s.currentPerson.inn,"onUpdate:modelValue":t[3]||(t[3]=e=>s.currentPerson.inn=e)},null,8,["modelValue"]),dn])]),(0,a._)("div",cn,[(0,a._)("span",rn,[(0,a.Wm)(d,{id:"email",class:"longinput",type:"text",modelValue:s.currentPerson.email,"onUpdate:modelValue":t[4]||(t[4]=e=>s.currentPerson.email=e)},null,8,["modelValue"]),un])]),(0,a._)("div",mn,[(0,a._)("span",pn,[(0,a.Wm)(d,{id:"phone",class:"longinput",type:"text",modelValue:s.currentPerson.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>s.currentPerson.phone=e)},null,8,["modelValue"]),hn])]),(0,a._)("div",gn,[(0,a._)("span",_n,[(0,a.Wm)(c,{id:"birthdate",modelValue:s.currentPerson.birth_date,"onUpdate:modelValue":t[6]||(t[6]=e=>s.currentPerson.birth_date=e),onDateSelect:i.setDate,class:"longinput",showIcon:!0,showButtonBar:!0,dateFormat:"dd.mm.yy"},null,8,["modelValue","onDateSelect"]),fn])]),(0,a._)("div",yn,[(0,a._)("div",bn,[(0,a.Wm)(d,{id:"unit",type:"text",placeholder:"Проект",modelValue:s.selectedProject.name,"onUpdate:modelValue":t[7]||(t[7]=e=>s.selectedProject.name=e)},null,8,["modelValue"]),(0,a.Wm)(n,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),(0,a._)("div",vn,[(0,a._)("span",Cn,[(0,a.Wm)(d,{id:"discount",class:"longinput",type:"text",modelValue:s.currentPerson.discount,"onUpdate:modelValue":t[8]||(t[8]=e=>s.currentPerson.discount=e)},null,8,["modelValue"]),kn])]),wn,(0,a._)("div",Dn,[(0,a._)("div",Sn,[(0,a._)("span",Tn,[An,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.in_expence_list,"onUpdate:modelValue":t[9]||(t[9]=e=>s.currentPerson.in_expence_list=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",Pn,[Wn,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.discount_for_all,"onUpdate:modelValue":t[10]||(t[10]=e=>s.currentPerson.discount_for_all=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",In,[(0,a._)("div",Vn,[(0,a._)("span",Rn,[Un,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.show_expence_button,"onUpdate:modelValue":t[11]||(t[11]=e=>s.currentPerson.show_expence_button=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",xn,[En,(0,a.Wm)(r,{id:"includgarnish",modelValue:s.currentPerson.expenses_disable,"onUpdate:modelValue":t[12]||(t[12]=e=>s.currentPerson.expenses_disable=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",Fn,[(0,a._)("span",On,[(0,a.Wm)(u,{id:"comment",class:"textinput",modelValue:s.currentPerson.comment,"onUpdate:modelValue":t[13]||(t[13]=e=>s.currentPerson.comment=e),rows:"4",cols:"65"},null,8,["modelValue"]),Bn])]),(0,a._)("div",Nn,[(0,a.Wm)(n,{label:"Сохранить",onClick:i.onSave,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"])])])])]),(0,a.Wm)(m,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[14]||(t[14]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(n,{label:"Да",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h4",null,(0,P.zw)(s.confirmationMessage),1)])),_:1},8,["visible"]),(0,a.Wm)(g,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[15]||(t[15]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{field:"name",header:"Name",sortable:"",style:{width:"60%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512)],64)}class jn{constructor(e){(0,Lt.Z)(this,"id",0),(0,Lt.Z)(this,"first_name",""),(0,Lt.Z)(this,"last_name",""),(0,Lt.Z)(this,"email",""),(0,Lt.Z)(this,"phone",""),(0,Lt.Z)(this,"reg_date",""),(0,Lt.Z)(this,"birth_date",""),(0,Lt.Z)(this,"role",""),this.reg_date=e,this.birth_date=e}}var Mn={name:"UserForm",components:{Calendar:zt.Z,InputText:k.Z,Button:D.Z,Dialog:Q.Z,Checkbox:za.Z,OverlayPanel:Qt.Z,Textarea:Ka.Z,Column:J.Z,DataTable:G.Z},data(){return{displayConfirmation:!1,confirmationMessage:"",currentPerson:new jn(new Date),selectedProject:{name:""}}},computed:{person(){return this.$store.state.us.person},projects(){return this.$store.state.cs.projects}},watch:{person(e){this.currentPerson=e}},methods:{onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.selectedProject=e.data,this.currentPerson.project=e.data,this.$refs.opProjects.hide()},setDate(e){this.$store.dispatch("setDate",e)},addNewPerson(){this.$store.dispatch("send"),this.$store.dispatch("getPerson",0)},savePerson(){this.item.parent_id=this.parentNode.data,this.$store.dispatch("savePerson",this.person)},closeConfirmation(){this.displayConfirmation=!1},positiveConfirmation(){this.saveItem(),this.displayConfirmation=!1},onSave(){this.confirmationMessage="Сохранить "+this.item.name+" в "+this.parentNode.label+"?",this.displayConfirmation=!0}},mounted(){this.$store.dispatch("getPerson",0)}};const Hn=(0,c.Z)(Mn,[["render",Zn],["__scopeId","data-v-4bfdcdba"]]);var $n=Hn,qn={name:"UserContent",components:{UserTree:qi,UserForm:$n,MainMenu:ks},data(){return{}},computed:{},methods:{logout(){this.$store.dispatch("logout")}}};const Ln=(0,c.Z)(qn,[["render",Zi],["__scopeId","data-v-fb6a96a2"]]);var zn=Ln;const Kn=[{path:"/",redirect:"/documents/posting"},{path:"/login",component:A},{path:"/documents/:filter?",component:As,props:!0},{path:"/items",component:oi},{path:"/users",component:zn},{path:"/settings",component:Bi}],Gn=(0,p.p7)({history:(0,p.r5)(),routes:Kn});async function Jn(e,t){return fetch(eo+e,{method:"GET",headers:{Authorization:t.token}}).then((e=>e.json())).then((e=>ed(e,t))).then((e=>e.data))}async function Qn(e,t,o,l){return console.log(eo,e),fetch(eo+e,{method:"POST",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>ed(e,l))).then((e=>e))}async function Yn(e,t,o,l){return fetch(eo+e,{method:"PUT",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>ed(e,l))).then((e=>e.data))}async function Xn(e,t,o,l){return fetch(eo+e,{method:"DELETE",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>ed(e,l))).then((e=>e.data))}function ed(e,t){return e.error?t.toast?.add({severity:"error",summary:"error",detail:e.error,life:3e3}):t.toast?.add({severity:"info",summary:"Info Message",detail:e.message,life:1e3}),e}Gn.beforeEach(((e,t,o)=>{const l=["/login"],s=!l.includes(e.path);let a=JSON.parse(localStorage.getItem("user"));if(s&&!a)return o("/login");o()}));class td{constructor(e,t,o){(0,Lt.Z)(this,"id",0),(0,Lt.Z)(this,"number",0),(0,Lt.Z)(this,"date_time",""),(0,Lt.Z)(this,"amount",0),(0,Lt.Z)(this,"tax",0),(0,Lt.Z)(this,"doc_type",""),(0,Lt.Z)(this,"is_payed",!1),(0,Lt.Z)(this,"is_hold",!1),(0,Lt.Z)(this,"is_delivery",!1),(0,Lt.Z)(this,"project",this.getDefaultProject()),(0,Lt.Z)(this,"author",{id:0,email:"",name:""}),(0,Lt.Z)(this,"individual",{id:0,email:"",name:""}),(0,Lt.Z)(this,"supplier",{id:0,name:"",inn:0,kpp:0,accounts:[],is_mine:!1}),(0,Lt.Z)(this,"recipient",{id:0,inn:0,kpp:0,is_mine:!1}),(0,Lt.Z)(this,"storage_from",{id:0,name:"",type:""}),(0,Lt.Z)(this,"storage_to",{id:0}),(0,Lt.Z)(this,"base_document_id",0),this.number=o,this.doc_type=e,this.date_time=t,"Чек ККМ"===e&&(this.check_info={waiter:"",check_number:0,cash_register_number:0,amount_received:0,guest_number:0,table_number:0,date_time:t,is_return:!1,is_KKM_checked:!1,is_payed:!1,is_payed_by_card:!1,is_delivery:!1}),e!=oo.CREDIT_ORDER_DOC&&e!=oo.WITHDRAW_ORDER_DOC&&(this.doc_items=[])}getDefaultProject(){return{id:0,name:""}}}class od{constructor(e,t,o,l){(0,Lt.Z)(this,"document_id",0),(0,Lt.Z)(this,"item_id",0),(0,Lt.Z)(this,"item_name",""),(0,Lt.Z)(this,"quantity",0),(0,Lt.Z)(this,"quantity_fact",0),(0,Lt.Z)(this,"price",0),(0,Lt.Z)(this,"amount",0),(0,Lt.Z)(this,"discount",0),this.item_id=e,this.item_name=t,this.quantity=o,this.price=l}}function ld(e,t){e.author=t.author,e.project=t.project,e.doc_type==oo.WRITE_OFF_DOC?e.storage_from=t.storage_from:e.storage_to=t.storage_from,e.base_document_id=t.id;let o=e.doc_type==oo.WRITE_OFF_DOC?-1:1;for(let l of t.doc_items){let t=(l.quantity_fact-l.quantity)*o;if(t>0){let o=new od(l.item_id,l.item_name,t,l.price);e.doc_items.push(o)}}}const sd={state:()=>({document:document,documents:null,itemRest:0,startDate:0,endDate:0,exsistNotHoldenDocs:0,unholdenCheckDate:""}),mutations:{setDocuments(e,t){e.documents=t},setDocument(e,t){e.document=t},setItemRest(e,t){e.itemRest=t},setDates(e,[t,o]){e.startDate=t,e.endDate=o},setStartDate(e,t){e.startDate=t},setEndDate(e,t){e.endDate=t},setRootSuccess(e){e.success++},setExsistNotHoldenDocs(e){e.exsistNotHoldenDocs++},setUnholdenCheckDate(e,t){e.unholdenCheckDate=t}},actions:{setDates({commit:e}){let t=new Date,o=t.getFullYear(),l=t.getMonth(),s=t.getDate();e("setDates",[new Date(o,l,1),new Date(o,l,s+1)])},setStartDate({commit:e},t){e("setStartDate",t)},setEndDate({commit:e},t){e("setEndDate",t)},async getDocuments({commit:e,rootState:t,state:o},l){l=""!==l?"?filter="+l:"";let s=(""==l?"?":"&")+"start="+o.startDate.getTime()+"&end="+o.endDate.getTime();const a=await Jn("/api/v1/docs/list"+l+s,t);for(let i=0;i<a.length;i++)a[i].date_time=new Date(a[i].date_time);e("setDocuments",a)},async getDocument({commit:e,rootState:t},[o,l]){let s=null;if(0==o){let e=await Jn("/api/v1/docs/new/number?type="+l,t);s=new td(l,new Date,e)}else s=await Jn("/api/v1/docs?id="+o,t),s.date_time=new Date(s.date_time);s.check_info&&(s.check_info.date_time=new Date(s.check_info.date_time)),e("setDocument",s)},async updateDocument({commit:e,rootState:t},[o,l]){o.date_time=o.date_time.getTime(),o.check_info&&(o.check_info.date_time=o.check_info.date_time.getTime());let s={item_doc_dto:o},a={"Content-Type":"application/json",Authorization:t.token};const i=await Yn("/api/v1/docs/"+l,a,s,t);"ok"==i&&e("setSuccess")},async addDocument({commit:e,rootState:t},[o,l]){o.date_time=o.date_time.getTime(),o.check_info&&(o.check_info.date_time=o.check_info.date_time.getTime());let s={item_doc_dto:o},a={"Content-Type":"application/json",Authorization:t.token};const i=await Qn("/api/v1/docs/"+l,a,s,t);"ok"==i.data&&e("setSuccess")},createRelativeDocks({commit:e},t){let o=new td("Списание",t.date_time,"");ld(o,t),o.doc_items.length>0&&this.dispatch("addDocument",[o,!0]);let l=new td("Оприходование",t.date_time,"");ld(l,t),l.doc_items.length>0&&this.dispatch("addDocument",[l,!0]),e("setSuccess")},async deleteDocument({commit:e,rootState:t},o){o.date_time=o.date_time.getTime();let l={item_doc_dto:o},s={"Content-Type":"application/json",Authorization:t.token};const a=await Xn("/api/v1/docs",s,l,t);"ok"==a&&e("setSuccess")},async holdDocument({commit:e,rootState:t},o){let l={Authorization:t.token};const s=await Qn("/api/v1/docs/hold/"+o,l,null,t);1==s.type&&e("setExsistNotHoldenDocs"),"ok"==s.data&&e("setSuccess")},async serialHoldDocument({commit:e,rootState:t},o){let l={Authorization:t.token};const s=await Qn("/api/v1/docs/hold/serial/"+o,l,null,t);"ok"==s.data&&e("setSuccess")},async getRestOnDateAndStorage({commit:e,rootState:t},[o,l,s]){let a="/api/v1/rest/inventory?docId="+o+"&time="+l.getTime()+"&storageId="+s;const i=await Jn(a,t);e("setItemRest",i)},async deleteDocs({commit:e,rootState:t}){let o={"Content-Type":"application/json",Authorization:t.token};const l=await Xn("/api/v1/docs/hard/delete",o,null,t);"ok"==l.data&&e("setSuccess")},async hold1CDocuments({commit:e,rootState:t}){let o={Authorization:t.token};const l=await Qn("/api/v1/1c/hold",o,null,t);"ok"==l.data&&e("setSuccess")},async checkUnholden1CDocuments({commit:e,rootState:t}){const o=await Jn("/api/v1/1c/check",t);e("setUnholdenCheckDate",o)},async getAAA({commit:e,rootState:t}){let o={Authorization:t.token};const l=await Qn("/api/v1/1c/number/3",o,null,t);"ok"==l.data&&e("setSuccess")}}};class ad{constructor(e){(0,Lt.Z)(this,"id",0),(0,Lt.Z)(this,"name",""),(0,Lt.Z)(this,"workshop",{name:"---",code:"NONE"}),(0,Lt.Z)(this,"unit",{name:"---",code:"NONE"}),(0,Lt.Z)(this,"number",0),(0,Lt.Z)(this,"prices",[]),(0,Lt.Z)(this,"sets",[]),(0,Lt.Z)(this,"ingredients",[]),(0,Lt.Z)(this,"print_name",""),(0,Lt.Z)(this,"reg_time",""),(0,Lt.Z)(this,"is_weight",!1),(0,Lt.Z)(this,"is_not_in_employee_menu",!1),(0,Lt.Z)(this,"is_alcohol",!1),(0,Lt.Z)(this,"is_not_in_price_list",!1),(0,Lt.Z)(this,"is_garnish",!1),(0,Lt.Z)(this,"is_include_garnish",!1),(0,Lt.Z)(this,"is_sauce",!1),(0,Lt.Z)(this,"is_include_sauce",!1),(0,Lt.Z)(this,"parent_id",0),this.reg_time=e}}class id{constructor(e,t,o,l,s,a,i){(0,Lt.Z)(this,"id",0),(0,Lt.Z)(this,"name",""),(0,Lt.Z)(this,"child_id",0),(0,Lt.Z)(this,"parent_id",0),(0,Lt.Z)(this,"netto",0),(0,Lt.Z)(this,"gross",0),(0,Lt.Z)(this,"enable",0),this.id=e,this.name=t,this.child_id=o,this.parent_id=l,this.netto=s,this.gross=a,this.enable=i}}class nd{constructor(e,t,o,l){(0,Lt.Z)(this,"id",0),(0,Lt.Z)(this,"date",0),(0,Lt.Z)(this,"quantity",0),(0,Lt.Z)(this,"type",""),this.id=e,this.date=t,this.quantity=o,this.type=l}}const dd={state:()=>({itemTree:null,item:"",parentNode:null,itemDate:new Date,ingredients:[],crumbs:[],expandedKeys:{},calculation:null,timeOfRest:null,items:[]}),mutations:{setItemTree(e,t){e.itemTree=t},setItem(e,t){e.item=t},setIngredients(e,t){e.ingredients=t},addIngredient(e,t){e.ingredients.push(t)},saveParentNode(e,t){e.parentNode=t},setDate(e,t){e.itemDate=t},addCrumb(e,t){e.crumbs.push(t)},delCrumb(e,t){for(var o=e.crumbs.length-1;o>=0;o--){if(e.crumbs[o]==t){e.crumbs.pop();break}e.crumbs.pop()}},delCrumbs(e){e.crumbs=[]},expandKey(e,t){e.expandedKeys[t]=!0},setCalculation(e,t){e.calculation=t},setItemsWithRest(e,t){e.items=t}},actions:{async getItemTree({rootState:e,commit:t}){const o=await Jn("/api/v1/items/tree",e);t("setItemTree",o)},async getItem({state:e,rootState:t,commit:o},l){let s;s=0!=l?await Jn("/api/v1/items?date="+e.itemDate.getTime()+"&id="+l,t):new ad(new Date),o("setIngredients",s.ingredients),o("setItem",s)},addIngredient({state:e,commit:t},o){let l=e.itemDate.getTime(),s=new nd(0,l,0,"NET"),a=new nd(0,l,0,"GROSS"),i=new nd(0,l,1,"ENABLE"),n=new id(0,o.name,o.id,e.item.id,s,a,i);t("addIngredient",n)},async saveItem({rootState:e,commit:t},[o,l]){let s,a={"Content-Type":"application/json",Authorization:e.token};0==o.id?(o.reg_time=l.getTime(),s=await Qn("/api/v1/items",a,o,e)):s=await Yn("/api/v1/items/"+l.getTime(),a,o,e),"ok"==s&&t("setSuccess"),t("setItem",new ad),t("setIngredients",[])},setParentNode({commit:e},t){e("saveParentNode",t)},expandNodes({state:e},t){console.log(t);let o=e.itemTree[0];this.dispatch("expandNode",o)},expandNode({commit:e},t){if(t.children&&t.children.length){e("expandKey",t.key);for(let e of t.children)this.dispatch("expandNode",e)}},addCrumb({commit:e},t){e("addCrumb",t)},delCrumb({commit:e},t){e("delCrumb",t)},delCrumbs({commit:e}){e("delCrumbs")},setDate({commit:e},t){e("setDate",t)},async getCalculation({state:e,rootState:t,commit:o},l){let s=await Jn("/api/v1/items/calculation?date="+e.itemDate.getTime()+"&id="+l,t);o("setCalculation",s)},async getItemsWithRest({rootState:e,commit:t},o){if(o.getTime()!=this.timeOfRest){this.timeOfRest=o.getTime();const l=await Jn("/api/v1/items/list?time="+this.timeOfRest,e);t("setItemsWithRest",l)}}}},cd={state:()=>({companies:[],docTypes:[],workshops:[],units:[],projects:[],storages:[],users:[],items:[]}),mutations:{setDocTypes(e,t){e.docTypes=t},setWorkShops(e,t){e.workshops=t},setUnits(e,t){e.units=t},setStorages(e,t){e.storages=t},setUsers(e,t){e.users=t},setCompanies(e,t){e.companies=t},setProject(e,t){e.projects=t},setItems(e,t){e.items=t}},actions:{async getDocTypes({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/document/types",e);t("setDocTypes",o)},async getProjects({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/projects",e);t("setProject",o)},async getWorkShops({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/workshops",e);t("setWorkShops",o)},async getUnits({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/units",e);t("setUnits",o)},async getStorages({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/storages",e);t("setStorages",o)},async getUsers({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/users",e);t("setUsers",o)},async getCompanies({rootState:e,commit:t}){const o=await Jn("/api/v1/catalogs/companies",e);t("setCompanies",o)},async getItems({rootState:e,commit:t}){const o=await Jn("/api/v1/items/list",e);t("setItems",o)}}};var rd=o(8e3),ud=o.n(rd),md=o(5016),pd=o.n(md);const hd={state:()=>({received_messages:[],send_message:null,connected:!1,socket:null,stompClient:null}),mutations:{},actions:{send(){if(console.log("Send message:"+this.send_message),this.stompClient&&this.stompClient.connected){const e={text:"message"};console.log(JSON.stringify(e)),this.stompClient.send("ws/app/hello",JSON.stringify(e),{})}},getSocketConnection(){let e=new(ud())("http://localhost:8081/ws");this.stompClient=pd().over(e),this.stompClient.connect({},(e=>{this.connected=!0,console.log(e),this.stompClient.subscribe("/ws/subscribe",(e=>{console.log(e),this.received_messages.push(JSON.parse(e.body).content)}))}),(e=>{console.log("error",e),this.connected=!1}))},disconnect(){this.stompClient&&this.stompClient.disconnect(),this.connected=!1},tickleConnection(){this.connected?this.disconnect():this.connect()}}},gd={state:()=>({defaultProperties:[],addShortageForHold:!0,averagePriceForPeriodCloseProperty:Boolean,"аveragePriceForDocsProperty":Boolean,period:null}),mutations:{setDefaultProperties(e,t){e.defaultProperties=t},setAddShortageForHold(e,t){e.addShortageForHold=1==t.property},setAveragePriceForPeriodCloseProperty(e,t){e.аveragePriceForPeriodCloseProperty=1==t.property},getAveragePriceForDocsProperty(e,t){e.аveragePriceForDocsProperty=1==t.property},setPeriod(e,t){e.period=t}},actions:{async getDefaultProperties({commit:e,rootState:t}){let o=JSON.parse(localStorage.getItem("user"));const l=await Jn("/api/v1/setting?userId="+o.id,t);e("setDefaultProperties",l)},async getAddShortageForHold({commit:e,rootState:t}){const o=await Jn("/api/v1/setting/add/shortage",t);e("setAddShortageForHold",o)},async getAveragePriceForPeriodCloseProperty({commit:e,rootState:t}){const o=await Jn("/api/v1/setting/average/price/period",t);e("setAveragePriceForPeriodCloseProperty",o)},async getAveragePriceForDocsProperty({commit:e,rootState:t}){const o=await Jn("/api/v1/setting/average/price/docs",t);e("setAveragePriceForDocsProperty",o)},async setProperty({rootState:e},[t,o,l]){let s={user:t,type:o,property:l},a={"Content-Type":"application/json",Authorization:e.token};const i=await Qn("/api/v1/setting/property",a,s,e);"ok"==i.data&&this.dispatch("getDefaultProperties")},async setAddShortageForHoldProperty({rootState:e},t){let o={type:to.ADD_REST_FOR_HOLD,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/add/shortage",l,o,e);"ok"==s.data&&this.dispatch("getDefaultProperties")},async setAveragePriceForPeriodCloseProperty({rootState:e},t){let o={type:to.AVERAGE_COST,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/average/price/period",l,o,e);"ok"==s.data&&this.dispatch("getAveragePriceForPeriodCloseProperty")},async setAveragePriceForDocsProperty({rootState:e},t){let o={type:to.AVERAGE_COST,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/average/price/docs",l,o,e);"ok"==s.data&&this.dispatch("getAveragePriceForDocsProperty")},async getPeriod({commit:e,rootState:t}){const o=await Jn("/api/v1/setting/period",t);e("setPeriod",o)},async closePeriod({commit:e,rootState:t}){let o={"Content-Type":"application/json",Authorization:t.token};const l=await Qn("/api/v1/setting/period",o,null,t);e("setPeriod",l.data)}}},_d={state:()=>({userTree:null,expandedKeys:{},person:null}),mutations:{setUserTree(e,t){e.userTree=t},setPerson(e,t){e.person=t}},actions:{async getUserTree({rootState:e,commit:t}){const o=await Jn("/api/v1/users/tree",e);t("setUserTree",o)},async getPerson({rootState:e,commit:t},o){let l;0!=o?(l=await Jn("/api/v1/users?id="+o,e),l.birth_date=new Date(l.birth_date)):l=new jn(new Date),t("setPerson",l)},async savePerson({rootState:e,commit:t},o){let l,s={"Content-Type":"application/json",Authorization:e.token};l=0==o.id?await Qn("/api/v1/users",s,o,e):await Yn("/api/v1/users/",s,o,e),"ok"==l.data&&t("setSuccess"),t("setPerson",new jn(new Date))}}},fd=(0,m.MT)({modules:{ds:sd,is:dd,cs:cd,ws:hd,ss:gd,us:_d},state(){return{user:null,success:0,message:String,toast:null,token:String}},mutations:{setUser(e,t){t?(localStorage.setItem("user",JSON.stringify(t)),e.token=t.token,Gn.push("/")):(localStorage.removeItem("user"),Gn.push("/login"))},getToken(e){let t=JSON.parse(localStorage.getItem("user"));e.token=t.token},installToast(e,t){e.toast=t},setSuccess(e){e.success++}},actions:{async login(e,t){let o={"Content-Type":"application/json"};const l=await Qn("/api/v1/auth/login",o,t,e.state);e.commit("setUser",l.data)},async logout(e){e.commit("setUser",null)},async getToken(e){e.commit("getToken")},getMessage(e,t){e.state.toast?.add({severity:"error",summary:"Info Message",detail:t,life:3e3})},installToast(e,t){e.commit("installToast",t)}}});var yd=o(7915),bd=o(2394);const vd=(0,l.ri)(u);vd.use(s.Z),vd.use(fd),vd.use(Gn),vd.use(bd.Z),vd.directive("tooltip",yd.Z),vd.mount("#app")}},t={};function o(l){var s=t[l];if(void 0!==s)return s.exports;var a=t[l]={exports:{}};return e[l].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,l,s,a){if(!l){var i=1/0;for(r=0;r<e.length;r++){l=e[r][0],s=e[r][1],a=e[r][2];for(var n=!0,d=0;d<l.length;d++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](l[d])}))?l.splice(d--,1):(n=!1,a<i&&(i=a));if(n){e.splice(r--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var r=e.length;r>0&&e[r-1][2]>a;r--)e[r]=e[r-1];e[r]=[l,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,a,i=l[0],n=l[1],d=l[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(d)var r=d(o)}for(t&&t(l);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(r)},l=self["webpackChunkstore"]=self["webpackChunkstore"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[998],(function(){return o(3782)}));l=o.O(l)})();
//# sourceMappingURL=app.702d4cf3.js.map