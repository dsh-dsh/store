(function(){"use strict";var e={1147:function(e,t,o){var l=o(9963),s=o(5475),a=o(6252);function i(e,t,o,l,s,i){const n=(0,a.up)("router-view"),d=(0,a.up)("Toast");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(n),(0,a.Wm)(d,{position:"bottom-right"})])}var n=o(3915),d={name:"App",components:{Toast:n.Z},data(){return{}},mounted(){this.$store.dispatch("installToast",this.$toast),this.$store.dispatch("getToken"),this.$store.dispatch("getWorkShops"),this.$store.dispatch("getUnits"),this.$store.dispatch("getProjects"),this.$store.dispatch("getStorages"),this.$store.dispatch("getUsers"),this.$store.dispatch("getCompanies"),this.$store.dispatch("getDocTypes"),this.$store.dispatch("getDefaultProperties"),this.$store.dispatch("getPeriod"),this.$store.dispatch("setDates")}},c=o(3744);const r=(0,c.Z)(d,[["render",i]]);var u=r,m=o(3907),p=(o(6699),o(2119));const h=e=>((0,a.dD)("data-v-694cb6db"),e=e(),(0,a.Cn)(),e),_={class:"loginform block"},g=h((()=>(0,a._)("div",{class:"left"},null,-1))),f={class:"column right"},y=h((()=>(0,a._)("h5",null,"логин",-1))),b=h((()=>(0,a._)("h5",null,"пароль",-1))),v=h((()=>(0,a._)("br",null,null,-1)));function C(e,t,o,s,i,n){const d=(0,a.up)("InputText"),c=(0,a.up)("Password"),r=(0,a.up)("Button");return(0,a.wg)(),(0,a.iD)("div",_,[g,(0,a._)("div",f,[y,(0,a.Wm)(d,{id:"login",type:"text",modelValue:i.login,"onUpdate:modelValue":t[0]||(t[0]=e=>i.login=e)},null,8,["modelValue"]),b,(0,a.Wm)(c,{modelValue:i.password,"onUpdate:modelValue":t[1]||(t[1]=e=>i.password=e),toggleMask:""},null,8,["modelValue"]),v,(0,a.Wm)(r,{label:"OK",class:"p-button-sm",onClick:(0,l.iM)(n.onSubmit,["prevent"])},null,8,["onClick"])])])}var k=o(6076),D=o(4902),w=o(4325),S={name:"LoginForm",components:{InputText:k.Z,Password:D.Z,Button:w.Z},data(){return{login:null,password:null}},computed:{},methods:{onSubmit(){this.$store.dispatch("login",{login:this.login,password:this.password})}}};const T=(0,c.Z)(S,[["render",C],["__scopeId","data-v-694cb6db"]]);var P=T,A=o(3577);const W=e=>((0,a.dD)("data-v-70e92e46"),e=e(),(0,a.Cn)(),e),V={class:"conteiner"},I={class:"content"},R={class:"flex justify-content-between mb-2"},x={class:"border"},U={class:"flex justify-content-end"},O={class:"horizontal"},F=W((()=>(0,a._)("span",{class:"mlr-1"},"с",-1))),E=W((()=>(0,a._)("span",{class:"mlr-1"},"до",-1))),B=W((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("p",null,"Журнал пуст")],-1))),N=W((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),Z={key:0},j={key:1},M=W((()=>(0,a._)("h3",null,"Выберете время сохранения документа",-1))),$={class:"field-radiobutton"},H=W((()=>(0,a._)("label",{for:"time1"},"сохранить в начало дня",-1))),q={key:0,class:"field-radiobutton"},K=W((()=>(0,a._)("label",{for:"time2"},"сохранить текущее время докумнта",-1))),z={class:"field-radiobutton"},L=W((()=>(0,a._)("label",{for:"time3"},"сохранить в конец дня",-1)));function G(e,t,o,l,s,i){const n=(0,a.up)("UserAvatar"),d=(0,a.up)("Button"),c=(0,a.up)("Toolbar"),r=(0,a.up)("MainMenu"),u=(0,a.up)("DocTabs"),m=(0,a.up)("Calendar"),p=(0,a.up)("Column"),h=(0,a.up)("DataTable"),_=(0,a.up)("DocRedactor"),g=(0,a.up)("Document"),f=(0,a.up)("Dialog"),y=(0,a.up)("OverlayPanel"),b=(0,a.up)("Menu"),v=(0,a.up)("RadioButton"),C=(0,a.Q2)("tooltip");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"top-menu"},{end:(0,a.w5)((()=>[(0,a.Wm)(n),(0,a.Wm)(d,{label:"logout",onClick:t[0]||(t[0]=e=>i.logout()),class:"p-button-sm p-button-rounded"})])),_:1}),(0,a._)("div",V,[(0,a.Wm)(r),(0,a._)("div",I,[(0,a._)("div",R,[(0,a.Wm)(u,{filter:o.filter},null,8,["filter"]),(0,a.Wm)(d,{label:"Новый документ",onClick:i.chooseDocType,class:"p-button-rounded p-button-secondary p-button-outlined"},null,8,["onClick"])]),(0,a._)("div",null,[(0,a._)("div",x,[(0,a.Wm)(h,{value:i.documents,onRowClick:i.openDocument,class:"p-datatable-sm",stripedRows:"",paginator:!0,rows:10,selection:s.selectedProduct,"onUpdate:selection":t[3]||(t[3]=e=>s.selectedProduct=e),selectionMode:"single",sortField:"date_time",sortOrder:-1,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",rowsPerPageOptions:[10,20,50],responsiveLayout:"scroll",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}"},{header:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a._)("div",O,[F,(0,a.Wm)(m,{id:"buttonbar",modelValue:s.firstDate,"onUpdate:modelValue":t[1]||(t[1]=e=>s.firstDate=e),onDateSelect:i.setStartDate,dateFormat:"dd.mm.yy",showButtonBar:!0},null,8,["modelValue","onDateSelect"]),E,(0,a.Wm)(m,{id:"buttonbar",modelValue:s.lastDate,"onUpdate:modelValue":t[2]||(t[2]=e=>s.lastDate=e),onDateSelect:i.setEndDate,dateFormat:"dd.mm.yy",showButtonBar:!0},null,8,["modelValue","onDateSelect"]),(0,a.Wm)(d,{icon:"pi pi-angle-right",onClick:i.resetDocuments,class:"p-button-sm p-button-rounded p-button-secondary p-button-text mlr-1"},null,8,["onClick"])])])])),empty:(0,a.w5)((()=>[B])),loading:(0,a.w5)((()=>[N])),paginatorstart:(0,a.w5)((()=>[(0,a.Wm)(d,{type:"button",icon:"pi pi-refresh",class:"p-button-text"})])),paginatorend:(0,a.w5)((()=>[(0,a.Wm)(d,{type:"button",icon:"pi pi-cloud",class:"p-button-text"})])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{field:"is_hold",header:"",dataType:"boolean"},{body:(0,a.w5)((({data:e})=>[(0,a.wy)((0,a._)("i",{class:(0,A.C_)(["pi",i.iconClass(e)])},null,2),[[C,i.getToolTipText(e)]])])),_:1}),(0,a.Wm)(p,{field:"number",header:"№",sortable:"",style:{"max-width":"7rem"}},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(e.number),3)])),_:1}),(0,a.Wm)(p,{field:"doc_type",header:"Документ",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(e.doc_type),3)])),_:1}),(0,a.Wm)(p,{field:"project.name",header:"Проект",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(e.project.name),3)])),_:1}),(0,a.Wm)(p,{field:"date_time",header:"Время",sortable:"",dataType:"date"},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(new Date(e.date_time).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"})),3)])),_:1}),(0,a.Wm)(p,{field:"storage_from.name",header:"со склада",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(i.getName(e.storage_from)),3)])),_:1}),(0,a.Wm)(p,{field:"storage_to.name",header:"на склад",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(i.getName(e.storage_to)),3)])),_:1}),(0,a.Wm)(p,{field:"amount",header:"Сумма",sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(i.formatCurrency(e.amount)),3)])),_:1}),(0,a.Wm)(p,{field:"author.name",header:"Автор",style:{"max-width":"9rem"},sortable:""},{body:(0,a.w5)((({data:e})=>[(0,a._)("div",{class:(0,A.C_)(i.disabledClass(e))},(0,A.zw)(i.getName(e.author)),3)])),_:1}),(0,a.Wm)(p,{style:{"max-width":"3rem"}},{body:(0,a.w5)((({data:e})=>[(0,a.Wm)(d,{icon:"pi pi-bars",class:"p-button-rounded p-button-secondary p-button-text mr-2",onClick:t=>i.toggleModalMenu(t,e)},null,8,["onClick"])])),_:1})])),_:1},8,["value","onRowClick","selection"])])])])]),(0,a.Wm)(f,{visible:s.displayDocument,"onUpdate:visible":t[4]||(t[4]=e=>s.displayDocument=e),style:{width:"80vw"},modal:!0,showHeader:s.showDialogHeader},{footer:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"Закрыть",icon:"pi pi-times",onClick:i.closeDocument,class:"p-button-sm p-button-secondary p-button-text"},null,8,["onClick"]),s.docRedactor?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"Сохранить",icon:"pi pi-check",onClick:i.openSaveDocDialog,class:"p-button-sm p-button-rounded p-button-secondary",autofocus:"",disabled:s.disabledSaveButton},null,8,["onClick","disabled"])):(0,a.kq)("",!0),(0,a.Wm)(d,{label:s.holdLable,icon:"pi pi-check",onClick:i.holdDocument,class:"p-button-sm p-button-rounded p-button-secondary",disabled:s.disabledHoldButton},null,8,["label","onClick","disabled"])])),default:(0,a.w5)((()=>[s.docRedactor?((0,a.wg)(),(0,a.iD)("div",Z,[(0,a.Wm)(_,{docId:s.docId,onDisableHoldButton:i.disableHoldButton,onDisableSaveButton:i.disableSaveButton,type:s.type,docType:s.docType},null,8,["docId","onDisableHoldButton","onDisableSaveButton","type","docType"])])):((0,a.wg)(),(0,a.iD)("div",j,[(0,a.Wm)(g,{docId:s.docId,onCopyToRequestDoc:i.openRequestDocRedactor,onOpenUpdateDoc:i.openUpdateDocumentRedactor,onOpenCopyDoc:i.openCopyDocumentRedactor},null,8,["docId","onCopyToRequestDoc","onOpenUpdateDoc","onOpenCopyDoc"])]))])),_:1},8,["visible","showHeader"]),(0,a.Wm)(y,{ref:"opDocTypes"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.docTypes,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e},[(0,a.Wm)(d,{class:"p-button-secondary p-button-text",onClick:t=>i.addNewDocByType(e.name)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,A.zw)(e.name),1)])),_:2},1032,["onClick"])])))),128))])),_:1},512),(0,a.Wm)(b,{ref:"menu",model:s.menuModel,popup:!0},null,8,["model"]),(0,a.Wm)(f,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[5]||(t[5]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[s.buttonNoEnabled?((0,a.wg)(),(0,a.j4)(d,{key:0,label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"])):(0,a.kq)("",!0),(0,a.Wm)(d,{label:"OK",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h3",null,(0,A.zw)(s.confirmationMessage),1)])),_:1},8,["visible"]),(0,a.Wm)(f,{header:"Сохраение",class:"border",visible:s.displaySaveDialog,"onUpdate:visible":t[9]||(t[9]=e=>s.displaySaveDialog=e),style:{width:"350px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"Отмена",icon:"pi pi-times",onClick:i.closeSaveDocDialog,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(d,{label:"Сохранить",icon:"pi pi-check",onClick:i.saveDocument,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[M,(0,a._)("div",$,[(0,a.Wm)(v,{id:"time1",name:"choseTime",value:"dayStart",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[6]||(t[6]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),H]),"update"==s.type?((0,a.wg)(),(0,a.iD)("div",q,[(0,a.Wm)(v,{id:"time2",name:"choseTime",value:"currentTime",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[7]||(t[7]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),K])):(0,a.kq)("",!0),(0,a._)("div",z,[(0,a.Wm)(v,{id:"time3",name:"choseTime",value:"dayEnd",modelValue:s.salectedSaveTime,"onUpdate:modelValue":t[8]||(t[8]=e=>s.salectedSaveTime=e)},null,8,["modelValue"]),L])])),_:1},8,["visible"])],64)}var J=o(8094),Y=o(5247),Q=o(3609);function X(e,t,o,l,s,i){const n=(0,a.up)("SelectButton");return(0,a.wg)(),(0,a.j4)(n,{modelValue:s.selectedFilter,"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedFilter=e),options:s.filters,optionLabel:"name",optionValue:"path",onChange:i.setFilter},null,8,["modelValue","options","onChange"])}var ee=o(1109),te={name:"DocContent",components:{SelectButton:ee.Z},props:{filter:String},data(){return{selectedFilter:this.$route.params.filter,filters:[{name:"Приходные",path:"posting"},{name:"Складские",path:"store"},{name:"Заявки",path:"request"},{name:"Кассовые",path:"order"},{name:"Чеки",path:"check"},{name:"Инвентаризации",path:"invent"},{name:"Все",path:""}]}},watch:{filter(e){this.selectedFilter=e}},methods:{setFilter(e){this.$router.push(`/documents/${e.value}`)}}};const oe=(0,c.Z)(te,[["render",X]]);var le=oe;const se=e=>((0,a.dD)("data-v-a8785054"),e=e(),(0,a.Cn)(),e),ae=se((()=>(0,a._)("br",null,null,-1))),ie=se((()=>(0,a._)("br",null,null,-1))),ne={key:0},de={class:"formgrid grid"},ce={class:"field col-12 md:col-12"},re={class:"mb-2"},ue={class:"field col-12 md:col-5 flex justify-content-between numberdatecard"},me={class:"mt-3 mb-3"},pe=se((()=>(0,a._)("label",{for:"number",class:"label"},"Номер",-1))),he=se((()=>(0,a._)("br",null,null,-1))),_e={class:"mt-3 mb-3"},ge=se((()=>(0,a._)("label",{for:"time",class:"label"},"Дата",-1))),fe=se((()=>(0,a._)("br",null,null,-1))),ye={class:"field col-12 md:col-7 center right"},be={key:0,class:"mr-5"},ve={class:"field col-12 md:col-4"},Ce=se((()=>(0,a._)("label",{for:"project",class:"label"},"Проект",-1))),ke=se((()=>(0,a._)("br",null,null,-1))),De={class:"p-inputgroup"},we=se((()=>(0,a._)("div",{class:"field col-12 md:col-8"},null,-1))),Se={key:0,class:"field col-12 md:col-4"},Te={key:0},Pe=se((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),Ae=se((()=>(0,a._)("br",null,null,-1))),We={class:"p-inputgroup"},Ve={key:1,class:"field col-12 md:col-4"},Ie={key:0},Re=se((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),xe=se((()=>(0,a._)("br",null,null,-1))),Ue={class:"p-inputgroup"},Oe={key:2,class:"field col-12 md:col-4"},Fe={key:3,class:"field col-12 md:col-4"},Ee={key:0},Be=se((()=>(0,a._)("label",{for:"supplier",class:"label"},"Поставщик",-1))),Ne=se((()=>(0,a._)("br",null,null,-1))),Ze={class:"p-inputgroup"},je={key:4,class:"field col-12 md:col-4"},Me={key:0},$e=se((()=>(0,a._)("label",{for:"recipient",class:"label"},"Получатель",-1))),He=se((()=>(0,a._)("br",null,null,-1))),qe={class:"p-inputgroup"},Ke={key:5,class:"field col-12 md:col-4"},ze={key:6,class:"field col-12 md:col-4"},Le=se((()=>(0,a._)("label",{for:"individual",class:"label"},"Физ лицо",-1))),Ge=se((()=>(0,a._)("br",null,null,-1))),Je={class:"p-inputgroup"},Ye={key:7,class:"field col-12 md:col-4"},Qe=se((()=>(0,a._)("label",{for:"payment_type",class:"label"},"Физ лицо",-1))),Xe=se((()=>(0,a._)("br",null,null,-1))),et={class:"p-inputgroup"},tt={key:8,class:"field col-12 md:col-4"},ot={key:9,class:"field col-12 md:col-4"},lt=se((()=>(0,a._)("label",{for:"amount",class:"label"},"сумма",-1))),st=se((()=>(0,a._)("br",null,null,-1))),at={key:10,class:"field col-12 md:col-8"},it=se((()=>(0,a._)("label",{for:"tax",class:"label"},"сумма",-1))),nt=se((()=>(0,a._)("br",null,null,-1))),dt={key:1},ct=se((()=>(0,a._)("div",{class:"inline-flex align-items-center"},[(0,a._)("i",{class:"pi pi-paperclip mr-2"}),(0,a.Uk)(" информация из чека ККМ ")],-1))),rt={class:"formgrid grid"},ut={class:"field col-12 md:col-3"},mt=se((()=>(0,a._)("label",{for:"waiter",class:"label"},"официант",-1))),pt=se((()=>(0,a._)("br",null,null,-1))),ht={class:"field col-12 md:col-3"},_t=se((()=>(0,a._)("label",{for:"check_number",class:"label"},"номер чека",-1))),gt=se((()=>(0,a._)("br",null,null,-1))),ft={class:"field col-12 md:col-3"},yt=se((()=>(0,a._)("label",{for:"cash_register_number",class:"label"},"номер кассы",-1))),bt=se((()=>(0,a._)("br",null,null,-1))),vt={class:"field col-12 md:col-3"},Ct=se((()=>(0,a._)("label",{for:"amount_received",class:"label"},"получено",-1))),kt=se((()=>(0,a._)("br",null,null,-1))),Dt={class:"field col-12 md:col-3"},wt=se((()=>(0,a._)("label",{for:"table_number",class:"label"},"стол",-1))),St=se((()=>(0,a._)("br",null,null,-1))),Tt={class:"field col-12 md:col-3"},Pt=se((()=>(0,a._)("label",{for:"guest_number",class:"label"},"гость",-1))),At=se((()=>(0,a._)("br",null,null,-1))),Wt={class:"field col-12 md:col-3"},Vt=se((()=>(0,a._)("label",{for:"kkm_check_time",class:"label"},"время",-1))),It=se((()=>(0,a._)("br",null,null,-1))),Rt=se((()=>(0,a._)("div",{class:"field col-12 md:col-3"},null,-1))),xt={class:"field col-12 md:col-2"},Ut=se((()=>(0,a._)("label",{for:"isReturn",class:"label"},"возврат",-1))),Ot={class:"field col-12 md:col-2"},Ft=se((()=>(0,a._)("label",{for:"isKKMChecked",class:"label"},"пробит",-1))),Et={class:"field col-12 md:col-2"},Bt=se((()=>(0,a._)("label",{for:"is_Paid",class:"label"},"оплачен",-1))),Nt={class:"field col-12 md:col-2"},Zt=se((()=>(0,a._)("label",{for:"isPayedByCard",class:"label"},"эквайринг",-1))),jt={class:"field col-12 md:col-2"},Mt=se((()=>(0,a._)("label",{for:"isDelivery",class:"label"},"доставка",-1))),$t={key:2},Ht=se((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),qt=se((()=>(0,a._)("br",null,null,-1)));function Kt(e,t,o,l,s,i){const n=(0,a.up)("InputText"),d=(0,a.up)("Calendar"),c=(0,a.up)("Button"),r=(0,a.up)("Divider"),u=(0,a.up)("InputSwitch"),m=(0,a.up)("Column"),p=(0,a.up)("Row"),h=(0,a.up)("ColumnGroup"),_=(0,a.up)("DataTable"),g=(0,a.up)("OverlayPanel"),f=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[ae,ie,i.doc.author&&i.doc.project?((0,a.wg)(),(0,a.iD)("div",ne,[(0,a._)("div",de,[(0,a._)("div",ce,[(0,a._)("p",re,[(0,a._)("b",null,"Документ "+(0,A.zw)(i.doc.doc_type),1),(0,a.Uk)(" (автор "+(0,A.zw)(i.doc.author.name)+")",1)])]),(0,a._)("div",ue,[(0,a._)("div",me,[pe,he,(0,a.Wm)(n,{id:"number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext smallinput",modelValue:i.doc.number,"onUpdate:modelValue":t[0]||(t[0]=e=>i.doc.number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",_e,[ge,fe,(0,a.Wm)(d,{id:"time",onChange:i.disableHoldButton,onDateSelect:i.disableHoldButton,modelValue:s.dateInput,"onUpdate:modelValue":t[1]||(t[1]=e=>s.dateInput=e),dateFormat:"dd.mm.yy",showIcon:!0},null,8,["onChange","onDateSelect","modelValue"])])]),(0,a._)("div",ye,[i.doc.doc_type===s.DocumentType.INVENTORY_DOC?((0,a.wg)(),(0,a.iD)("div",be,[(0,a.Wm)(c,{label:"Заполнить",class:"p-button-rounded p-button-secondary mr-1",onClick:i.onFillRestClick,disabled:s.disabledFillItemRest},null,8,["onClick","disabled"]),(0,a.Wm)(c,{label:"Создать подчиненные документы",class:"p-button-rounded p-button-secondary",onClick:i.onCreateDockClick,disabled:s.disabledFillItemRest},null,8,["onClick","disabled"])])):(0,a.kq)("",!0)]),(0,a._)("div",ve,[Ce,ke,(0,a._)("div",De,[(0,a.Wm)(n,{id:"project",type:"text",class:"p-inputtext-sm",modelValue:i.doc.project.name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.doc.project.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),we,s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Se,[i.doc.storage_from?((0,a.wg)(),(0,a.iD)("div",Te,[Pe,Ae,(0,a._)("div",We,[(0,a.Wm)(n,{id:"storageFrom",type:"text",class:"p-inputtext-sm",modelValue:i.doc.storage_from.name,"onUpdate:modelValue":t[3]||(t[3]=e=>i.doc.storage_from.name=e),disabled:s.disabledStorageFrom},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageFromClick,disabled:s.disabledStorageFrom},null,8,["onClick","disabled"])])])):(0,a.kq)("",!0)])),s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Ve,[i.doc.storage_to?((0,a.wg)(),(0,a.iD)("div",Ie,[Re,xe,(0,a._)("div",Ue,[(0,a.Wm)(n,{id:"storageTo",type:"text",class:"p-inputtext-sm",modelValue:i.doc.storage_to.name,"onUpdate:modelValue":t[4]||(t[4]=e=>i.doc.storage_to.name=e),disabled:s.disabledStorageTo},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageToClick,disabled:s.disabledStorageTo},null,8,["onClick","disabled"])])])):(0,a.kq)("",!0)])),s.orderDoc?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Oe)),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Fe,[i.doc.supplier?((0,a.wg)(),(0,a.iD)("div",Ee,[Be,Ne,(0,a._)("div",Ze,[(0,a.Wm)(n,{id:"supplier",type:"text",class:"p-inputtext-sm",modelValue:i.doc.supplier.name,"onUpdate:modelValue":t[5]||(t[5]=e=>i.doc.supplier.name=e),disabled:s.disabledSupplier},null,8,["modelValue","disabled"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onSupplierClick},null,8,["onClick"])])])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",je,[i.doc.recipient?((0,a.wg)(),(0,a.iD)("div",Me,[$e,He,(0,a._)("div",qe,[(0,a.Wm)(n,{id:"recipient",type:"text",class:"p-inputtext-sm",modelValue:i.doc.recipient.name,"onUpdate:modelValue":t[6]||(t[6]=e=>i.doc.recipient.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onRecipientClick},null,8,["onClick"])])])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Ke)):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",ze,[Le,Ge,(0,a._)("div",Je,[(0,a.Wm)(n,{id:"individual",type:"text",class:"p-inputtext-sm",modelValue:i.doc.individual.name,"onUpdate:modelValue":t[7]||(t[7]=e=>i.doc.individual.name=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onIndividualClick},null,8,["onClick"])])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",Ye,[Qe,Xe,(0,a._)("div",et,[(0,a.Wm)(n,{id:"payment_type",type:"text",class:"p-inputtext-sm",modelValue:i.doc.payment_type,"onUpdate:modelValue":t[8]||(t[8]=e=>i.doc.payment_type=e)},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onPaymentTypeClick},null,8,["onClick"])])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",tt)):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",ot,[lt,st,(0,a.Wm)(n,{id:"amount",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.amount,"onUpdate:modelValue":t[9]||(t[9]=e=>i.doc.amount=e)},null,8,["onChange","modelValue"])])):(0,a.kq)("",!0),s.orderDoc?((0,a.wg)(),(0,a.iD)("div",at,[it,nt,(0,a.Wm)(n,{id:"tax",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.tax,"onUpdate:modelValue":t[10]||(t[10]=e=>i.doc.tax=e)},null,8,["onChange","modelValue"])])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),i.doc.check_info?((0,a.wg)(),(0,a.iD)("div",dt,[(0,a.Wm)(r,{align:"left"},{default:(0,a.w5)((()=>[ct])),_:1}),(0,a._)("div",rt,[(0,a._)("div",ut,[mt,pt,(0,a.Wm)(n,{id:"waiter",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.waiter,"onUpdate:modelValue":t[11]||(t[11]=e=>i.doc.check_info.waiter=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",ht,[_t,gt,(0,a.Wm)(n,{id:"check_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.check_number,"onUpdate:modelValue":t[12]||(t[12]=e=>i.doc.check_info.check_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",ft,[yt,bt,(0,a.Wm)(n,{id:"cash_register_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.cash_register_number,"onUpdate:modelValue":t[13]||(t[13]=e=>i.doc.check_info.cash_register_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",vt,[Ct,kt,(0,a.Wm)(n,{id:"amount_received",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.amount_received,"onUpdate:modelValue":t[14]||(t[14]=e=>i.doc.check_info.amount_received=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Dt,[wt,St,(0,a.Wm)(n,{id:"table_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.table_number,"onUpdate:modelValue":t[15]||(t[15]=e=>i.doc.check_info.table_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Tt,[Pt,At,(0,a.Wm)(n,{id:"guest_number",onChange:i.disableHoldButton,type:"text",class:"p-inputtext-sm mr-1",modelValue:i.doc.check_info.guest_number,"onUpdate:modelValue":t[16]||(t[16]=e=>i.doc.check_info.guest_number=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Wt,[Vt,It,(0,a.Wm)(d,{id:"kkm_check_time",onChange:i.disableHoldButton,modelValue:s.checkDateInput,"onUpdate:modelValue":t[17]||(t[17]=e=>s.checkDateInput=e),showTime:!0,showSeconds:!0,dateFormat:"dd.mm.yy",disabled:""},null,8,["onChange","modelValue"])]),Rt,(0,a._)("div",xt,[Ut,(0,a.Wm)(u,{id:"isReturn",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_return,"onUpdate:modelValue":t[18]||(t[18]=e=>i.doc.check_info.is_return=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Ot,[Ft,(0,a.Wm)(u,{id:"isKKMChecked",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_KKM_checked,"onUpdate:modelValue":t[19]||(t[19]=e=>i.doc.check_info.is_KKM_checked=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Et,[Bt,(0,a.Wm)(u,{id:"is_Paid",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_payed,"onUpdate:modelValue":t[20]||(t[20]=e=>i.doc.check_info.is_payed=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",Nt,[Zt,(0,a.Wm)(u,{id:"isPayedByCard",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_payed_by_card,"onUpdate:modelValue":t[21]||(t[21]=e=>i.doc.check_info.is_payed_by_card=e)},null,8,["onChange","modelValue"])]),(0,a._)("div",jt,[Mt,(0,a.Wm)(u,{id:"isDelivery",onChange:i.disableHoldButton,modelValue:i.doc.check_info.is_delivery,"onUpdate:modelValue":t[22]||(t[22]=e=>i.doc.check_info.is_delivery=e)},null,8,["onChange","modelValue"])])])])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",$t,[(0,a.Wm)(c,{icon:"pi pi-plus",onClick:i.onAddItemClick,class:"p-button-text p-button-rounded"},null,8,["onClick"]),(0,a.Wm)(_,{value:i.doc.doc_items,rowClass:i.rowClass,editMode:"cell",onCellEditInit:i.onCellEditInit,onCellEditComplete:i.onCellEditComplete,class:"p-datatable-sm editable-cells-table",responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"item_name",header:"Наименование",key:"item_name"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"]),(0,a.Wm)(c,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onItemClick},null,8,["onClick"])])),_:1}),(0,a.Wm)(m,{field:"quantity",header:"Количество",key:"quantity"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{field:"quantity_fact",header:"Количество факт.",key:"quantity_fact"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(m,{field:"price",header:"Цена",key:"price"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(m,{field:"amount",header:"Сумма",key:"amount"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{field:"amount_fact",header:"Сумма факт.",key:"amount_fact"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),s.isCheck?((0,a.wg)(),(0,a.j4)(m,{field:"discount",header:"Скидка",key:"discount"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(n,{onChange:i.disableHoldButton,modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,autofocus:""},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(m,{style:{width:"1rem"}},{body:(0,a.w5)((({data:e})=>[(0,a.Wm)(c,{icon:"pi pi-minus",class:"p-button-rounded p-button-secondary p-button-text mr-2",onClick:t=>i.deleteRow(e)},null,8,["onClick"])])),_:1}),(0,a.Wm)(h,{type:"footer"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{footer:"сумма:",colspan:s.colSpan,footerStyle:"text-align:right"},null,8,["colspan"]),(0,a.Wm)(m,{footer:i.totalAmount},null,8,["footer"]),s.isInventory?((0,a.wg)(),(0,a.j4)(m,{key:0,footer:i.totalAmountFact,colspan:2},null,8,["footer"])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["value","rowClass","onCellEditInit","onCellEditComplete"])])):(0,a.kq)("",!0),(0,a.Wm)(g,{ref:"opPaymentTypes"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:s.paymentTypes,selection:s.selectedPaymentType,"onUpdate:selection":t[23]||(t[23]=e=>s.selectedPaymentType=e),selectionMode:"single",onRowSelect:i.onPaymentTypeSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"value",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[24]||(t[24]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opUsers"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.users,selection:s.selectedUsers,"onUpdate:selection":t[25]||(t[25]=e=>s.selectedUsers=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onUserSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:"",style:{width:"60%"}}),(0,a.Wm)(m,{field:"email",header:"email",sortable:"",style:{width:"40%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opCompanies"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.companies,selection:s.selectedCompany,"onUpdate:selection":t[26]||(t[26]=e=>s.selectedCompany=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onCompanySelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:"",style:{width:"60%"}}),(0,a.Wm)(m,{field:"inn",header:"email",sortable:"",style:{width:"40%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opStorage"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.storages,selection:s.selectedStorage,"onUpdate:selection":t[27]||(t[27]=e=>s.selectedStorage=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onStorageSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(f,{header:"Подбор номенклатуры",class:"border",visible:s.displayItems,"onUpdate:visible":t[31]||(t[31]=e=>s.displayItems=e),modal:!0,closable:!1,contentStyle:{height:"100%"},style:{width:"900px",height:"500px"}},{header:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(n,{class:"p-inputtext-sm mr-2",modelValue:s.filters["global"].value,"onUpdate:modelValue":t[28]||(t[28]=e=>s.filters["global"].value=e),placeholder:"поиск",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(c,{icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-plain p-button-sm",onClick:i.clearFilter},null,8,["onClick"])])])),footer:(0,a.w5)((()=>[(0,a.Wm)(c,{label:"закрыть",icon:"pi pi-times",onClick:i.closeDialog,class:"p-button-text p-button-sm"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.items,class:"p-datatable-sm",selection:s.selectedItem,"onUpdate:selection":t[29]||(t[29]=e=>s.selectedItem=e),selectionMode:"single",filters:s.filters,"onUpdate:filters":t[30]||(t[30]=e=>s.filters=e),filterDisplay:"menu",globalFilterFields:["name"],onRowSelect:i.onItemSelect,scrollable:!1,loading:s.loading},{loading:(0,a.w5)((()=>[Ht])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{field:"name",header:"Name",sortable:""}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.storages,(e=>((0,a.wg)(),(0,a.j4)(m,{header:e.name,key:e.id},{body:(0,a.w5)((({data:t})=>[(0,a._)("div",{class:(0,A.C_)(i.boldClass(i.doc,e))},(0,A.zw)(i.getItemRestOnStorage(t,e)),3)])),_:2},1032,["header"])))),128)),(0,a.Wm)(m,{field:"price",header:"Последняя цена",sortable:""})])),_:1},8,["value","selection","filters","onRowSelect","loading"]),qt])),_:1},8,["visible"])],64)}var zt=o(2482),Lt=o(8223),Gt=o(6663),Jt=o(9755),Yt=o(7077),Qt=o(2958),Xt=o(3242),eo=o(6358);const to="http://localhost:8081",oo={PROJECT:"PROJECT",STORAGE_FROM:"STORAGE_FROM",STORAGE_TO:"STORAGE_TO",ADD_REST_FOR_HOLD:"ADD_REST_FOR_HOLD",AVERAGE_COST:"AVERAGE_COST"},lo={POSTING_DOC:"Поступление",RECEIPT_DOC:"Оприходование",MOVEMENT_DOC:"Перемещение",WRITE_OFF_DOC:"Списание",CHECK_DOC:"Чек ККМ",CREDIT_ORDER_DOC:"ПКО",WITHDRAW_ORDER_DOC:"Расходный кассовый ордер",REQUEST_DOC:"Заявка",INVENTORY_DOC:"Инвентаризация"},so={TAX_PAYMENT:"Оплата налога",CLIENT_PAYMENT:"Оплата от покупателя",SUPPLIER_PAYMENT:"Оплата поставщику",OTHER_PAYMENT:"Прочее",SALARY_PAYMENT:"Выплата заработной платы",SALE_CASH_PAYMENT:"Выручка наличными",SALE_CARD_PAYMENT:"Выручка по картам"};var ao={name:"DocContent",components:{Calendar:Lt.Z,InputText:k.Z,DataTable:J.Z,Column:Y.Z,InputSwitch:Gt.Z,ColumnGroup:Jt.Z,Row:Yt.Z,Button:w.Z,OverlayPanel:Qt.Z,Divider:Xt.Z,Dialog:Q.Z},props:{docId:Number,type:String,docType:String},emits:{disableHoldButton:null,disableSaveButton:null},data(){return{filters:null,loading:!1,user:null,selectedPaymentType:null,selectedProject:null,selectedStorageFrom:null,disabledStorageFrom:!1,selectedStorageTo:null,disabledStorageTo:!1,is_hold:!0,selectedRow:null,selectedUsers:null,selectedRecipient:null,disabledRecipient:!1,selectedSupplier:null,disabledSupplier:!1,userType:null,companyType:null,selectedCompany:null,storageType:null,selectedStorage:null,selectedItem:null,dateInput:"",checkDateInput:"",currentField:null,currentData:null,itemSelectType:String,disabledFillItemRest:!0,orderDoc:!1,isInventory:!1,isCheck:!1,colSpan:3,DocumentType:lo,paymentTypes:[],displayItems:!1}},computed:{doc(){let e=this.$store.state.ds.document;return"copyToRequestDoc"===this.type&&(e.id=0,e.doc_type=lo.MOVEMENT_DOC,e.time=new Date),"copy"===this.type&&(e.date_time=new Date,this.disableSaveButton()),e},projects(){return this.$store.state.cs.projects},storages(){return this.$store.state.cs.storages},users(){return this.$store.state.cs.users},companies(){return this.$store.state.cs.companies},items(){return this.$store.state.is.items},totalAmount(){let e=0;for(let t of this.doc.doc_items)e+=t.amount-t.discount;return this.formatCurrency(e)},totalAmountFact(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity_fact;return this.formatCurrency(e)},itemRest(){return this.$store.state.ds.itemRest},defaultProperties(){return this.$store.state.ss.defaultProperties},period(){return this.$store.state.ss.period}},created(){this.initFilters()},mounted(){this.$store.dispatch("getDocument",[this.docId,this.docType]),this.user=JSON.parse(localStorage.getItem("user")),this.setPaymentTypes()},watch:{doc(e){if(e.doc_type!=lo.WITHDRAW_ORDER_DOC&&e.doc_type!=lo.CREDIT_ORDER_DOC||(this.orderDoc=!0),e.doc_type!=lo.POSTING_DOC&&e.doc_type!=lo.RECEIPT_DOC||(this.disabledStorageFrom=!0),e.doc_type!=lo.WRITE_OFF_DOC&&e.doc_type!=lo.CHECK_DOC&&e.doc_type!=lo.INVENTORY_DOC||(this.disabledStorageTo=!0),0==e.id){let t=this.users.filter((e=>e.id==this.user.id)).pop();if(e.author=t,this.defaultProperties.length>0){let t=this.defaultProperties.filter((e=>e.type==oo.PROJECT)).pop().property;if(e.project=this.getProjectById(t),!this.disabledStorageTo){let t=this.defaultProperties.filter((e=>e.type==oo.STORAGE_TO)).pop().property;e.storage_to=this.getStorageById(t)}if(!this.disabledStorageFrom){let t=this.defaultProperties.filter((e=>e.type==oo.STORAGE_FROM)).pop().property;e.storage_from=this.getStorageById(t)}}}e.payment_type&&(this.selectedPaymentType=e.payment_type),e.storage_from&&(this.selectedStorageFrom=e.storage_from.id),e.storage_to&&(this.selectedStorageTo=e.storage_to.id),e.doc_type==lo.CHECK_DOC&&(this.isCheck=!0,this.colSpan++),e.doc_type==lo.INVENTORY_DOC&&(this.isInventory=!0,this.colSpan++),this.selectedProject=e.project,this.dateInput=e.date_time,e.check_info&&(this.checkDateInput=e.check_info.date_time),this.enableFillItemRestButton()},itemRest(e){this.doc.doc_items=e},dateInput(e){this.doc.date_time=e},items(){this.loading=!1}},methods:{clearFilter(){this.initFilters()},initFilters(){this.filters={global:{value:null,matchMode:eo.a6.CONTAINS},name:{operator:eo.pg.AND,constraints:[{value:null,matchMode:eo.a6.STARTS_WITH}]}}},closeDialog(){this.displayItems=!1,this.clearFilter()},setPaymentTypes(){for(var e in this.paymentTypes=[],so)this.paymentTypes.push({value:so[e]})},rowClass(e){return!0===e.is_composite?"row-composite":null},boldClass(e,t){let o;if(o=e.doc_type==lo.WRITE_OFF_DOC||e.doc_type==lo.MOVEMENT_DOC||e.doc_type==lo.CHECK_DOC?e.storage_from:e.storage_to,o.id==t.id)return"b"},disableHoldButton(){this.$emit("disableHoldButton")},disableSaveButton(){this.$emit("disableSaveButton")},getProjectById(e){return this.projects.filter((t=>t.id==e)).pop()},getStorageById(e){return this.storages.filter((t=>t.id==e)).pop()},getItemRestOnStorage(e,t){for(let o of e.rest_list)if(o.storage.id==t.id)return o.quantity},deleteRow(e){this.doc.doc_items=this.doc.doc_items.filter((t=>t!=e)),this.$emit("disableHoldButton")},onPaymentTypeClick(e){this.$refs.opPaymentTypes.toggle(e)},onPaymentTypeSelect(e){this.doc.payment_type=e.data.value,this.$refs.opPaymentTypes.hide(),this.$emit("disableHoldButton")},enableFillItemRestButton(){0!=this.doc.author.id&&0!=this.doc.storage_from.id&&(this.disabledFillItemRest=!1)},onFillRestClick(){this.$store.dispatch("getRestOnDateAndStorage",[this.doc.id,this.dateInput,this.doc.storage_from.id]),this.$emit("disableHoldButton")},onCreateDockClick(){this.$store.dispatch("createRelativeDocks",this.doc)},onCellEditComplete(e){let{data:t,newValue:o,field:l}=e;"item_name"!=l&&(t[l]=o),"quantity"===l||"quantity_fact"===l||"price"===l||"discount"===l?(t["amount"]=t["price"]*t["quantity"],t["amount_fact"]=t["price"]*t["quantity_fact"]):"amount_fact"===l?(t["price"]=t["amount_fact"]/t["quantity_fact"],t["amount"]=t["price"]*t["quantity"]):"amount"===l&&(t["price"]=t["amount"]/t["quantity"],t["amount_fact"]=t["price"]*t["quantity_fact"])},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},onAuthorClick(e){this.userType="author",this.$refs.opUsers.toggle(e)},onUserSelect(e){"individual"==this.userType?this.doc.individual=e.data:this.doc.author=e.data,this.enableFillItemRestButton(),this.$refs.opUsers.hide(),this.$emit("disableHoldButton")},onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.doc.project=e.data,this.$refs.opProjects.hide(),this.$emit("disableHoldButton")},onRecipientClick(e){this.companyType="recipient",this.$refs.opCompanies.toggle(e)},onIndividualClick(e){this.userType="individual",this.$refs.opUsers.toggle(e)},onSupplierClick(e){this.companyType="supplier",this.$refs.opCompanies.toggle(e)},onCompanySelect(e){"recipient"==this.companyType?this.doc.recipient=e.data:this.doc.supplier=e.data,this.$refs.opCompanies.hide(),this.$emit("disableHoldButton")},onStorageFromClick(e){this.storageType="storageFrom",this.$refs.opStorage.toggle(e)},onStorageToClick(e){this.storageType="storageTo",this.$refs.opStorage.toggle(e)},onStorageSelect(e){"storageFrom"==this.storageType?(this.doc.storage_from=e.data,this.enableFillItemRestButton()):this.doc.storage_to=e.data,this.$refs.opStorage.hide(),this.$emit("disableHoldButton")},onItemClick(e){this.$store.dispatch("getItemsWithRest",this.doc.date_time),this.itemSelectType="update",this.$refs.opItems.toggle(e)},onAddItemClick(){this.$store.dispatch("getItemsWithRest",this.doc.date_time),this.itemSelectType="add",this.displayItems=!0},onCellEditInit(e){let{data:t,field:o}=e;"item_name"==o&&(this.currentField=o,this.currentData=t)},onItemSelect(e){this.displayItems=!1,"update"==this.itemSelectType?this.updateItem(e.data.id,e.data.name,e.data.price,e.data.is_composite):this.addItem(e.data.id,e.data.name,e.data.price,e.data.is_composite),this.$emit("disableHoldButton")},updateItem(e,t,o,l){this.currentData["item_id"]=e,this.currentData["item_name"]=t,this.currentData["price"]=o,this.currentData["is_composite"]=l,this.doc.doc_type!=lo.POSTING_DOC&&this.doc.doc_type!=lo.RECEIPT_DOC||(1==l?this.$emit("disableSaveButton",!0):io(this.doc.doc_items)||this.$emit("disableSaveButton",!1))},addItem(e,t,o,l){1!=l||this.doc.doc_type!=lo.POSTING_DOC&&this.doc.doc_type!=lo.RECEIPT_DOC||this.$emit("disableSaveButton",!0),0==this.doc.doc_items.filter((t=>t.item_id===e)).length&&this.doc.doc_items.push(new no(this.doc.id,e,t,0,o,0,0,l))}}};function io(e){let t=e.filter((e=>1==e.is_composite));return t.length>0}class no{constructor(e,t,o,l,s,a,i,n){(0,zt.Z)(this,"document_id",0),(0,zt.Z)(this,"item_id",0),(0,zt.Z)(this,"item_name",""),(0,zt.Z)(this,"quantity",0),(0,zt.Z)(this,"price",0),(0,zt.Z)(this,"discount",0),(0,zt.Z)(this,"quantity_fact",0),(0,zt.Z)(this,"is_composite",!1),this.document_id=e,this.item_id=t,this.item_name=o,this.quantity=l,this.price=s,this.discount=a,this.quantity_fact=i,this.is_composite=n}}const co=(0,c.Z)(ao,[["render",Kt],["__scopeId","data-v-a8785054"]]);var ro=co,uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAArtJREFUOI2Vk01IlFEUhp9z5xtnjEQKY1yUIoIztShM0EJTsoJAQyH6m5VSbYoMJVAQ6SM+F2E/WNAiCoJmZNxVlO3cVpuoTRCFhf05aTPNOKOfjXlbjNqoo9G7u/c993nPPZcrZNFJyypGxC+aRqAEKAAm0Iwg8lgZauB2V9fo8nOSuWgxTbfDyOkV9FnAlS1oXjOCvpmane25Z5r2Ctip3l6PhoeiqUJrEMmOARZ8LbwQaLrT3R0GUADt167lonkkmqp0xBqgDD8dzIMW03QvwuJTtgVUrk1YVbsMh/MSgJy0rGJB3qK1658dZaihppoij4fA0FMmp6ft3+gyhYgf+C/Q4fq9NNfVsdPnw1dSAuA2RPxK5mhYKOrwn+B6RztlRUWrghpraji4ezcAI1++8PrdOwD0HA0K0aWQftbNHg/rc3M5f/wY29KJS3SgqpKmuloARsfC9IcG+ZVKpU1FqQLZCKCBG4ODJKenyXE6OXfsKOXeskVQ9Y7tHNm/H4BwJEJ/KMSUbf9N0hQ4dtbvOwPkAfycTPDmw0cqtvpw5+RQ7vXybeIHxYWFtB5qREQYj0bpCwSIJZLLGx9zlNfvaxZYHFIskeDNyAcqfD7cLhcVPi/l3jKUUkTica4EgkTjk9nG+UoJ8mT57qdwmL5AkFgiiVIKpRSxRJKrwQF+xGJZH0aEIaUMNQDYaL3E/Do+Tt/9+0Tjk0zZNv2hEN8jkawgwNYpIygApy2rTyMXslVt2rCBXJeL0bGxlaYGBLTm8t2e7i4DIDU72+NwOvcs/s0MjUej2XuZB6F5ti4/7yLM/817pmkLNAHPV7vHCs2DjN+p5pttbTMAjgXv5fBwcnttbVCJw4VQARhroGytubouP6/lVmdnPJO/Qq2WtcUQ8es5GlCUoilAmEDzXoQhnTKCd8zOz8vP/QHJVfIIEVziNAAAAABJRU5ErkJggg==",mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAkZJREFUOI2dlE9IVFEUxn/nvvvSBJFqzFyE1KBrEwldth4XQQtzVol/NpFQBE4M5kPmTTtBbBFm4CK1yEWLcu1Oo6JoF2oLcWVaVGBj7807LWYGVExzvtW5597vd797L1zhAPVkMg2IJEXpAC4AMWAT5Qsir4w1MxOp1Np+n+we3PC8Ssee8AW9CVQctFFRO4KOB2E4NOV5uVLTlIpe369zXHdB0DuARXmKSiIM3fofTY02DN16FTpApgGryF3HdRd6fb9uT7Lbo6Mnf23/XgAuAysI1ybT6U//itXn+82qzAFxYCkMgytTnpczAD+3c5kSyIRB+2EggMfp9Me8kXZgFWizjjsCID2ZTIMgnwGL0HIUaLd6Rh5cEhO9BYI82mQQSQIVKLPHAQE8uX/vA8pzoNKKJI1EJApTMnscUElS9GlEwiAaB7D5P+/KgQV5W/AZ4gbkNMA5+FYO7ER9zRYASswAWwDrrnumHBibm7Fi9dVo4XlRaC2HlVct+VaNIK8BRKWrHJhgugBEmDfGmhkgB3q9z/ebjwPq9/0W0E4gp4GdNhOp1JqgDwFHlbnubLb2f0Dd2WxtpLwAjCpjk97gugEIwnBIhTdA3Il08aiE/b7f4kS6BFxEWayqqR4uHLmoXt+vQ3kJtAERyKwoz8To+++NjRunlpfP5lVbC3eknYBBWbT54Oojz9vYA4PCf2YddwThFlB5SLicKmNVNdXD4wMDO6WmHLSyO5M5b0WSGpHAEEeJIWyirIgwr4GdnvQG1/f7/gJtw9j8wcrxuwAAAABJRU5ErkJggg==";const po=e=>((0,a.dD)("data-v-28f1580a"),e=e(),(0,a.Cn)(),e),ho=po((()=>(0,a._)("br",null,null,-1))),_o={class:"formgrid grid"},go={class:"col-12 md:col-7 center"},fo={class:"col-12 md:col-5 center"},yo={class:"center right"},bo={key:0,class:"mr-2"},vo={class:"mr-2"},Co={key:0,class:"formgrid grid"},ko={class:"col-12 md:col-4"},Do=po((()=>(0,a._)("label",{for:"author",class:"label"},"автор",-1))),wo={id:"author",class:"text_field"},So={class:"col-12 md:col-4"},To=po((()=>(0,a._)("label",{for:"project",class:"label"},"проект",-1))),Po={id:"project",class:"text_field"},Ao=po((()=>(0,a._)("div",{class:"col-12 md:col-4"},null,-1))),Wo={key:0,class:"col-12 md:col-4"},Vo=po((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),Io={id:"storageFrom",class:"text_field"},Ro={key:1,class:"col-12 md:col-4"},xo=po((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),Uo={id:"storageTo",class:"text_field"},Oo={key:2,class:"col-12 md:col-4"},Fo={key:3,class:"field col-12 md:col-4"},Eo=po((()=>(0,a._)("label",{for:"supplier",class:"label"},"отправитель",-1))),Bo={id:"supplier",class:"text_field"},No={key:4,class:"field col-12 md:col-4"},Zo=po((()=>(0,a._)("label",{for:"recipient",class:"label"},"получатель",-1))),jo={id:"recipient",class:"text_field"},Mo={key:5,class:"field col-12 md:col-4"},$o={key:1},Ho=po((()=>(0,a._)("div",{class:"inline-flex align-items-center"},[(0,a._)("i",{class:"pi pi-paperclip mr-2"}),(0,a.Uk)(" информация из чека ККМ ")],-1))),qo={class:"formgrid grid"},Ko={class:"col-12 md:col-3"},zo=po((()=>(0,a._)("label",{for:"waiter",class:"label"},"официант",-1))),Lo={id:"waiter",class:"text_field sm"},Go={class:"col-12 md:col-3"},Jo=po((()=>(0,a._)("label",{for:"check_number",class:"label"},"номер чека",-1))),Yo={id:"check_number",class:"text_field sm"},Qo={class:"col-12 md:col-3"},Xo=po((()=>(0,a._)("label",{for:"cash_register_number",class:"label"},"номер кассы",-1))),el={id:"cash_register_number",class:"text_field sm"},tl={class:"col-12 md:col-3"},ol=po((()=>(0,a._)("label",{for:"amount_received",class:"label"},"получено",-1))),ll={id:"amount_received",class:"text_field sm"},sl={class:"col-12 md:col-3"},al=po((()=>(0,a._)("label",{for:"table_number",class:"label"},"стол",-1))),il={id:"table_number",class:"text_field sm"},nl={class:"col-12 md:col-3"},dl=po((()=>(0,a._)("label",{for:"guest_number",class:"label"},"гость",-1))),cl={id:"guest_number",class:"text_field sm"},rl={class:"col-12 md:col-3"},ul=po((()=>(0,a._)("label",{for:"kkm_check_time",class:"label"},"время",-1))),ml={id:"kkm_check_time",class:"text_field sm"},pl=po((()=>(0,a._)("div",{class:"col-12 md:col-3"},null,-1))),hl={class:"col-12 md:col-2 center"},_l=po((()=>(0,a._)("p",null,"возврат ",-1))),gl={key:0,src:uo,class:"ml-2"},fl={key:1,src:mo,class:"ml-2"},yl={class:"col-12 md:col-2 center"},bl=po((()=>(0,a._)("p",null,"пробит ",-1))),vl={key:0,src:uo,class:"ml-2"},Cl={key:1,src:mo,class:"ml-2"},kl={class:"col-12 md:col-2 center"},Dl=po((()=>(0,a._)("p",null,"оплачен ",-1))),wl={key:0,src:uo,class:"ml-2"},Sl={key:1,src:mo,class:"ml-2"},Tl={class:"col-12 md:col-2 center"},Pl=po((()=>(0,a._)("p",null,"эквайринг ",-1))),Al={key:0,src:uo,class:"ml-2"},Wl={key:1,src:mo,class:"ml-2"},Vl={class:"col-12 md:col-2 center"},Il=po((()=>(0,a._)("p",null,"доставка ",-1))),Rl={key:0,src:uo,class:"ml-2"},xl={key:1,src:mo,class:"ml-2"},Ul={key:2},Ol={class:"formgrid grid"},Fl={class:"col-12 md:col-4"},El={for:"individual",class:"label"},Bl=po((()=>(0,a._)("br",null,null,-1))),Nl={id:"individual",class:"text_field"},Zl=po((()=>(0,a._)("div",{class:"col-12 md:col-8"},null,-1))),jl={class:"field col-12 md:col-8"},Ml=po((()=>(0,a._)("label",{for:"payment_type",class:"label"},"назначение платежа",-1))),$l=po((()=>(0,a._)("br",null,null,-1))),Hl={id:"payment_type",class:"text_field lm"},ql=po((()=>(0,a._)("div",{class:"field col-12 md:col-4"},null,-1))),Kl={class:"field col-12 md:col-4"},zl=po((()=>(0,a._)("label",{for:"amount",class:"label"},"сумма",-1))),Ll=po((()=>(0,a._)("br",null,null,-1))),Gl={id:"amount",class:"text_field"},Jl={class:"field col-12 md:col-4"},Yl=po((()=>(0,a._)("label",{for:"tax",class:"label"},"оплата налога",-1))),Ql=po((()=>(0,a._)("br",null,null,-1))),Xl={id:"tax",class:"text_field"},es=po((()=>(0,a._)("div",{class:"field col-12 md:col-4"},null,-1))),ts=po((()=>(0,a._)("br",null,null,-1))),os={key:3};function ls(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("Divider"),c=(0,a.up)("Column"),r=(0,a.up)("Row"),u=(0,a.up)("ColumnGroup"),m=(0,a.up)("DataTable");return(0,a.wg)(),(0,a.iD)(a.HY,null,[ho,(0,a._)("div",_o,[(0,a._)("div",go,[(0,a._)("h4",null,(0,A.zw)(s.header),1)]),(0,a._)("div",fo,[(0,a._)("div",yo,[i.doc.doc_type===s.DocumentType.REQUEST_DOC?((0,a.wg)(),(0,a.iD)("div",bo,[(0,a.Wm)(n,{label:"Перемещение",class:"p-button-rounded p-button-secondary p-button-outlined",onClick:i.onRequestClick},null,8,["onClick"])])):(0,a.kq)("",!0),(0,a._)("div",vo,[(0,a.Wm)(n,{label:"Изменить",class:"p-button-sm p-button-rounded p-button-secondary",onClick:i.onUpdateClick,disabled:s.disableRedactoring},null,8,["onClick","disabled"])]),(0,a._)("div",null,[(0,a.Wm)(n,{label:"Копировать",class:"p-button-sm p-button-rounded p-button-secondary",onClick:i.onCopyClick},null,8,["onClick"])])])])]),i.doc.author?((0,a.wg)(),(0,a.iD)("div",Co,[(0,a._)("div",ko,[Do,(0,a._)("p",wo,(0,A.zw)(i.doc.author.name),1)]),(0,a._)("div",So,[To,(0,a._)("p",Po,(0,A.zw)(i.doc.project.name),1)]),Ao,i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Wo,[Vo,(0,a._)("p",Io,(0,A.zw)(i.doc.storage_from?i.doc.storage_from.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Ro,[xo,(0,a._)("p",Uo,(0,A.zw)(i.doc.storage_to?i.doc.storage_to.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",Oo)):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Fo,[Eo,(0,a._)("p",Bo,(0,A.zw)(i.doc.supplier?i.doc.supplier.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",No,[Zo,(0,a._)("p",jo,(0,A.zw)(i.doc.recipient?i.doc.recipient.name:""),1)])):(0,a.kq)("",!0),i.doc.doc_type==s.DocumentType.POSTING_DOC?((0,a.wg)(),(0,a.iD)("div",Mo)):(0,a.kq)("",!0)])):(0,a.kq)("",!0),i.doc.check_info?((0,a.wg)(),(0,a.iD)("div",$o,[(0,a.Wm)(d,{align:"left"},{default:(0,a.w5)((()=>[Ho])),_:1}),(0,a._)("div",qo,[(0,a._)("div",Ko,[zo,(0,a._)("p",Lo,(0,A.zw)(i.doc.check_info.waiter),1)]),(0,a._)("div",Go,[Jo,(0,a._)("p",Yo,(0,A.zw)(i.doc.check_info.check_number),1)]),(0,a._)("div",Qo,[Xo,(0,a._)("p",el,(0,A.zw)(i.doc.check_info.cash_register_number),1)]),(0,a._)("div",tl,[ol,(0,a._)("p",ll,(0,A.zw)(i.doc.check_info.amount_received),1)]),(0,a._)("div",sl,[al,(0,a._)("p",il,(0,A.zw)(i.doc.check_info.table_number),1)]),(0,a._)("div",nl,[dl,(0,a._)("p",cl,(0,A.zw)(i.doc.check_info.guest_number),1)]),(0,a._)("div",rl,[ul,(0,a._)("p",ml,(0,A.zw)(s.checkDate),1)]),pl,(0,a._)("div",hl,[_l,i.doc.check_info.is_return?((0,a.wg)(),(0,a.iD)("img",gl)):((0,a.wg)(),(0,a.iD)("img",fl))]),(0,a._)("div",yl,[bl,i.doc.check_info.is_KKM_checked?((0,a.wg)(),(0,a.iD)("img",vl)):((0,a.wg)(),(0,a.iD)("img",Cl))]),(0,a._)("div",kl,[Dl,i.doc.check_info.is_payed?((0,a.wg)(),(0,a.iD)("img",wl)):((0,a.wg)(),(0,a.iD)("img",Sl))]),(0,a._)("div",Tl,[Pl,i.doc.check_info.is_payed_by_card?((0,a.wg)(),(0,a.iD)("img",Al)):((0,a.wg)(),(0,a.iD)("img",Wl))]),(0,a._)("div",Vl,[Il,i.doc.check_info.is_delivery?((0,a.wg)(),(0,a.iD)("img",Rl)):((0,a.wg)(),(0,a.iD)("img",xl))])])])):(0,a.kq)("",!0),i.doc.doc_items?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Ul,[(0,a._)("div",Ol,[(0,a._)("div",Fl,[(0,a._)("label",El,(0,A.zw)(i.doc.doc_type==s.DocumentType.WITHDRAW_ORDER_DOC?"получатель":"плательщик"),1),Bl,(0,a._)("p",Nl,(0,A.zw)(i.getName(i.doc.individual)),1)]),Zl,(0,a._)("div",jl,[Ml,$l,(0,a._)("p",Hl,(0,A.zw)(i.doc.payment_type),1)]),ql,(0,a._)("div",Kl,[zl,Ll,(0,a._)("p",Gl,(0,A.zw)(i.doc.amount),1)]),(0,a._)("div",Jl,[Yl,Ql,(0,a._)("p",Xl,(0,A.zw)(i.doc.tax),1)]),es])])),ts,i.doc.doc_items?((0,a.wg)(),(0,a.iD)("div",os,[(0,a.Wm)(m,{value:i.doc.doc_items,editMode:"cell",class:"p-datatable-sm",responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{field:"item_name",header:"Наименование",key:"item_name"}),(0,a.Wm)(c,{field:"quantity",header:"Количество",key:"quantity"}),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{field:"quantity_fact",header:"Количество факт.",key:"quantity_fact"})):(0,a.kq)("",!0),(0,a.Wm)(c,{field:"price",header:"Цена",key:"price"}),(0,a.Wm)(c,{field:"amount",header:"Сумма",key:"price"}),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{field:"amount_fact",header:"Сумма факт.",key:"amount_fact"})):(0,a.kq)("",!0),s.isCheck?((0,a.wg)(),(0,a.j4)(c,{field:"discount",header:"Скидка",key:"discount"})):(0,a.kq)("",!0),(0,a.Wm)(u,{type:"footer"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{footer:"сумма:",colspan:s.colSpan,footerStyle:"text-align:right"},null,8,["colspan"]),(0,a.Wm)(c,{footer:i.totalAmount},null,8,["footer"]),s.isInventory?((0,a.wg)(),(0,a.j4)(c,{key:0,footer:i.totalAmountFact},null,8,["footer"])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["value"])])):(0,a.kq)("",!0)],64)}var ss={name:"Document",components:{DataTable:J.Z,Column:Y.Z,ColumnGroup:Jt.Z,Row:Yt.Z,Button:w.Z,Divider:Xt.Z},data(){return{header:"",checkDate:"",isInventory:!1,isCheck:!1,isPosting:!1,colSpan:3,DocumentType:lo,disableRedactoring:!1}},props:{docId:Number},emits:{openUpdateDoc:null,openCopyDoc:null,copyToRequestDoc:null},computed:{doc(){return this.$store.state.ds.document},totalAmount(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity-t.discount;return this.formatCurrency(e)},totalAmountFact(){let e=0;for(let t of this.doc.doc_items)e+=t.price*t.quantity_fact;return this.formatCurrency(e)}},methods:{getName(e){if(e)return e.name},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},onRequestClick(){this.$emit("copyToRequestDoc",this.doc)},onUpdateClick(){this.$emit("openUpdateDoc",this.doc)},onCopyClick(){this.$emit("openCopyDoc",this.doc)},setEnableRedactoring(e,t){this.disableRedactoring=e.id!=t.author.id&&"ADMIN"!=e.role}},mounted(){this.$store.dispatch("getDocument",[this.docId,""])},watch:{doc(e){let t="Документ "+e.doc_type+" № "+e.number+" от "+as(e.date_time);e.is_hold?t+=" (проведен)":e.is_deleted?t+=" (удален)":t+=" (не проведен)",this.header=t,e.check_info&&(this.checkDate=as(e.check_info.date_time,!0)),e.doc_type==lo.CHECK_DOC&&(this.isCheck=!0,this.colSpan++),e.doc_type==lo.INVENTORY_DOC&&(this.isInventory=!0,this.colSpan++);let o=JSON.parse(localStorage.getItem("user"));this.setEnableRedactoring(o,e)}}};function as(e,t){let o={day:"numeric",month:"numeric",year:"numeric"};return t&&(o.hour="numeric",o.minute="numeric",o.second="numeric"),e.toLocaleString("ru-Ru",o)}const is=(0,c.Z)(ss,[["render",ls],["__scopeId","data-v-28f1580a"]]);var ns=is;const ds={class:"main_menu"};function cs(e,t,o,l,s,i){const n=(0,a.up)("MegaMenu");return(0,a.wg)(),(0,a.iD)("div",ds,[(0,a.Wm)(n,{model:s.items,orientation:"vertical"},null,8,["model"])])}var rs=o(1447),us={name:"MainMenu",components:{MegaMenu:rs.Z},data(){return{items:[{label:"Документы",icon:"pi pi-fw pi-file",to:"/documents/posting"},{label:"Номенклатура",icon:"pi pi-fw pi-shopping-bag",to:"/items"},{label:"Пользователи",icon:"pi pi-fw pi-users",to:"/users"},{label:"Настройки",icon:"pi pi-fw pi-cog",to:"/settings"}]}}};const ms=(0,c.Z)(us,[["render",cs]]);var ps=ms;const hs={key:0,class:"name"};function _s(e,t,o,l,s,i){const n=(0,a.up)("Avatar");return s.user?((0,a.wg)(),(0,a.iD)("div",hs,[(0,a.Wm)(n,{label:s.label,class:"avatar mr-1",shape:"circle"},null,8,["label"]),(0,a.Uk)(" "+(0,A.zw)(s.user.first_name+" "+s.user.last_name+" ("+s.user.role+")"),1)])):(0,a.kq)("",!0)}var gs=o(396),fs={name:"LoginForm",components:{Avatar:gs.Z},data(){return{user:null,label:""}},watch:{},mounted(){this.user=JSON.parse(localStorage.getItem("user")),this.label=this.user.first_name.substring(0,1)},methods:{}};const ys=(0,c.Z)(fs,[["render",_s],["__scopeId","data-v-664c5a96"]]);var bs=ys,vs=o(6471),Cs=o(7791),ks=o(8832),Ds={name:"DocContent",components:{DataTable:J.Z,Column:Y.Z,Button:w.Z,Dialog:Q.Z,DocTabs:le,DocRedactor:ro,Document:ns,MainMenu:ps,UserAvatar:bs,Toolbar:vs.Z,OverlayPanel:Qt.Z,Menu:Cs.Z,Calendar:Lt.Z,RadioButton:ks.Z},props:{filter:String},data(){return{user:null,displayDocument:!1,docId:0,type:String,header:String,selectedProduct:null,showDialogHeader:!1,docRedactor:Boolean,docType:null,data:null,displayConfirmation:!1,displaySaveDialog:!1,holdLable:"",confirmationMessage:"",confirmationType:"",buttonNoEnabled:!0,deleteLable:"Удалить",firstDate:null,lastDate:null,DocumentType:lo,disabledHoldButton:!1,disabledSaveButton:!1,startPeriod:null,menuModel:[],salectedSaveTime:"dayEnd"}},computed:{documents(){return this.$store.state.ds.documents},document(){return this.$store.state.ds.document},success(){return this.$store.state.success},docTypes(){return this.$store.state.cs.docTypes},startDate(){return this.$store.state.ds.startDate},endDate(){return this.$store.state.ds.endDate},exsistNotHoldenDocs(){return this.$store.state.ds.exsistNotHoldenDocs},period(){return this.$store.state.ss.period}},mounted(){this.firstDate=this.$store.state.ds.startDate,this.lastDate=this.$store.state.ds.endDate,this.$store.dispatch("getDocuments",this.filter),this.user=JSON.parse(localStorage.getItem("user")),this.period&&(this.startPeriod=new Date(this.period.start_date)),this.salectedSaveTime="dayEnd"},watch:{period(e){this.startPeriod=new Date(e.start_date)},filter(e){this.$store.dispatch("getDocuments",e)},success(){this.$store.dispatch("getDocuments",this.filter)},document(e){this.holdLable=e.is_hold?"Отменить проведение":e.doc_type==this.DocumentType.MOVEMENT_DOC?"Подтвердить получение":"Провести",e.date_time<this.startPeriod?(this.disabledHoldButton=!0,this.disabledSaveButton=!0):(this.disabledHoldButton=!1,this.disabledSaveButton=!1)},confirmationType(e){this.buttonNoEnabled=!0,"hold"==e?this.confirmationMessage="Провести документ?":"save"==e?this.confirmationMessage="save":"delete"==e?this.confirmationMessage="Удалить документ?":"unDelete"==e?this.confirmationMessage="Отменить удаление документа?":"price"==e?(this.buttonNoEnabled=!1,this.confirmationMessage="Для проведения заполните все цены в документе"):"serialHold"==e?1==this.document.is_hold?this.confirmationMessage="После этого документа есть другие проведенные документы. Отменить их проведение?":this.confirmationMessage="Есть более ранние не проведенные документы. Провести их?":"choseTime"==e&&(this.confirmationMessage="Выберете время сохранения документа")},startDate(e){this.firstDate=e},endDate(e){this.lastDate=e},exsistNotHoldenDocs(){this.confirmationType="serialHold",this.displayConfirmation=!0},type(e){this.salectedSaveTime="update"==e?"currentTime":"dayEnd"}},methods:{aaa(){this.$store.dispatch("getAAA")},getName(e){if(e)return e.name},iconClass(e){let t,o;return e.is_hold?(t="pi-check-circle",o="true-icon"):e.is_hold||(t="pi-circle",o="neutral-icon"),e.is_deleted&&(t="pi-times-circle",o="false-icon"),e.date_time<this.startPeriod&&(o="disabled"),o+" "+t},disabledClass(e){return e.date_time<this.startPeriod?"disabled":null},disableHoldButton(){this.disabledHoldButton=!0},disableSaveButton(e){this.disabledSaveButton=e},setStartDate(e){this.$store.dispatch("setStartDate",e)},setEndDate(e){this.$store.dispatch("setEndDate",e)},getToolTipText(e){return e.is_hold?"проведен":e.is_deleted?"удален":"не проведен"},toggleModalMenu(e,t){this.data=t,this.menuModel=[];let o={label:"Копировать",icon:"pi pi-copy",command:()=>{this.openCopyDocumentRedactor(this.data)}};if(this.menuModel.push(o),("ADMIN"==this.user.role||t.author.id==this.user.id)&&t.date_time>=this.startPeriod){let e={label:"Изменить",icon:"pi pi-pencil",command:()=>this.openUpdateDocumentRedactor(this.data)};this.menuModel.push(e);let o="";t.is_deleted?(o="Отменить",this.confirmationType="unDelete"):(o="Удалить",this.confirmationType="delete");let l={label:o,icon:"pi pi-times",command:()=>this.openConfirmation(t)};this.menuModel.push(l)}this.$refs.menu.toggle(e)},formatCurrency(e){return e.toLocaleString("re-RU",{style:"currency",currency:"RUB"})},deleteDocument(){this.$store.dispatch("deleteDocument",this.data),this.closeConfirmation()},openDocument(e){this.docRedactor=!1,this.docId=e.data.id,this.displayDocument=!0},openNewDocument(e){this.docRedactor=!0,this.docType=e,this.docId=0,this.type="add",this.displayDocument=!0},openRequestDocRedactor(e){this.docRedactor=!0,this.docType=this.DocumentType.REQUEST_DOC,this.docId=e.id,this.type="copyToRequestDoc",this.displayDocument=!0},openUpdateDocumentRedactor(e){this.docRedactor=!0,this.docId=e.id,this.type="update",this.displayDocument=!0},openCopyDocumentRedactor(e){this.docRedactor=!0,this.docId=e.id,this.type="copy",this.displayDocument=!0},closeDocument(){this.displayDocument=!1},choseSavingTime(){this.confirmationType="choseTime",this.displayConfirmation=!0},saveDocument(){this.displaySaveDialog=!1,"update"==this.type?this.$store.dispatch("updateDocument",[this.document,this.salectedSaveTime]):(this.document.id=0,this.$store.dispatch("addDocument",[this.document,this.salectedSaveTime])),0==this.document.is_hold?(this.confirmationType="hold",this.displayConfirmation=!0):this.displayDocument=!1},serialHoldDocument(){this.$store.dispatch("serialHoldDocument",this.document.id),this.displayConfirmation=!1},holdDocument(){this.displayConfirmation=!1,this.checkPrices()?(this.$store.dispatch("holdDocument",this.document.id),this.displayDocument=!1):(this.confirmationType="price",this.displayConfirmation=!0)},checkPrices(){if(this.document.doc_type==this.DocumentType.INVENTORY_DOC)for(let e of this.document.doc_items)if(0==e.price)return!1;return!0},logout(){this.$store.dispatch("logout")},chooseDocType(e){this.$refs.opDocTypes.toggle(e)},addNewDocByType(e){this.openNewDocument(e),this.$refs.opDocTypes.hide()},openConfirmation(e){this.data=e,this.displayConfirmation=!0},closeConfirmation(){this.displayConfirmation=!1,this.displayDocument=!1,this.confirmationType=""},positiveConfirmation(){"delete"==this.confirmationType||"unDelete"==this.confirmationType?this.deleteDocument():"hold"==this.confirmationType?this.holdDocument():"serialHold"==this.confirmationType?this.serialHoldDocument():this.displayConfirmation=!1,this.confirmationType=""},openSaveDocDialog(){this.displaySaveDialog=!0},closeSaveDocDialog(){this.displaySaveDialog=!1},resetDocuments(){this.$store.dispatch("getDocuments",this.filter)}}};const ws=(0,c.Z)(Ds,[["render",G],["__scopeId","data-v-70e92e46"]]);var Ss=ws;const Ts={class:"conteiner"};function Ps(e,t,o,l,s,i){const n=(0,a.up)("UserAvatar"),d=(0,a.up)("Button"),c=(0,a.up)("Toolbar"),r=(0,a.up)("MainMenu"),u=(0,a.up)("ItemTree"),m=(0,a.up)("ItemForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"top-menu"},{end:(0,a.w5)((()=>[(0,a.Wm)(n),(0,a.Wm)(d,{label:"logout",onClick:t[0]||(t[0]=e=>i.logout()),class:"p-button-sm p-button-rounded"})])),_:1}),(0,a._)("div",Ts,[(0,a.Wm)(r),(0,a.Wm)(u),(0,a.Wm)(m)])],64)}const As={class:"tree"};function Ws(e,t,o,l,s,i){const n=(0,a.up)("Tree");return(0,a.wg)(),(0,a.iD)("div",As,[(0,a.Wm)(n,{value:i.nodes,expandedKeys:i.expandedKeys,selectionMode:"single",selectionKeys:s.selectedKey,"onUpdate:selectionKeys":t[0]||(t[0]=e=>s.selectedKey=e),metaKeySelection:!1,onNodeCollapse:i.onNodeCollapse,onNodeExpand:i.onNodeExpand,onNodeSelect:i.onNodeSelect},null,8,["value","expandedKeys","selectionKeys","onNodeCollapse","onNodeExpand","onNodeSelect"])])}var Vs=o(582),Is={name:"ItemTree",components:{Tree:Vs.Z},data(){return{selectedKey:null,parentNode:null}},computed:{nodes(){return this.$store.state.is.itemTree},expandedKeys(){let e=this.$store.state.is.expandedKeys;return e}},mounted(){this.$store.dispatch("getItemTree")},methods:{onNodeSelect(e){e.is_node?this.$store.dispatch("setParentNode",e):(this.$store.dispatch("getItem",e.data),this.$store.dispatch("delCrumbs"))},onNodeExpand(e){e.is_node&&(e.icon="pi pi-fw pi-folder-open",this.$store.dispatch("setParentNode",e))},onNodeCollapse(e){e.is_node&&(e.icon="pi pi-fw pi-folder")}}};const Rs=(0,c.Z)(Is,[["render",Ws],["__scopeId","data-v-4e89d22d"]]);var xs=Rs;const Us=e=>((0,a.dD)("data-v-10df94aa"),e=e(),(0,a.Cn)(),e),Os={class:"itemform"},Fs=["onClick"],Es={class:"header"},Bs={class:"formgrid grid form"},Ns={class:"field col-12 md:col-12"},Zs={class:"p-float-label"},js={class:"field col-12 md:col-6"},Ms={class:"p-float-label"},$s=Us((()=>(0,a._)("label",{for:"itemname"},"Наименование",-1))),Hs={class:"field col-12 md:col-6"},qs={class:"p-float-label"},Ks=Us((()=>(0,a._)("label",{for:"printname"},"Наименование для печати",-1))),zs={class:"field col-12 md:col-6"},Ls={class:"p-inputgroup longinput"},Gs=Us((()=>(0,a._)("span",{class:"p-inputgroup-addon"},".00",-1))),Js={class:"field col-12 md:col-6"},Ys={class:"p-inputgroup longinput"},Qs=Us((()=>(0,a._)("span",{class:"p-inputgroup-addon"},".00",-1))),Xs={class:"field col-12 md:col-6"},ea={id:"aaa",class:"p-inputgroup longinput"},ta={class:"field col-12 md:col-6"},oa={class:"p-inputgroup longinput"},la=Us((()=>(0,a._)("br",null,null,-1))),sa={class:"col-12 md:col-6"},aa={class:"checkBox"},ia={class:"checkBoxLabel"},na=Us((()=>(0,a._)("label",{for:"garnish"},"Является гарнирниром ",-1))),da={class:"checkBoxLabel"},ca=Us((()=>(0,a._)("label",{for:"garnish"},"Включает гарнир ",-1))),ra={class:"checkBoxLabel"},ua=Us((()=>(0,a._)("label",{for:"weight"},"Весовой ",-1))),ma={class:"checkBoxLabel"},pa=Us((()=>(0,a._)("label",{for:"alcohol"},"Алкоголь ",-1))),ha={class:"col-12 md:col-6"},_a={class:"checkBox"},ga={class:"checkBoxLabel"},fa=Us((()=>(0,a._)("label",{for:"garnish"},"Является соусом ",-1))),ya={class:"checkBoxLabel"},ba=Us((()=>(0,a._)("label",{for:"includgarnish"},"Включает соус ",-1))),va={class:"checkBoxLabel"},Ca=Us((()=>(0,a._)("label",{for:"employeeMenu"},"Не для сотрудников ",-1))),ka={class:"checkBoxLabel"},Da=Us((()=>(0,a._)("label",{for:"notInPriceList"},"Не отображать ",-1))),wa={class:"field col-12 md:col-12"},Sa={class:"col-12 md:col-6"},Ta={class:"p-float-label"},Pa=Us((()=>(0,a._)("label",{for:"comment"},"Комментарий",-1))),Aa={class:"col-12 md:col-12",style:{"text-align":"end"}};function Wa(e,t,o,l,s,i){const n=(0,a.up)("Breadcrumb"),d=(0,a.up)("Button"),c=(0,a.up)("Calendar"),r=(0,a.up)("InputText"),u=(0,a.up)("Checkbox"),m=(0,a.up)("IngredientTable"),p=(0,a.up)("Textarea"),h=(0,a.up)("Column"),_=(0,a.up)("DataTable"),g=(0,a.up)("OverlayPanel"),f=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",Os,[(0,a.Wm)(n,{home:s.homeCrumb,model:i.crumbs},{item:(0,a.w5)((({item:e})=>[(0,a._)("span",{onClick:t=>i.onCrumbClick(e),class:"crumb"},(0,A.zw)(e.label),9,Fs)])),_:1},8,["home","model"]),(0,a._)("div",Es,[(0,a.Wm)(d,{label:"Новая номенклатура",onClick:i.addNewItem,class:"p-button-rounded p-button-secondary p-button-sm"},null,8,["onClick"])]),(0,a._)("div",Bs,[(0,a._)("div",Ns,[(0,a._)("span",Zs,[(0,a.Wm)(c,{modelValue:s.formDate,"onUpdate:modelValue":t[0]||(t[0]=e=>s.formDate=e),onDateSelect:i.setDate,class:"longinput",showIcon:!0,showButtonBar:!0,dateFormat:"dd.mm.yy"},null,8,["modelValue","onDateSelect"])])]),(0,a._)("div",js,[(0,a._)("span",Ms,[(0,a.Wm)(r,{id:"itemname",class:"longinput",onChange:i.setPrintName,type:"text",modelValue:i.item.name,"onUpdate:modelValue":t[1]||(t[1]=e=>i.item.name=e)},null,8,["onChange","modelValue"]),$s])]),(0,a._)("div",Hs,[(0,a._)("span",qs,[(0,a.Wm)(r,{id:"printname",class:"longinput",type:"text",modelValue:i.item.print_name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.item.print_name=e)},null,8,["modelValue"]),Ks])]),(0,a._)("div",zs,[(0,a._)("div",Ls,[(0,a.Wm)(r,{modelValue:s.retailPrice,"onUpdate:modelValue":t[3]||(t[3]=e=>s.retailPrice=e),placeholder:"Цена",onChange:t[4]||(t[4]=e=>i.setPrice(e,"RETAIL")),style:{"text-align":"end"}},null,8,["modelValue"]),Gs])]),(0,a._)("div",Js,[(0,a._)("div",Ys,[(0,a._)("span",{class:"p-inputgroup-addon",onClick:t[5]||(t[5]=(...e)=>i.calculateDeliveryPrice&&i.calculateDeliveryPrice(...e))},"+"),(0,a.Wm)(r,{modelValue:s.deliveryPrice,"onUpdate:modelValue":t[6]||(t[6]=e=>s.deliveryPrice=e),placeholder:"Цена на доставку",onChange:t[7]||(t[7]=e=>i.setPrice(e,"DELIVERY")),style:{"text-align":"end"}},null,8,["modelValue"]),Qs])]),(0,a._)("div",Xs,[(0,a._)("div",ea,[(0,a.Wm)(r,{id:"unit",type:"text",placeholder:"Еденица",modelValue:s.selectedUnit.name,"onUpdate:modelValue":t[8]||(t[8]=e=>s.selectedUnit.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onUnitClick},null,8,["onClick"])])]),(0,a._)("div",ta,[(0,a._)("div",oa,[(0,a.Wm)(r,{id:"workshop",type:"text",placeholder:"Цех",modelValue:s.selectedWorkshop.name,"onUpdate:modelValue":t[9]||(t[9]=e=>s.selectedWorkshop.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onWorkshopClick},null,8,["onClick"])])]),la,(0,a._)("div",sa,[(0,a._)("div",aa,[(0,a._)("span",ia,[na,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_garnish,"onUpdate:modelValue":t[10]||(t[10]=e=>i.item.is_garnish=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",da,[ca,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_include_garnish,"onUpdate:modelValue":t[11]||(t[11]=e=>i.item.is_include_garnish=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ra,[ua,(0,a.Wm)(u,{id:"weight",modelValue:i.item.is_weight,"onUpdate:modelValue":t[12]||(t[12]=e=>i.item.is_weight=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ma,[pa,(0,a.Wm)(u,{id:"alcohol",modelValue:i.item.is_alcohol,"onUpdate:modelValue":t[13]||(t[13]=e=>i.item.is_alcohol=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",ha,[(0,a._)("div",_a,[(0,a._)("span",ga,[fa,(0,a.Wm)(u,{id:"garnish",modelValue:i.item.is_sauce,"onUpdate:modelValue":t[14]||(t[14]=e=>i.item.is_sauce=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ya,[ba,(0,a.Wm)(u,{id:"includgarnish",modelValue:i.item.is_include_sauce,"onUpdate:modelValue":t[15]||(t[15]=e=>i.item.is_include_sauce=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",va,[Ca,(0,a.Wm)(u,{id:"employeeMenu",modelValue:i.item.is_not_in_employee_menu,"onUpdate:modelValue":t[16]||(t[16]=e=>i.item.is_not_in_employee_menu=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",ka,[Da,(0,a.Wm)(u,{id:"notInPriceList",modelValue:i.item.is_not_in_price_list,"onUpdate:modelValue":t[17]||(t[17]=e=>i.item.is_not_in_price_list=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",wa,[(0,a.Wm)(m)]),(0,a._)("div",Sa,[(0,a._)("span",Ta,[(0,a.Wm)(p,{id:"comment",class:"textinput",modelValue:i.item.comment,"onUpdate:modelValue":t[18]||(t[18]=e=>i.item.comment=e),rows:"4",cols:"30"},null,8,["modelValue"]),Pa])]),(0,a._)("div",Aa,[(0,a.Wm)(d,{label:"Калькуляция",onClick:i.getCalculation,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"]),(0,a.Wm)(d,{label:"Сохранить",onClick:i.onSave,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"])])])])]),(0,a.Wm)(g,{ref:"opUnits"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.units,selection:s.selectedUnit,"onUpdate:selection":t[19]||(t[19]=e=>s.selectedUnit=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onUnitSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(g,{ref:"opWorkshops"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{value:i.workshops,selection:s.selectedWorkshop,"onUpdate:selection":t[20]||(t[20]=e=>s.selectedWorkshop=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onWorkshopsSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(f,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[21]||(t[21]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(d,{label:"Да",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h4",null,(0,A.zw)(s.confirmationMessage),1)])),_:1},8,["visible"])],64)}var Va="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAOBJREFUOI3tzj1KQ2EQheH3zA2EVEF7F6BIuhQBQayCa/BnGSnjYBqt7AQ7RdyBgqWCGrBUzAas1aTKvYV3bGwTEvwKi5xyzvBwBLDnvh7BMaJFsIQoCN4VOr08PDhhjmT77o0InoFVoPZ7rwDLiHZjcyt/ub97nBXUjvutgvaUnzzgYVJp4iNK9SsWZ+fuuXbdhwT1WRdMyaAsqhuWCANYs2pxZIkwACS2k4IRrCQFARbgvwTFKKE3NIJ+QvDJorQOkP+ZEuOstI5d9bqvEk3EDeJrfodPwXX2bc2LXvftBxf8Q0mmDF6vAAAAAElFTkSuQmCC",Ia="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAArZJREFUOI2VlD9ME2EYxn/fXS/edSwGAf9F26iBQEgIFrpIo4O2op27MRA0EkOBQRNdjCYSwEpEjHEwMdGFRRMpjl1EiyH8CwOJOBiVFpFJuMNr+Ry0pZQ20We75837u++e+95XUETDPt9hRyYTllKeR4gjwF5gFfgEvFbS6RcdU1OfC/tE/sPTlhbd3Ni4I+AKQuwp9iIApNyUQjwwDONmWzxu7YI98Xr32fBKgLckpJAJCQ0uticSqRzsXnOzYWxtxYGT/wrK03vdMPxt8bilAOiZzO0sSNU0qkMhXG530U6X2011KISqaVmradM0bwGowz7fYWVr6xlCOABOtLZy6vp1jgUCJGdn+ZlM5kCV9fVcGBnhqN/Pz1SK1cXFbKkhUFX1THFkMuH8sFcWFrBNE80wCESjVNbX50CBaBTNMLBNk5WFhfwD60JVw2rwwIG7wKGsa66tsTw9jfv0aTSnE8+ZM/xaX8d/4waa00nasnjT20tqJwwBe8Qjr3cZqCjMpqKujuD9+2hOZ85LWxbjPT18nZoqFuc3BXAVqyTn5ng/PAxS5rwPjx+XAgHsVYAfxSoVdXU0dXaC2L7XjR0d7G9oKAX7rkhYKgbKfmLasng7OIi9sYFD1zk3OFgKuKQIGMt3yjwegkNDaE4ntmky1tXF/Ogose5ubNPEoeucHRigzOPZQZJCxBQlnX4B5OarvKYm9/tjkQjLMzMALM/MEItEctemvKYmn2VpUj4XACNeb7+AXvgzAceDQZLz86wt7UoAl9tNRW0ti2NjZGwbACFl36XJyWsC/m4L04z/z5Dn6Z3tcvmvjo9v7tgaaXgJNP0PCFUNXZ6YWAFQsm57IpHSDcMvoJ+8DEvIElL22S6XPwuCguWY1cPGxoNCVcNCyiDgZnvTfpRCxDQpn7cnEl8K+34Dd//+RzdHdrMAAAAASUVORK5CYII=";const Ra=e=>((0,a.dD)("data-v-5995ceed"),e=e(),(0,a.Cn)(),e),xa={class:"ingrHeader"},Ua=Ra((()=>(0,a._)("div",null,"Ингредиенты",-1))),Oa={class:"border contentRight"},Fa=["onClick"],Ea=["onClick"],Ba=["onClick"],Na=Ra((()=>(0,a._)("div",{class:"flex justify-content-center"},[(0,a._)("i",{class:"pi pi-spin pi-spinner",style:{"font-size":"2rem"}})],-1))),Za=Ra((()=>(0,a._)("br",null,null,-1)));function ja(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("Column"),c=(0,a.up)("InputText"),r=(0,a.up)("DataTable"),u=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",xa,[Ua,(0,a._)("div",null,[(0,a.Wm)(n,{icon:"pi pi-plus",onClick:i.addNewIngredient,class:"p-button-text p-button-rounded"},null,8,["onClick"])])]),(0,a._)("div",Oa,[(0,a.Wm)(r,{value:this.ingredients,editMode:"cell",onCellEditComplete:i.onCellEditComplete,class:"p-datatable-sm editable-cells-table"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{style:{width:"2.2rem"}},{body:(0,a.w5)((({data:e})=>[(0,a._)("img",{onClick:t=>i.onIngredientClick(e),src:Va},null,8,Fa)])),_:1}),(0,a.Wm)(d,{field:"name",header:"Наименование"}),(0,a.Wm)(d,{field:"gross.quantity",header:"Брутто"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(c,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(d,{field:"netto.quantity",header:"Нетто"},{editor:(0,a.w5)((({data:e,field:t})=>[(0,a.Wm)(c,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,a.Wm)(d,{style:{width:"3rem"}},{body:(0,a.w5)((({data:e})=>[1==e.enable.quantity?((0,a.wg)(),(0,a.iD)("img",{key:0,onClick:t=>i.toogleDeleted(e),src:uo},null,8,Ea)):((0,a.wg)(),(0,a.iD)("img",{key:1,onClick:t=>i.toogleDeleted(e),src:Ia},null,8,Ba))])),_:1})])),_:1},8,["value","onCellEditComplete"])]),(0,a.Wm)(u,{header:"Подбор номенклатуры",class:"border",visible:s.displayItems,"onUpdate:visible":t[3]||(t[3]=e=>s.displayItems=e),modal:!0,closable:!1,contentStyle:{height:"100%"},style:{width:"900px",height:"500px"}},{header:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(c,{class:"p-inputtext-sm mr-2",modelValue:s.filters["global"].value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.filters["global"].value=e),placeholder:"поиск",autofocus:""},null,8,["modelValue"]),(0,a.Wm)(n,{icon:"pi pi-times",class:"p-button-rounded p-button-text p-button-plain p-button-sm",onClick:i.clearFilter},null,8,["onClick"])])])),footer:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"закрыть",icon:"pi pi-times",onClick:i.closeDialog,class:"p-button-text p-button-sm"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(r,{value:i.items,class:"p-datatable-sm",selection:s.selectedItem,"onUpdate:selection":t[1]||(t[1]=e=>s.selectedItem=e),selectionMode:"single",filters:s.filters,"onUpdate:filters":t[2]||(t[2]=e=>s.filters=e),filterDisplay:"menu",globalFilterFields:["name"],onRowSelect:i.onItemSelect,scrollable:!1,loading:s.loading},{loading:(0,a.w5)((()=>[Na])),default:(0,a.w5)((()=>[(0,a.Wm)(d,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","filters","onRowSelect","loading"]),Za])),_:1},8,["visible"])],64)}var Ma={name:"IngredientTable",components:{DataTable:J.Z,Column:Y.Z,Button:w.Z,Dialog:Q.Z,InputText:k.Z},data(){return{filters:[],selectedItem:null,loading:!1,displayItems:!1}},created(){this.initFilters()},mounted(){this.$store.dispatch("getItems")},computed:{items(){return this.$store.state.cs.items},ingredients(){return this.$store.state.is.ingredients},itemDate(){return this.$store.state.is.itemDate},storages(){return this.$store.state.cs.storages}},watch:{items(){this.loading=!1}},methods:{initFilters(){this.filters={global:{value:null,matchMode:eo.a6.CONTAINS},name:{operator:eo.pg.AND,constraints:[{value:null,matchMode:eo.a6.STARTS_WITH}]}}},clearFilter(){this.initFilters()},onIngredientClick(e){let t=this.$store.state.is.item,o={label:t.name,id:t.id};this.$store.dispatch("addCrumb",o),this.$store.dispatch("expandNodes",e.child_id),this.$store.dispatch("getItem",e.child_id)},toogleDeleted(e){e.enable.quantity=1==e.enable.quantity?0:1;let t=$a(this.itemDate).getTime();e.enable.date!=t&&(e.enable.id=0,e.enable.date=t)},addNewIngredient(){this.displayItems=!0},onItemSelect(e){this.displayItems=!1,this.addItem(e.data)},addItem(e){this.$store.dispatch("addIngredient",e)},onCellEditComplete(e){let{data:t,newValue:o,field:l}=e,s=l.split(".");t[s[0]].quantity=o;let a=$a(this.itemDate).getTime();t[s[0]].date!=a&&(t[s[0]].id=0,t[s[0]].date=a)},closeDialog(){this.displayItems=!1,this.clearFilter()}}};function $a(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}const Ha=(0,c.Z)(Ma,[["render",ja],["__scopeId","data-v-5995ceed"]]);var qa=Ha,Ka=o(5876),za=o(1958),La=o(7998),Ga={name:"ItemForm",components:{IngredientTable:qa,Calendar:Lt.Z,InputText:k.Z,Checkbox:Ka.Z,Textarea:za.Z,Button:w.Z,Column:Y.Z,OverlayPanel:Qt.Z,DataTable:J.Z,Dialog:Q.Z,Breadcrumb:La.Z},data(){return{displayConfirmation:!1,selectedUnit:{name:"---"},selectedWorkshop:{name:"---"},retailPrice:"",deliveryPrice:"",confirmationMessage:"",formDate:new Date,homeCrumb:{icon:"pi pi-inbox",to:"/items"}}},computed:{workshops(){return this.$store.state.cs.workshops},units(){return this.$store.state.cs.units},item(){return this.$store.state.is.item},parentNode(){return this.$store.state.is.parentNode},itemDate(){return this.$store.state.is.itemDate},crumbs(){return this.$store.state.is.crumbs}},methods:{getCalculation(){this.$store.dispatch("getCalculation",this.item.id)},setPrintName(){this.item.print_name=this.item.name},setDate(e){this.$store.dispatch("setDate",e)},addNewItem(){this.$store.dispatch("getItem",0)},calculateDeliveryPrice(){this.deliveryPrice=10*Math.ceil(1.2*this.retailPrice/10),this.setPrice(this.deliveryPrice,"DELIVERY")},onUnitClick(e){this.$refs.opUnits.toggle(e)},onWorkshopClick(e){this.$refs.opWorkshops.toggle(e)},onCrumbClick(e){this.$store.dispatch("delCrumb",e),this.$store.dispatch("expandNodes",e.id),this.$store.dispatch("getItem",e.id)},onUnitSelect(e){this.item.unit=this.selectedUnit,this.$refs.opUnits.toggle(e)},onWorkshopsSelect(e){this.item.workshop=this.selectedWorkshop,this.$refs.opWorkshops.toggle(e)},saveItem(){this.item.parent_id=this.parentNode.data,this.$store.dispatch("saveItem",[this.item,this.formDate])},closeConfirmation(){this.displayConfirmation=!1},positiveConfirmation(){this.saveItem(),this.displayConfirmation=!1},onSave(){this.confirmationMessage="Сохранить "+this.item.name+" в "+this.parentNode.label+"?",this.displayConfirmation=!0},setPrice(e,t){e.target&&(e=e.target._value);let o=!1;for(let l=0;l<this.item.prices.length;l++)this.item.prices[l].type===t&&(this.item.prices[l]=new Ja(this.formDate.getTime(),e,t),o=!0);o||this.item.prices.push(new Ja(this.formDate.getTime(),e,t))}},watch:{item(e){this.selectedUnit=e.unit,this.selectedWorkshop=e.workshop,this.retailPrice="",this.deliveryPrice="";for(let t of e.prices)"RETAIL"===t.type&&(this.retailPrice=t.value),"DELIVERY"===t.type&&(this.deliveryPrice=t.value)},itemDate(e){this.formDate=e}},mounted(){this.$store.dispatch("getItem",0)}};class Ja{constructor(e,t,o){(0,zt.Z)(this,"value",0),(0,zt.Z)(this,"type",""),(0,zt.Z)(this,"date",""),this.date=e,this.value=t,this.type=o}}const Ya=(0,c.Z)(Ga,[["render",Wa],["__scopeId","data-v-10df94aa"]]);var Qa=Ya,Xa={name:"ItemContent",components:{ItemTree:xs,ItemForm:Qa,MainMenu:ps,Toolbar:vs.Z,Button:w.Z,UserAvatar:bs},data(){return{}},computed:{},methods:{logout(){this.$store.dispatch("logout")}}};const ei=(0,c.Z)(Xa,[["render",Ps],["__scopeId","data-v-64999a91"]]);var ti=ei;const oi=e=>((0,a.dD)("data-v-18e25d62"),e=e(),(0,a.Cn)(),e),li={class:"conteiner"},si={class:"content"},ai={key:0,class:"formgrid grid"},ii={class:"col-12 md:col-4"},ni=oi((()=>(0,a._)("label",{for:"project",class:"label"},"Проект",-1))),di=oi((()=>(0,a._)("br",null,null,-1))),ci={class:"p-inputgroup"},ri={class:"col-12 md:col-4"},ui=oi((()=>(0,a._)("label",{for:"storageFrom",class:"label"},"со склада",-1))),mi=oi((()=>(0,a._)("br",null,null,-1))),pi={class:"p-inputgroup"},hi={class:"col-12 md:col-4"},_i=oi((()=>(0,a._)("label",{for:"storageTo",class:"label"},"на склад",-1))),gi=oi((()=>(0,a._)("br",null,null,-1))),fi={class:"p-inputgroup"},yi={class:"formgrid grid leftAlignment"},bi={class:"col-12 md:col-6"},vi={class:"col-12 md:col-6"},Ci=oi((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),ki=oi((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При закрытии периода переносить остатки по средней цене")],-1))),Di={class:"col-12 md:col-6"},wi={class:"formgrid grid leftAlignment"},Si=oi((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При проведении документов из 1С не добавлять недостающие позиции (списывать только из наличия) ")],-1))),Ti={class:"col-12 md:col-6"},Pi=oi((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),Ai=oi((()=>(0,a._)("div",{class:"col-12 md:col-6"},[(0,a._)("span",null,"При проведении документов списания и перемещения персчитывать стоимость позиций в соответствии со списываемыми партиями")],-1))),Wi={class:"col-12 md:col-6"},Vi=oi((()=>(0,a._)("div",{class:"col-12 md:col-12"},[(0,a._)("p")],-1))),Ii={class:"col-12 md:col-6"},Ri={class:"col-12 md:col-6"};function xi(e,t,o,l,s,i){const n=(0,a.up)("UserAvatar"),d=(0,a.up)("Button"),c=(0,a.up)("Toolbar"),r=(0,a.up)("MainMenu"),u=(0,a.up)("InputText"),m=(0,a.up)("AccordionTab"),p=(0,a.up)("InputSwitch"),h=(0,a.up)("Accordion"),_=(0,a.up)("Column"),g=(0,a.up)("DataTable"),f=(0,a.up)("OverlayPanel");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"top-menu"},{end:(0,a.w5)((()=>[(0,a.Wm)(n),(0,a.Wm)(d,{label:"logout",onClick:t[0]||(t[0]=e=>i.logout()),class:"p-button-sm p-button-rounded"})])),_:1}),(0,a._)("div",li,[(0,a.Wm)(r),(0,a._)("div",si,[(0,a.Wm)(h,{activeIndex:s.activeIndex,"onUpdate:activeIndex":t[7]||(t[7]=e=>s.activeIndex=e),onTabOpen:i.setDefaultProperties},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{header:"Реквизиты документов по умолчанию"},{default:(0,a.w5)((()=>[s.defaultProject?((0,a.wg)(),(0,a.iD)("div",ai,[(0,a._)("div",ii,[ni,di,(0,a._)("div",ci,[(0,a.Wm)(u,{id:"project",type:"text",class:"p-inputtext-sm",modelValue:s.defaultProject.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.defaultProject.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),(0,a._)("div",ri,[ui,mi,(0,a._)("div",pi,[(0,a.Wm)(u,{id:"storageFrom",type:"text",class:"p-inputtext-sm",modelValue:s.defaultStorageFrom.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.defaultStorageFrom.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageFromClick},null,8,["onClick"])])]),(0,a._)("div",hi,[_i,gi,(0,a._)("div",fi,[(0,a.Wm)(u,{id:"storageTo",type:"text",class:"p-inputtext-sm",modelValue:s.defaultStorageTo.name,"onUpdate:modelValue":t[3]||(t[3]=e=>s.defaultStorageTo.name=e)},null,8,["modelValue"]),(0,a.Wm)(d,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onStorageToClick},null,8,["onClick"])])])])):(0,a.kq)("",!0)])),_:1}),s.isAdmin?((0,a.wg)(),(0,a.j4)(m,{key:0,header:"Безвозвратное удаление документов"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"Удалить помеченные на удаление документы",onClick:i.deleteDocs,class:"p-button-sm p-button-text"},null,8,["onClick"])])),_:1})):(0,a.kq)("",!0),s.isAdmin?((0,a.wg)(),(0,a.j4)(m,{key:1,header:"Закрытие периода"},{default:(0,a.w5)((()=>[(0,a._)("div",yi,[(0,a._)("div",bi,[(0,a._)("span",null,(0,A.zw)(s.periodString),1)]),(0,a._)("div",vi,[(0,a.Wm)(d,{label:"Да",onClick:i.closePeriod,class:"p-button-secondary p-button-rounded p-button-sm"},null,8,["onClick"])]),Ci,ki,(0,a._)("div",Di,[(0,a.Wm)(p,{modelValue:s.averagePriceForPeriodClose,"onUpdate:modelValue":t[4]||(t[4]=e=>s.averagePriceForPeriodClose=e),onClick:i.setAveragePriceForPeriodClose},null,8,["modelValue","onClick"])])])])),_:1})):(0,a.kq)("",!0),s.isAdmin?((0,a.wg)(),(0,a.j4)(m,{key:2,header:"Настройки проведения документов"},{default:(0,a.w5)((()=>[(0,a._)("div",wi,[Si,(0,a._)("div",Ti,[(0,a.Wm)(p,{modelValue:s.addShortageForHold,"onUpdate:modelValue":t[5]||(t[5]=e=>s.addShortageForHold=e),onClick:i.setAddShortageForHold},null,8,["modelValue","onClick"])]),Pi,Ai,(0,a._)("div",Wi,[(0,a.Wm)(p,{modelValue:s.averagePriceForDocs,"onUpdate:modelValue":t[6]||(t[6]=e=>s.averagePriceForDocs=e),onClick:i.setAveragePriceForDocs},null,8,["modelValue","onClick"])]),Vi,(0,a._)("div",Ii,[(0,a._)("span",null,"Ручное проведение документов из 1С. Есть не проведенные чеки от: "+(0,A.zw)(i.unholdenCheckDate),1)]),(0,a._)("div",Ri,[(0,a.Wm)(d,{label:"Провести документы",onClick:i.hold1CDocs,class:"p-button-secondary p-button-rounded p-button-sm",disabled:s.disabledHoldChecksButton},null,8,["onClick","disabled"])])])])),_:1})):(0,a.kq)("",!0)])),_:1},8,["activeIndex","onTabOpen"])])]),(0,a.Wm)(f,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[8]||(t[8]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{field:"name",header:"Name",sortable:"",style:{width:"60%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512),(0,a.Wm)(f,{ref:"opStorage"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{value:i.storages,selection:s.selectedStorage,"onUpdate:selection":t[9]||(t[9]=e=>s.selectedStorage=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onStorageSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{field:"name",header:"Name",sortable:""})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512)],64)}var Ui=o(7615),Oi=o(5466),Fi={name:"Settings",components:{MainMenu:ps,UserAvatar:bs,Toolbar:vs.Z,Accordion:Ui.Z,AccordionTab:Oi.Z,Button:w.Z,InputText:k.Z,DataTable:J.Z,Column:Y.Z,OverlayPanel:Qt.Z,InputSwitch:Gt.Z},data(){return{user:null,defaultProject:{name:""},defaultStorageTo:{name:""},defaultStorageFrom:{name:""},selectedStorage:null,selectedProject:null,storageType:"",activeIndex:-1,isAdmin:!1,addShortageForHold:Boolean,averagePriceForPeriodClose:Boolean,averagePriceForDocs:Boolean,periodString:"",disabledHoldChecksButton:!0}},computed:{period(){return this.$store.state.ss.period},defaultProperties(){return this.$store.state.ss.defaultProperties},projects(){return this.$store.state.cs.projects},storages(){return this.$store.state.cs.storages},addShortageForHoldSetting(){return this.$store.state.ss.addShortageForHold},averagePriceForPeriodCloseSetting(){return this.$store.state.ss.аveragePriceForPeriodCloseProperty},averagePriceForDocsSetting(){return this.$store.state.ss.аveragePriceForDocsProperty},unholdenCheckDate(){return this.$store.state.ds.unholdenCheckDate}},watch:{user(e){"ADMIN"==e.role?this.isAdmin=!0:this.isAdmin=!1},period(e){this.periodString="Закрыть период? (текущий период: "+Ei(new Date(e.start_date))+" - "+Ei(new Date(e.end_date))+")"},unholdenCheckDate(e){this.disabledHoldChecksButton=""==e}},mounted(){this.$store.dispatch("getDefaultProperties"),this.$store.dispatch("getAddShortageForHold"),this.$store.dispatch("getAveragePriceForPeriodCloseProperty"),this.$store.dispatch("getAveragePriceForDocsProperty"),this.user=JSON.parse(localStorage.getItem("user")),this.$store.dispatch("getPeriod"),this.$store.dispatch("checkUnholden1CDocuments")},methods:{closePeriod(){this.$store.dispatch("closePeriod")},setDefaultProperties(){if(0==this.activeIndex){if(this.defaultProperties.length>0){let e=this.defaultProperties.filter((e=>e.type==oo.PROJECT)).pop();e&&(this.defaultProject=this.getProjectById(e.property));let t=this.defaultProperties.filter((e=>e.type==oo.STORAGE_TO)).pop();t&&(this.defaultStorageTo=this.getStorageById(t.property));let o=this.defaultProperties.filter((e=>e.type==oo.STORAGE_FROM)).pop();o&&(this.defaultStorageFrom=this.getStorageById(o.property))}}else 2==this.activeIndex?this.averagePriceForPeriodClose=this.averagePriceForPeriodCloseSetting:3==this.activeIndex&&(this.addShortageForHold=this.addShortageForHoldSetting,this.averagePriceForDocs=this.averagePriceForDocsSetting)},logout(){this.$store.dispatch("logout")},getProjectById(e){return this.projects.filter((t=>t.id==e)).pop()},getStorageById(e){return this.storages.filter((t=>t.id==e)).pop()},onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.defaultProject=e.data,this.$refs.opProjects.hide(),this.setProperty(this.user,oo.PROJECT,e.data.id)},onStorageFromClick(e){this.storageType="storageFrom",this.$refs.opStorage.toggle(e)},onStorageToClick(e){this.storageType="storageTo",this.$refs.opStorage.toggle(e)},onStorageSelect(e){"storageFrom"==this.storageType?(this.defaultStorageFrom=e.data,this.setProperty(this.user,oo.STORAGE_FROM,e.data.id)):(this.defaultStorageTo=e.data,this.setProperty(this.user,oo.STORAGE_TO,e.data.id)),this.$refs.opStorage.hide()},setAddShortageForHold(){this.$store.dispatch("setAddShortageForHoldProperty",this.addShortageForHold?0:1)},setProperty(e,t,o){this.$store.dispatch("setProperty",[e,t,o])},deleteDocs(){this.$store.dispatch("deleteDocs")},hold1CDocs(){this.$store.dispatch("hold1CDocuments")},setAveragePriceForPeriodClose(){this.$store.dispatch("setAveragePriceForPeriodCloseProperty",this.averagePriceForPeriodClose?0:1)},setAveragePriceForDocs(){this.$store.dispatch("setAveragePriceForDocsProperty",this.averagePriceForDocs?0:1)}}};function Ei(e,t){let o={day:"numeric",month:"numeric",year:"numeric"};return t&&(o.hour="numeric",o.minute="numeric",o.second="numeric"),e.toLocaleString("ru-Ru",o)}const Bi=(0,c.Z)(Fi,[["render",xi],["__scopeId","data-v-18e25d62"]]);var Ni=Bi;const Zi={class:"conteiner"};function ji(e,t,o,l,s,i){const n=(0,a.up)("UserAvatar"),d=(0,a.up)("Button"),c=(0,a.up)("Toolbar"),r=(0,a.up)("MainMenu"),u=(0,a.up)("UserTree"),m=(0,a.up)("UserForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,{class:"top-menu"},{end:(0,a.w5)((()=>[(0,a.Wm)(n),(0,a.Wm)(d,{label:"logout",onClick:t[0]||(t[0]=e=>i.logout()),class:"p-button-sm p-button-rounded"})])),_:1}),(0,a._)("div",Zi,[(0,a.Wm)(r),(0,a.Wm)(u),(0,a.Wm)(m)])],64)}const Mi={class:"tree"};function $i(e,t,o,l,s,i){const n=(0,a.up)("Tree");return(0,a.wg)(),(0,a.iD)("div",Mi,[(0,a.Wm)(n,{value:i.nodes,expandedKeys:i.expandedKeys,selectionMode:"single",selectionKeys:s.selectedKey,"onUpdate:selectionKeys":t[0]||(t[0]=e=>s.selectedKey=e),metaKeySelection:!1,onNodeCollapse:i.onNodeCollapse,onNodeExpand:i.onNodeExpand,onNodeSelect:i.onNodeSelect},null,8,["value","expandedKeys","selectionKeys","onNodeCollapse","onNodeExpand","onNodeSelect"])])}var Hi={name:"ItemTree",components:{Tree:Vs.Z},data(){return{selectedKey:null,parentNode:null}},computed:{nodes(){return this.$store.state.us.userTree},expandedKeys(){let e=this.$store.state.us.expandedKeys;return e}},mounted(){this.$store.dispatch("getUserTree")},methods:{onNodeSelect(e){e.is_node?this.$store.dispatch("setParentNode",e):this.$store.dispatch("getPerson",e.data)},onNodeExpand(e){e.is_node&&(e.icon="pi pi-fw pi-folder-open",this.$store.dispatch("setParentNode",e))},onNodeCollapse(e){e.is_node&&(e.icon="pi pi-fw pi-folder")}}};const qi=(0,c.Z)(Hi,[["render",$i],["__scopeId","data-v-48a6ba42"]]);var Ki=qi;const zi=e=>((0,a.dD)("data-v-5dbf7f2e"),e=e(),(0,a.Cn)(),e),Li={class:"itemform"},Gi={class:"header"},Ji={class:"formgrid grid form"},Yi={class:"field col-12 md:col-6"},Qi={class:"p-float-label"},Xi=zi((()=>(0,a._)("label",{for:"itemname"},"Имя",-1))),en={class:"field col-12 md:col-6"},tn={class:"p-float-label"},on=zi((()=>(0,a._)("label",{for:"printname"},"Фамилия",-1))),ln={class:"field col-12 md:col-6"},sn={class:"p-float-label"},an=zi((()=>(0,a._)("label",{for:"password"},"Пароль",-1))),nn={class:"field col-12 md:col-6"},dn={class:"p-float-label"},cn=zi((()=>(0,a._)("label",{for:"inn"},"ИНН",-1))),rn={class:"field col-12 md:col-6"},un={class:"p-float-label"},mn=zi((()=>(0,a._)("label",{for:"email"},"email",-1))),pn={class:"field col-12 md:col-6"},hn={class:"p-float-label"},_n=zi((()=>(0,a._)("label",{for:"phone"},"телефон",-1))),gn={class:"field col-12 md:col-6"},fn={class:"p-float-label"},yn=zi((()=>(0,a._)("label",{for:"birthdate"},"день рождения",-1))),bn={class:"field col-12 md:col-6"},vn={id:"aaa",class:"p-inputgroup longinput"},Cn={class:"field col-12 md:col-12"},kn={class:"p-float-label"},Dn=zi((()=>(0,a._)("label",{for:"discount"},"Скидка",-1))),wn=zi((()=>(0,a._)("br",null,null,-1))),Sn={class:"col-12 md:col-6"},Tn={class:"checkBox"},Pn={class:"checkBoxLabel"},An=zi((()=>(0,a._)("label",{for:"garnish"},"показывать в списке расходов ",-1))),Wn={class:"checkBoxLabel"},Vn=zi((()=>(0,a._)("label",{for:"garnish"},"скидка на все ",-1))),In={class:"col-12 md:col-6"},Rn={class:"checkBox"},xn={class:"checkBoxLabel"},Un=zi((()=>(0,a._)("label",{for:"garnish"},"показывать кнопку расходов ",-1))),On={class:"checkBoxLabel"},Fn=zi((()=>(0,a._)("label",{for:"includgarnish"},"выплаты запрещены ",-1))),En={class:"col-12 md:col-12"},Bn={class:"p-float-label"},Nn=zi((()=>(0,a._)("label",{for:"comment"},"Комментарий",-1))),Zn={class:"col-12 md:col-12",style:{"text-align":"end"}};function jn(e,t,o,l,s,i){const n=(0,a.up)("Button"),d=(0,a.up)("InputText"),c=(0,a.up)("Calendar"),r=(0,a.up)("Checkbox"),u=(0,a.up)("Textarea"),m=(0,a.up)("Dialog"),p=(0,a.up)("Column"),h=(0,a.up)("DataTable"),_=(0,a.up)("OverlayPanel");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a._)("div",Li,[(0,a._)("div",Gi,[(0,a.Wm)(n,{label:"Новый пользователь",onClick:i.addNewPerson,class:"p-button-rounded p-button-secondary p-button-sm"},null,8,["onClick"])]),(0,a._)("div",Ji,[(0,a._)("div",Yi,[(0,a._)("span",Qi,[(0,a.Wm)(d,{id:"itemname",class:"longinput",type:"text",modelValue:s.currentPerson.first_name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.currentPerson.first_name=e)},null,8,["modelValue"]),Xi])]),(0,a._)("div",en,[(0,a._)("span",tn,[(0,a.Wm)(d,{id:"printname",class:"longinput",type:"text",modelValue:s.currentPerson.last_name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.currentPerson.last_name=e)},null,8,["modelValue"]),on])]),(0,a._)("div",ln,[(0,a._)("span",sn,[(0,a.Wm)(d,{id:"password",class:"longinput",type:"text",modelValue:s.currentPerson.password,"onUpdate:modelValue":t[2]||(t[2]=e=>s.currentPerson.password=e),disabled:""},null,8,["modelValue"]),an])]),(0,a._)("div",nn,[(0,a._)("span",dn,[(0,a.Wm)(d,{id:"inn",class:"longinput",type:"text",modelValue:s.currentPerson.inn,"onUpdate:modelValue":t[3]||(t[3]=e=>s.currentPerson.inn=e)},null,8,["modelValue"]),cn])]),(0,a._)("div",rn,[(0,a._)("span",un,[(0,a.Wm)(d,{id:"email",class:"longinput",type:"text",modelValue:s.currentPerson.email,"onUpdate:modelValue":t[4]||(t[4]=e=>s.currentPerson.email=e)},null,8,["modelValue"]),mn])]),(0,a._)("div",pn,[(0,a._)("span",hn,[(0,a.Wm)(d,{id:"phone",class:"longinput",type:"text",modelValue:s.currentPerson.phone,"onUpdate:modelValue":t[5]||(t[5]=e=>s.currentPerson.phone=e)},null,8,["modelValue"]),_n])]),(0,a._)("div",gn,[(0,a._)("span",fn,[(0,a.Wm)(c,{id:"birthdate",modelValue:s.currentPerson.birth_date,"onUpdate:modelValue":t[6]||(t[6]=e=>s.currentPerson.birth_date=e),onDateSelect:i.setDate,class:"longinput",showIcon:!0,showButtonBar:!0,dateFormat:"dd.mm.yy"},null,8,["modelValue","onDateSelect"]),yn])]),(0,a._)("div",bn,[(0,a._)("div",vn,[(0,a.Wm)(d,{id:"unit",type:"text",placeholder:"Проект",modelValue:s.selectedProject.name,"onUpdate:modelValue":t[7]||(t[7]=e=>s.selectedProject.name=e)},null,8,["modelValue"]),(0,a.Wm)(n,{icon:"pi pi-check",class:"p-button-warning",onClick:i.onProjectClick},null,8,["onClick"])])]),(0,a._)("div",Cn,[(0,a._)("span",kn,[(0,a.Wm)(d,{id:"discount",class:"longinput",type:"text",modelValue:s.currentPerson.discount,"onUpdate:modelValue":t[8]||(t[8]=e=>s.currentPerson.discount=e)},null,8,["modelValue"]),Dn])]),wn,(0,a._)("div",Sn,[(0,a._)("div",Tn,[(0,a._)("span",Pn,[An,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.in_expence_list,"onUpdate:modelValue":t[9]||(t[9]=e=>s.currentPerson.in_expence_list=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",Wn,[Vn,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.discount_for_all,"onUpdate:modelValue":t[10]||(t[10]=e=>s.currentPerson.discount_for_all=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",In,[(0,a._)("div",Rn,[(0,a._)("span",xn,[Un,(0,a.Wm)(r,{id:"garnish",modelValue:s.currentPerson.show_expence_button,"onUpdate:modelValue":t[11]||(t[11]=e=>s.currentPerson.show_expence_button=e),binary:!0},null,8,["modelValue"])]),(0,a._)("span",On,[Fn,(0,a.Wm)(r,{id:"includgarnish",modelValue:s.currentPerson.expenses_disable,"onUpdate:modelValue":t[12]||(t[12]=e=>s.currentPerson.expenses_disable=e),binary:!0},null,8,["modelValue"])])])]),(0,a._)("div",En,[(0,a._)("span",Bn,[(0,a.Wm)(u,{id:"comment",class:"textinput",modelValue:s.currentPerson.comment,"onUpdate:modelValue":t[13]||(t[13]=e=>s.currentPerson.comment=e),rows:"4",cols:"65"},null,8,["modelValue"]),Nn])]),(0,a._)("div",Zn,[(0,a.Wm)(n,{label:"Сохранить",onClick:i.onSave,class:"p-button-rounded p-button-sm",style:{"margin-top":"15px"}},null,8,["onClick"])])])])]),(0,a.Wm)(m,{header:"Подтверждение",class:"border",visible:s.displayConfirmation,"onUpdate:visible":t[14]||(t[14]=e=>s.displayConfirmation=e),style:{width:"300px"},modal:!0,showHeader:!1},{footer:(0,a.w5)((()=>[(0,a.Wm)(n,{label:"Нет",icon:"pi pi-times",onClick:i.closeConfirmation,class:"p-button-text"},null,8,["onClick"]),(0,a.Wm)(n,{label:"Да",icon:"pi pi-check",onClick:i.positiveConfirmation,class:"p-button-text",autofocus:""},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h4",null,(0,A.zw)(s.confirmationMessage),1)])),_:1},8,["visible"]),(0,a.Wm)(_,{ref:"opProjects"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{value:i.projects,selection:s.selectedProject,"onUpdate:selection":t[15]||(t[15]=e=>s.selectedProject=e),selectionMode:"single",paginator:!0,rows:5,onRowSelect:i.onProjectSelect,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{field:"name",header:"Name",sortable:"",style:{width:"60%"}})])),_:1},8,["value","selection","onRowSelect"])])),_:1},512)],64)}class Mn{constructor(e){(0,zt.Z)(this,"id",0),(0,zt.Z)(this,"first_name",""),(0,zt.Z)(this,"last_name",""),(0,zt.Z)(this,"email",""),(0,zt.Z)(this,"phone",""),(0,zt.Z)(this,"reg_date",""),(0,zt.Z)(this,"birth_date",""),(0,zt.Z)(this,"role",""),this.reg_date=e,this.birth_date=e}}var $n={name:"UserForm",components:{Calendar:Lt.Z,InputText:k.Z,Button:w.Z,Dialog:Q.Z,Checkbox:Ka.Z,OverlayPanel:Qt.Z,Textarea:za.Z,Column:Y.Z,DataTable:J.Z},data(){return{displayConfirmation:!1,confirmationMessage:"",currentPerson:new Mn(new Date),selectedProject:{name:""}}},computed:{person(){return this.$store.state.us.person},projects(){return this.$store.state.cs.projects}},watch:{person(e){this.currentPerson=e}},methods:{onProjectClick(e){this.$refs.opProjects.toggle(e)},onProjectSelect(e){this.selectedProject=e.data,this.currentPerson.project=e.data,this.$refs.opProjects.hide()},setDate(e){this.$store.dispatch("setDate",e)},addNewPerson(){this.$store.dispatch("send"),this.$store.dispatch("getPerson",0)},savePerson(){this.item.parent_id=this.parentNode.data,this.$store.dispatch("savePerson",this.person)},closeConfirmation(){this.displayConfirmation=!1},positiveConfirmation(){this.saveItem(),this.displayConfirmation=!1},onSave(){this.confirmationMessage="Сохранить "+this.item.name+" в "+this.parentNode.label+"?",this.displayConfirmation=!0}},mounted(){this.$store.dispatch("getPerson",0)}};const Hn=(0,c.Z)($n,[["render",jn],["__scopeId","data-v-5dbf7f2e"]]);var qn=Hn,Kn={name:"UserContent",components:{UserTree:Ki,UserForm:qn,MainMenu:ps,UserAvatar:bs,Toolbar:vs.Z,Button:w.Z},data(){return{}},computed:{},methods:{logout(){this.$store.dispatch("logout")}}};const zn=(0,c.Z)(Kn,[["render",ji],["__scopeId","data-v-54e26bc6"]]);var Ln=zn;const Gn=[{path:"/",redirect:"/documents/posting"},{path:"/login",component:P},{path:"/documents/:filter?",component:Ss,props:!0},{path:"/items",component:ti},{path:"/users",component:Ln},{path:"/settings",component:Ni}],Jn=(0,p.p7)({history:(0,p.r5)(),routes:Gn});async function Yn(e,t){return fetch(to+e,{method:"GET",headers:{Authorization:t.token}}).then((e=>e.json())).then((e=>td(e,t))).then((e=>e.data))}async function Qn(e,t,o,l){return fetch(to+e,{method:"POST",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>td(e,l))).then((e=>e))}async function Xn(e,t,o,l){return fetch(to+e,{method:"PUT",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>td(e,l))).then((e=>e.data))}async function ed(e,t,o,l){return fetch(to+e,{method:"DELETE",headers:t,body:JSON.stringify(o)}).then((e=>e.json())).then((e=>td(e,l))).then((e=>e.data))}function td(e,t){return e.error?t.toast?.add({severity:"error",summary:"error",detail:e.error,life:3e3}):t.toast?.add({severity:"info",summary:"Info Message",detail:e.message,life:1e3}),e}Jn.beforeEach(((e,t,o)=>{const l=["/login"],s=!l.includes(e.path);let a=JSON.parse(localStorage.getItem("user"));if(s&&!a)return o("/login");o()}));class od{constructor(e,t,o){(0,zt.Z)(this,"id",0),(0,zt.Z)(this,"number",0),(0,zt.Z)(this,"date_time",""),(0,zt.Z)(this,"amount",0),(0,zt.Z)(this,"tax",0),(0,zt.Z)(this,"doc_type",""),(0,zt.Z)(this,"is_payed",!1),(0,zt.Z)(this,"is_hold",!1),(0,zt.Z)(this,"is_delivery",!1),(0,zt.Z)(this,"project",this.getDefaultProject()),(0,zt.Z)(this,"author",{id:0,email:"",name:""}),(0,zt.Z)(this,"individual",{id:0,email:"",name:""}),(0,zt.Z)(this,"supplier",{id:0,name:"",inn:0,kpp:0,accounts:[],is_mine:!1}),(0,zt.Z)(this,"recipient",{id:0,inn:0,kpp:0,is_mine:!1}),(0,zt.Z)(this,"storage_from",{id:0,name:"",type:""}),(0,zt.Z)(this,"storage_to",{id:0}),(0,zt.Z)(this,"base_document_id",0),this.number=o,this.doc_type=e,this.date_time=t,"Чек ККМ"===e&&(this.check_info={waiter:"",check_number:0,cash_register_number:0,amount_received:0,guest_number:0,table_number:0,date_time:t,is_return:!1,is_KKM_checked:!1,is_payed:!1,is_payed_by_card:!1,is_delivery:!1}),e!=lo.CREDIT_ORDER_DOC&&e!=lo.WITHDRAW_ORDER_DOC&&(this.doc_items=[])}getDefaultProject(){return{id:0,name:""}}}class ld{constructor(e,t,o,l){(0,zt.Z)(this,"document_id",0),(0,zt.Z)(this,"item_id",0),(0,zt.Z)(this,"item_name",""),(0,zt.Z)(this,"quantity",0),(0,zt.Z)(this,"quantity_fact",0),(0,zt.Z)(this,"price",0),(0,zt.Z)(this,"amount",0),(0,zt.Z)(this,"discount",0),this.item_id=e,this.item_name=t,this.quantity=o,this.price=l}}function sd(e,t){e.author=t.author,e.project=t.project,e.doc_type==lo.WRITE_OFF_DOC?e.storage_from=t.storage_from:e.storage_to=t.storage_from,e.base_document_id=t.id;let o=e.doc_type==lo.WRITE_OFF_DOC?-1:1;for(let l of t.doc_items){let t=(l.quantity_fact-l.quantity)*o;if(t>0){let o=new ld(l.item_id,l.item_name,t,l.price);e.doc_items.push(o)}}}const ad={state:()=>({document:document,documents:null,itemRest:0,startDate:0,endDate:0,exsistNotHoldenDocs:0,unholdenCheckDate:""}),mutations:{setDocuments(e,t){e.documents=t},setDocument(e,t){e.document=t},setItemRest(e,t){e.itemRest=t},setDates(e,[t,o]){e.startDate=t,e.endDate=o},setStartDate(e,t){e.startDate=t},setEndDate(e,t){e.endDate=t},setRootSuccess(e){e.success++},setExsistNotHoldenDocs(e){e.exsistNotHoldenDocs++},setUnholdenCheckDate(e,t){e.unholdenCheckDate=t}},actions:{setDates({commit:e}){let t=new Date,o=t.getFullYear(),l=t.getMonth(),s=t.getDate();e("setDates",[new Date(o,l,1),new Date(o,l,s+1)])},setStartDate({commit:e},t){e("setStartDate",t)},setEndDate({commit:e},t){e("setEndDate",t)},async getDocuments({commit:e,rootState:t,state:o},l){l=""!==l?"?filter="+l:"";let s=(""==l?"?":"&")+"start="+o.startDate.getTime()+"&end="+o.endDate.getTime();const a=await Yn("/api/v1/docs/list"+l+s,t);for(let i=0;i<a.length;i++)a[i].date_time=new Date(a[i].date_time);e("setDocuments",a)},async getDocument({commit:e,rootState:t},[o,l]){let s=null;if(0==o){let e=await Yn("/api/v1/docs/new/number?type="+l,t);s=new od(l,new Date,e)}else s=await Yn("/api/v1/docs?id="+o,t),s.date_time=new Date(s.date_time);s.check_info&&(s.check_info.date_time=new Date(s.check_info.date_time)),e("setDocument",s)},async updateDocument({commit:e,rootState:t},[o,l]){o.date_time=o.date_time.getTime(),o.check_info&&(o.check_info.date_time=o.check_info.date_time.getTime());let s={item_doc_dto:o},a={"Content-Type":"application/json",Authorization:t.token};const i=await Xn("/api/v1/docs/"+l,a,s,t);"ok"==i&&e("setSuccess")},async addDocument({commit:e,rootState:t},[o,l]){o.date_time=o.date_time.getTime(),o.check_info&&(o.check_info.date_time=o.check_info.date_time.getTime());let s={item_doc_dto:o},a={"Content-Type":"application/json",Authorization:t.token};const i=await Qn("/api/v1/docs/"+l,a,s,t);"ok"==i.data&&e("setSuccess")},createRelativeDocks({commit:e},t){let o=new od("Списание",t.date_time,"");sd(o,t),o.doc_items.length>0&&this.dispatch("addDocument",[o,!0]);let l=new od("Оприходование",t.date_time,"");sd(l,t),l.doc_items.length>0&&this.dispatch("addDocument",[l,!0]),e("setSuccess")},async deleteDocument({commit:e,rootState:t},o){o.date_time=o.date_time.getTime();let l={item_doc_dto:o},s={"Content-Type":"application/json",Authorization:t.token};const a=await ed("/api/v1/docs",s,l,t);"ok"==a&&e("setSuccess")},async holdDocument({commit:e,rootState:t},o){let l={Authorization:t.token};const s=await Qn("/api/v1/docs/hold/"+o,l,null,t);1==s.type&&e("setExsistNotHoldenDocs"),"ok"==s.data&&e("setSuccess")},async serialHoldDocument({commit:e,rootState:t},o){let l={Authorization:t.token};const s=await Qn("/api/v1/docs/hold/serial/"+o,l,null,t);"ok"==s.data&&e("setSuccess")},async getRestOnDateAndStorage({commit:e,rootState:t},[o,l,s]){let a="/api/v1/rest/inventory?docId="+o+"&time="+l.getTime()+"&storageId="+s;const i=await Yn(a,t);e("setItemRest",i)},async deleteDocs({commit:e,rootState:t}){let o={"Content-Type":"application/json",Authorization:t.token};const l=await ed("/api/v1/docs/hard/delete",o,null,t);"ok"==l.data&&e("setSuccess")},async hold1CDocuments({commit:e,rootState:t}){let o={Authorization:t.token};const l=await Qn("/api/v1/1c/hold",o,null,t);"ok"==l.data&&e("setSuccess")},async checkUnholden1CDocuments({commit:e,rootState:t}){const o=await Yn("/api/v1/1c/check",t);e("setUnholdenCheckDate",o)},async getAAA({commit:e,rootState:t}){let o={Authorization:t.token};const l=await Qn("/api/v1/1c/number/3",o,null,t);"ok"==l.data&&e("setSuccess")}}};class id{constructor(e){(0,zt.Z)(this,"id",0),(0,zt.Z)(this,"name",""),(0,zt.Z)(this,"workshop",{name:"---",code:"NONE"}),(0,zt.Z)(this,"unit",{name:"---",code:"NONE"}),(0,zt.Z)(this,"number",0),(0,zt.Z)(this,"prices",[]),(0,zt.Z)(this,"sets",[]),(0,zt.Z)(this,"ingredients",[]),(0,zt.Z)(this,"print_name",""),(0,zt.Z)(this,"reg_time",""),(0,zt.Z)(this,"is_weight",!1),(0,zt.Z)(this,"is_not_in_employee_menu",!1),(0,zt.Z)(this,"is_alcohol",!1),(0,zt.Z)(this,"is_not_in_price_list",!1),(0,zt.Z)(this,"is_garnish",!1),(0,zt.Z)(this,"is_include_garnish",!1),(0,zt.Z)(this,"is_sauce",!1),(0,zt.Z)(this,"is_include_sauce",!1),(0,zt.Z)(this,"parent_id",0),this.reg_time=e}}class nd{constructor(e,t,o,l,s,a,i){(0,zt.Z)(this,"id",0),(0,zt.Z)(this,"name",""),(0,zt.Z)(this,"child_id",0),(0,zt.Z)(this,"parent_id",0),(0,zt.Z)(this,"netto",0),(0,zt.Z)(this,"gross",0),(0,zt.Z)(this,"enable",0),this.id=e,this.name=t,this.child_id=o,this.parent_id=l,this.netto=s,this.gross=a,this.enable=i}}class dd{constructor(e,t,o,l){(0,zt.Z)(this,"id",0),(0,zt.Z)(this,"date",0),(0,zt.Z)(this,"quantity",0),(0,zt.Z)(this,"type",""),this.id=e,this.date=t,this.quantity=o,this.type=l}}const cd={state:()=>({itemTree:null,item:"",parentNode:null,itemDate:new Date,ingredients:[],crumbs:[],expandedKeys:{},calculation:null,timeOfRest:null,items:[]}),mutations:{setItemTree(e,t){e.itemTree=t},setItem(e,t){e.item=t},setIngredients(e,t){e.ingredients=t},addIngredient(e,t){e.ingredients.push(t)},saveParentNode(e,t){e.parentNode=t},setDate(e,t){e.itemDate=t},addCrumb(e,t){e.crumbs.push(t)},delCrumb(e,t){for(var o=e.crumbs.length-1;o>=0;o--){if(e.crumbs[o]==t){e.crumbs.pop();break}e.crumbs.pop()}},delCrumbs(e){e.crumbs=[]},expandKey(e,t){e.expandedKeys[t]=!0},setCalculation(e,t){e.calculation=t},setItemsWithRest(e,t){e.items=t}},actions:{async getItemTree({rootState:e,commit:t}){const o=await Yn("/api/v1/items/tree",e);t("setItemTree",o)},async getItem({state:e,rootState:t,commit:o},l){let s;s=0!=l?await Yn("/api/v1/items?date="+e.itemDate.getTime()+"&id="+l,t):new id(new Date),o("setIngredients",s.ingredients),o("setItem",s)},addIngredient({state:e,commit:t},o){let l=e.itemDate.getTime(),s=new dd(0,l,0,"NET"),a=new dd(0,l,0,"GROSS"),i=new dd(0,l,1,"ENABLE"),n=new nd(0,o.name,o.id,e.item.id,s,a,i);t("addIngredient",n)},async saveItem({rootState:e,commit:t},[o,l]){let s,a={"Content-Type":"application/json",Authorization:e.token};0==o.id?(o.reg_time=l.getTime(),s=await Qn("/api/v1/items",a,o,e)):s=await Xn("/api/v1/items/"+l.getTime(),a,o,e),"ok"==s&&t("setSuccess"),t("setItem",new id),t("setIngredients",[])},setParentNode({commit:e},t){e("saveParentNode",t)},expandNodes({state:e},t){console.log(t);let o=e.itemTree[0];this.dispatch("expandNode",o)},expandNode({commit:e},t){if(t.children&&t.children.length){e("expandKey",t.key);for(let e of t.children)this.dispatch("expandNode",e)}},addCrumb({commit:e},t){e("addCrumb",t)},delCrumb({commit:e},t){e("delCrumb",t)},delCrumbs({commit:e}){e("delCrumbs")},setDate({commit:e},t){e("setDate",t)},async getCalculation({state:e,rootState:t,commit:o},l){let s=await Yn("/api/v1/items/calculation?date="+e.itemDate.getTime()+"&id="+l,t);o("setCalculation",s)},async getItemsWithRest({rootState:e,commit:t},o){if(o.getTime()!=this.timeOfRest){this.timeOfRest=o.getTime();const l=await Yn("/api/v1/items/list?time="+this.timeOfRest,e);t("setItemsWithRest",l)}}}},rd={state:()=>({companies:[],docTypes:[],workshops:[],units:[],projects:[],storages:[],users:[],items:[]}),mutations:{setDocTypes(e,t){e.docTypes=t},setWorkShops(e,t){e.workshops=t},setUnits(e,t){e.units=t},setStorages(e,t){e.storages=t},setUsers(e,t){e.users=t},setCompanies(e,t){e.companies=t},setProject(e,t){e.projects=t},setItems(e,t){e.items=t}},actions:{async getDocTypes({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/document/types",e);t("setDocTypes",o)},async getProjects({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/projects",e);t("setProject",o)},async getWorkShops({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/workshops",e);t("setWorkShops",o)},async getUnits({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/units",e);t("setUnits",o)},async getStorages({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/storages",e);t("setStorages",o)},async getUsers({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/users",e);t("setUsers",o)},async getCompanies({rootState:e,commit:t}){const o=await Yn("/api/v1/catalogs/companies",e);t("setCompanies",o)},async getItems({rootState:e,commit:t}){const o=await Yn("/api/v1/items/list",e);t("setItems",o)}}};var ud=o(8e3),md=o.n(ud),pd=o(5016),hd=o.n(pd);const _d={state:()=>({received_messages:[],send_message:null,connected:!1,socket:null,stompClient:null}),mutations:{},actions:{send(){if(console.log("Send message:"+this.send_message),this.stompClient&&this.stompClient.connected){const e={text:"message"};console.log(JSON.stringify(e)),this.stompClient.send("ws/app/hello",JSON.stringify(e),{})}},getSocketConnection(){let e=new(md())("http://localhost:8081/ws");this.stompClient=hd().over(e),this.stompClient.connect({},(e=>{this.connected=!0,console.log(e),this.stompClient.subscribe("/ws/subscribe",(e=>{console.log(e),this.received_messages.push(JSON.parse(e.body).content)}))}),(e=>{console.log("error",e),this.connected=!1}))},disconnect(){this.stompClient&&this.stompClient.disconnect(),this.connected=!1},tickleConnection(){this.connected?this.disconnect():this.connect()}}},gd={state:()=>({defaultProperties:[],addShortageForHold:!0,averagePriceForPeriodCloseProperty:Boolean,"аveragePriceForDocsProperty":Boolean,period:null}),mutations:{setDefaultProperties(e,t){e.defaultProperties=t},setAddShortageForHold(e,t){e.addShortageForHold=1==t.property},setAveragePriceForPeriodCloseProperty(e,t){e.аveragePriceForPeriodCloseProperty=1==t.property},getAveragePriceForDocsProperty(e,t){e.аveragePriceForDocsProperty=1==t.property},setPeriod(e,t){e.period=t}},actions:{async getDefaultProperties({commit:e,rootState:t}){let o=JSON.parse(localStorage.getItem("user"));const l=await Yn("/api/v1/setting?userId="+o.id,t);e("setDefaultProperties",l)},async getAddShortageForHold({commit:e,rootState:t}){const o=await Yn("/api/v1/setting/add/shortage",t);e("setAddShortageForHold",o)},async getAveragePriceForPeriodCloseProperty({commit:e,rootState:t}){const o=await Yn("/api/v1/setting/average/price/period",t);e("setAveragePriceForPeriodCloseProperty",o)},async getAveragePriceForDocsProperty({commit:e,rootState:t}){const o=await Yn("/api/v1/setting/average/price/docs",t);e("setAveragePriceForDocsProperty",o)},async setProperty({rootState:e},[t,o,l]){let s={user:t,type:o,property:l},a={"Content-Type":"application/json",Authorization:e.token};const i=await Qn("/api/v1/setting/property",a,s,e);"ok"==i.data&&this.dispatch("getDefaultProperties")},async setAddShortageForHoldProperty({rootState:e},t){let o={type:oo.ADD_REST_FOR_HOLD,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/add/shortage",l,o,e);"ok"==s.data&&this.dispatch("getDefaultProperties")},async setAveragePriceForPeriodCloseProperty({rootState:e},t){let o={type:oo.AVERAGE_COST,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/average/price/period",l,o,e);"ok"==s.data&&this.dispatch("getAveragePriceForPeriodCloseProperty")},async setAveragePriceForDocsProperty({rootState:e},t){let o={type:oo.AVERAGE_COST,property:t},l={"Content-Type":"application/json",Authorization:e.token};const s=await Qn("/api/v1/setting/average/price/docs",l,o,e);"ok"==s.data&&this.dispatch("getAveragePriceForDocsProperty")},async getPeriod({commit:e,rootState:t}){const o=await Yn("/api/v1/setting/period",t);e("setPeriod",o)},async closePeriod({commit:e,rootState:t}){let o={"Content-Type":"application/json",Authorization:t.token};const l=await Qn("/api/v1/setting/period",o,null,t);e("setPeriod",l.data)}}},fd={state:()=>({userTree:null,expandedKeys:{},person:null}),mutations:{setUserTree(e,t){e.userTree=t},setPerson(e,t){e.person=t}},actions:{async getUserTree({rootState:e,commit:t}){const o=await Yn("/api/v1/users/tree",e);t("setUserTree",o)},async getPerson({rootState:e,commit:t},o){let l;0!=o?(l=await Yn("/api/v1/users?id="+o,e),l.birth_date=new Date(l.birth_date)):l=new Mn(new Date),t("setPerson",l)},async savePerson({rootState:e,commit:t},o){let l,s={"Content-Type":"application/json",Authorization:e.token};l=0==o.id?await Qn("/api/v1/users",s,o,e):await Xn("/api/v1/users/",s,o,e),"ok"==l.data&&t("setSuccess"),t("setPerson",new Mn(new Date))}}},yd=(0,m.MT)({modules:{ds:ad,is:cd,cs:rd,ws:_d,ss:gd,us:fd},state(){return{user:null,success:0,message:String,toast:null,token:String}},mutations:{setUser(e,t){t?(localStorage.setItem("user",JSON.stringify(t)),e.token=t.token,Jn.push("/")):(localStorage.removeItem("user"),Jn.push("/login"))},getToken(e){let t=JSON.parse(localStorage.getItem("user"));e.token=t.token},installToast(e,t){e.toast=t},setSuccess(e){e.success++}},actions:{async login(e,t){let o={"Content-Type":"application/json"};const l=await Qn("/api/v1/auth/login",o,t,e.state);e.commit("setUser",l.data)},async logout(e){e.commit("setUser",null)},async getToken(e){e.commit("getToken")},getMessage(e,t){e.state.toast?.add({severity:"error",summary:"Info Message",detail:t,life:3e3})},installToast(e,t){e.commit("installToast",t)}}});var bd=o(7915),vd=o(2394);const Cd=(0,l.ri)(u);Cd.use(s.Z),Cd.use(yd),Cd.use(Jn),Cd.use(vd.Z),Cd.directive("tooltip",bd.Z),Cd.mount("#app")}},t={};function o(l){var s=t[l];if(void 0!==s)return s.exports;var a=t[l]={exports:{}};return e[l].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,l,s,a){if(!l){var i=1/0;for(r=0;r<e.length;r++){l=e[r][0],s=e[r][1],a=e[r][2];for(var n=!0,d=0;d<l.length;d++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](l[d])}))?l.splice(d--,1):(n=!1,a<i&&(i=a));if(n){e.splice(r--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var r=e.length;r>0&&e[r-1][2]>a;r--)e[r]=e[r-1];e[r]=[l,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,a,i=l[0],n=l[1],d=l[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in n)o.o(n,s)&&(o.m[s]=n[s]);if(d)var r=d(o)}for(t&&t(l);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(r)},l=self["webpackChunkstore"]=self["webpackChunkstore"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[998],(function(){return o(1147)}));l=o.O(l)})();
//# sourceMappingURL=app.7b1f55b8.js.map